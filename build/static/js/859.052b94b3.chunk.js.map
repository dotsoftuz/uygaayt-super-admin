{"version":3,"file":"static/js/859.052b94b3.chunk.js","mappings":"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","sources":["pages/category/info/CategoryChildForm.tsx","pages/category/info/CategoryChild.tsx","pages/category/info/categoryChild.columns.tsx","utils/numberFormat.ts"],"sourcesContent":["import React, { useEffect } from \"react\";\r\nimport { Grid } from \"@mui/material\";\r\nimport { AutoCompleteForm, ImageInput, TextInput } from \"components\";\r\nimport { UseFormReturn } from \"react-hook-form\";\r\nimport { useApi, useApiMutation } from \"hooks/useApi/useApiHooks\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport useAllQueryParams from \"hooks/useGetAllQueryParams/useAllQueryParams\";\r\n\r\ninterface IBranchForm {\r\n  formStore: UseFormReturn<any>;\r\n  resetForm: () => void;\r\n  editingCategoryId?: any;\r\n  setRender?: React.Dispatch<React.SetStateAction<boolean>>;\r\n\r\n}\r\n\r\nconst CategoryChildForm: React.FC<IBranchForm> = ({\r\n  formStore,\r\n  resetForm,\r\n  editingCategoryId,\r\n  setRender,\r\n}) => {\r\n  const { t } = useTranslation();\r\n  const { control, handleSubmit, reset, setValue } = formStore;\r\n  const allParams = useAllQueryParams();\r\n\r\n\r\n  const { mutate, status } = useApiMutation<any>(\r\n    editingCategoryId\r\n      ? `category/update`\r\n      : \"category/create\",\r\n    editingCategoryId ? \"put\" : \"post\"\r\n  );\r\n\r\n  const { data: getByIdData, status: getByIdStatus } = useApi(`category/get-by-id/${editingCategoryId}`, {}, {\r\n    enabled: !!editingCategoryId,\r\n    suspense: false\r\n  })\r\n\r\n  const sumbit = (data: any) => {\r\n    mutate({\r\n      ...data,\r\n      imageId: data.imageId?._id,\r\n      _id: editingCategoryId,\r\n      parentId: allParams.parentId\r\n    });\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (status === \"success\") {\r\n      resetForm();\r\n      setRender?.(prev => !prev);\r\n    }\r\n  }, [status]);\r\n\r\n  useEffect(() => {\r\n    if (getByIdStatus === 'success') {\r\n      reset({\r\n        name: getByIdData.data.name,\r\n        imageId: getByIdData.data.image,\r\n      });\r\n    }\r\n  }, [getByIdStatus, getByIdData]);\r\n\r\n  return (\r\n    <div className=\"custom-drawer\">\r\n      <form id=\"category\" onSubmit={handleSubmit(sumbit)}>\r\n        <Grid container spacing={2}>\r\n          <Grid item md={12}>\r\n            <TextInput name=\"name.uz\" control={control} label={t(\"common.name\") + ' (Uz)'} />\r\n          </Grid>\r\n          <Grid item md={12}>\r\n            <TextInput name=\"name.ru\" control={control} label={t(\"common.name\") + ' (Ru)'} />\r\n          </Grid>\r\n          <Grid item md={12}>\r\n            <TextInput name=\"name.en\" control={control} label={t(\"common.name\") + ' (En)'} />\r\n          </Grid>\r\n          <Grid item md={12}>\r\n            <ImageInput\r\n              control={control}\r\n              setValue={setValue}\r\n              name=\"imageId\"\r\n              rules={{ required: false }}\r\n              accept=\".png, .jpg, .jpeg\"\r\n            />\r\n          </Grid>\r\n        </Grid>\r\n      </form>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default CategoryChildForm;\r\n","import { DragTable, FormDrawer, Table } from \"components\";\r\nimport { useCategoryCol, useCategoryColumns } from \"./categoryChild.columns\"\r\nimport { useAppDispatch } from \"store/storeHooks\";\r\nimport { setOpenDrawer } from \"components/elements/FormDrawer/formdrawer.slice\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { useState } from \"react\";\r\nimport CategoryForm from \"../components/CategoryForm\";\r\nimport { useForm } from \"react-hook-form\";\r\nimport WarningModal from \"components/common/WarningModal/WarningModal\";\r\nimport { useRoleManager } from \"services/useRoleManager\";\r\nimport useAllQueryParams from \"hooks/useGetAllQueryParams/useAllQueryParams\";\r\nimport CategoryChildForm from \"./CategoryChildForm\";\r\n\r\nconst CategoryChild = () => {\r\n  const [render, setRender] = useState<boolean>(false);\r\n  // const columns = useCategoryColumns();\r\n  const [editingCategoryId, setEditingCategoryId] = useState<any>();\r\n  const [categoryId, setCategoryId] = useState<any>();\r\n  const columnsDrag = useCategoryCol({ setEditingCategoryId, setCategoryId });\r\n  const dis = useAppDispatch();\r\n  const { t } = useTranslation();\r\n  const formStore = useForm<any>();\r\n  const hasAccess = useRoleManager();\r\n\r\n  const resetForm = () => {\r\n    setEditingCategoryId(undefined);\r\n    formStore.reset({\r\n      name: \"\",\r\n      imageId: \"\",\r\n    });\r\n  };\r\n\r\n  const allParams = useAllQueryParams();\r\n\r\n  return (\r\n    <>\r\n      {/* <Table\r\n        columns={columns}\r\n        dataUrl=\"category/product\"\r\n        searchable\r\n        onAddButton={() => dis(setOpenDrawer(true))}\r\n        onEditColumn={(row) => {\r\n          setEditingCategoryId(row._id);\r\n          dis(setOpenDrawer(true));\r\n        }}\r\n        onDeleteColumn={(row) => setCategoryId(row._id)}\r\n      /> */}\r\n\r\n      <DragTable\r\n        columns={columnsDrag}\r\n        dataUrl={`/category/paging`}\r\n        dragUrl=\"/category/positions\"\r\n        dragKey=\"categoryIds\"\r\n        render={render}\r\n        setRender={setRender}\r\n        onAddButton={() => dis(setOpenDrawer(true))}\r\n        exQueryParams={{\r\n          parentId: allParams.parentId,\r\n        }}\r\n      />\r\n      <WarningModal\r\n        open={categoryId}\r\n        setOpen={setCategoryId}\r\n        setRender={setRender}\r\n        url=\"category/delete\"\r\n      />\r\n      <FormDrawer\r\n        FORM_ID=\"category\"\r\n        isEditing={!!editingCategoryId}\r\n        customTitle={t(\"general.addCategory\")}\r\n        onClose={resetForm}\r\n      >\r\n        <CategoryChildForm\r\n          formStore={formStore}\r\n          setRender={setRender}\r\n          resetForm={resetForm}\r\n          editingCategoryId={editingCategoryId}\r\n        />\r\n      </FormDrawer>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default CategoryChild;\r\n","import { IconButton } from \"@mui/material\";\r\nimport { GridColumns } from \"@mui/x-data-grid\";\r\nimport { DeleteIcon } from \"assets/svgs\";\r\nimport { setOpenDrawer } from \"components/elements/FormDrawer/formdrawer.slice\";\r\nimport EditIcon from \"components/elements/Table/assets/EditIcon\";\r\nimport { get } from \"lodash\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { useRoleManager } from \"services/useRoleManager\";\r\nimport { useAppDispatch } from \"store/storeHooks\";\r\nimport { numberFormat } from \"utils/numberFormat\";\r\n\r\nexport const useCategoryColumns = (): GridColumns => {\r\n  const { t } = useTranslation();\r\n\r\n  return [\r\n    {\r\n      field: t(\"common.categoryName\"),\r\n      renderCell({ row }) {\r\n        return get(row, \"name\", \"\");\r\n      },\r\n    },\r\n  ];\r\n};\r\n\r\ninterface IUseStoreCol {\r\n  setCategoryId?: React.Dispatch<React.SetStateAction<string>>;\r\n  setEditingCategoryId?: React.Dispatch<React.SetStateAction<string>>;\r\n}\r\n\r\nexport const useCategoryCol = ({\r\n  setCategoryId,\r\n  setEditingCategoryId,\r\n}: IUseStoreCol) => {\r\n  const dis = useAppDispatch();\r\n  const { t } = useTranslation();\r\n  const hasAccess = useRoleManager();\r\n  const currentLang = localStorage.getItem(\"i18nextLng\") || \"uz\";\r\n\r\n  return [\r\n    {\r\n      key: \"sort\",\r\n      width: \"5%\",\r\n    },\r\n    {\r\n      title: \"â„–\",\r\n      dataIndex: \"id\",\r\n      key: \"id\",\r\n      width: \"5%\",\r\n      render: (item: any, record: any, index: number) => <>{index + 1}</>,\r\n    },\r\n    {\r\n      title: t(\"common.categoryName\"),\r\n      dataIndex: \"name\",\r\n      key: \"name\",\r\n      render: (text: string, record: any) => (\r\n          // @ts-ignore\r\n          text?.[currentLang]\r\n      ),\r\n    },\r\n    {\r\n      title: t(\"common.product\") + \" soni\",\r\n      dataIndex: \"productCount\",\r\n      key: \"productCount\",\r\n      render: (text: string, record: any) => {\r\n        return numberFormat(text);\r\n      },\r\n    },\r\n    {\r\n      title: \"\",\r\n      render: (_: any, record: any) => {\r\n        return (\r\n          <div className=\"d-flex gap-2 justify-content-end\">\r\n            {hasAccess(\"categoryCreate\") && (\r\n              <IconButton\r\n                onClick={() => {\r\n                  setEditingCategoryId?.(record?._id);\r\n                  dis(setOpenDrawer(true));\r\n                }}\r\n              >\r\n                <EditIcon />\r\n              </IconButton>\r\n            )}\r\n            {hasAccess(\"categoryDelete\") && (\r\n              <IconButton onClick={() => setCategoryId?.(record?._id)}>\r\n                <DeleteIcon />\r\n              </IconButton>\r\n            )}\r\n          </div>\r\n        );\r\n      },\r\n    },\r\n  ];\r\n};\r\n","export const numberFormat = (number: any) => {\r\n  if (number || number === 0) {\r\n    // Floating-point xatoliklarni oldini olish\r\n    const rounded = Math.round((number + Number.EPSILON) * 100) / 100;\r\n\r\n    return rounded\r\n      .toLocaleString(\"en-US\", {\r\n        minimumFractionDigits: 0, // Har doim 2 kasr\r\n        maximumFractionDigits: 0, // Kasr 2 dan oshmaydi\r\n      })\r\n      .replaceAll(\",\", \" \"); // Minglik ajratgich\r\n  }\r\n  return \"\";\r\n};\r\n"],"names":["_ref","formStore","resetForm","editingCategoryId","setRender","t","useTranslation","control","handleSubmit","reset","setValue","allParams","useAllQueryParams","mutate","status","useApiMutation","data","getByIdData","getByIdStatus","useApi","concat","enabled","suspense","useEffect","prev","name","imageId","image","_jsx","className","children","id","onSubmit","_data$imageId","_objectSpread","_id","parentId","_jsxs","Grid","container","spacing","item","md","TextInput","label","ImageInput","rules","required","accept","CategoryChild","render","useState","setEditingCategoryId","categoryId","setCategoryId","columnsDrag","_ref2","dis","useAppDispatch","hasAccess","useRoleManager","currentLang","localStorage","getItem","key","width","title","dataIndex","record","index","_Fragment","text","numberFormat","_","IconButton","onClick","setOpenDrawer","EditIcon","DeleteIcon","useCategoryCol","useForm","undefined","DragTable","columns","dataUrl","dragUrl","dragKey","onAddButton","exQueryParams","WarningModal","open","setOpen","url","FormDrawer","FORM_ID","isEditing","customTitle","onClose","CategoryChildForm","number","Math","round","Number","EPSILON","toLocaleString","minimumFractionDigits","maximumFractionDigits","replaceAll"],"sourceRoot":""}