"use strict";(self.webpackChunkbestune_admin=self.webpackChunkbestune_admin||[]).push([[706],{64706:function(n,e,t){t.r(e),t.d(e,{default:function(){return Gn}});var i,o,a=t(57689),r=t(1413),d=t(29439),l=t(61889),s=t(21836),c=t(62750),u=t(72186),m=t(40630),p=t(59460),v=t(25850),f=t(30168),x=t(17939),h=x.default.div(i||(i=(0,f.Z)(["\n  .MuiToggleButton-root {\n    border-radius: 12px;\n    background-color: #f5f5f5 !important;\n    z-index: 2;\n    transition: all 0.3s ease;\n    &.active {\n      background-color: #EB5B00 !important;\n    }\n  }\n"]))),g=t(80184),b=function(){var n=(0,a.s0)(),e=(0,a.TH)().pathname;return(0,g.jsx)(h,{path:(0,v.Yt)(e),children:(0,g.jsxs)(u.Z,{color:"primary",value:(0,v.Yt)(e),exclusive:!0,onChange:function(e,t){t&&n("/order/".concat(t))},"aria-label":"Platform",children:[(0,g.jsx)(m.Z,{value:"table",className:"table"===(0,v.Yt)(e)?"active":"",children:(0,g.jsx)(p.Pp,{})}),(0,g.jsx)(m.Z,{value:"board",className:"board"===(0,v.Yt)(e)?"active":"",children:(0,g.jsx)(p.b1,{})})]})})},j=t(72791),y=t(39230),N=t(29001),Z=t(79405),w=t(50131),k=t(45489),S=t(97892),C=t.n(S),I=t(90816),A=x.default.div(o||(o=(0,f.Z)(["\n  margin-bottom: 5px;\n  .MuiInputBase-root {\n    background-color: ",";\n    color: "," !important;\n  }\n  & .MuiSelect-select.Mui-disabled {\n    color: "," !important;\n    -webkit-text-fill-color: "," !important;\n  }\n\n  & svg {\n    path {\n      fill: "," !important;\n    }\n  }\n"])),(function(n){return n.stateColor}),(function(n){return n.luma>60?"#232323":"#ffffff"}),(function(n){return n.luma>60?"#232323":"#ffffff"}),(function(n){return n.luma>60?"#232323":"#ffffff"}),(function(n){return n.luma>60?"#232323":"#ffffff"})),_=t(4942),P=t(75912),z=t(27391),E=t(1048),L=t(39500),D=t(71257),M=t(35834),T=t(763),Y=t(11087);var B,V,q=function(n){var e=n.options,t=void 0===e?[]:e,i=n.optionsUrl,o=void 0===i?"":i,a=n.returnOnlyId,l=void 0===a||a,s=n.label,u=n.disabled,m=n.placeholder,p=n.filterName,v=n.nameProp,f=void 0===v?"name":v,x=n.exQueryParams,h=void 0===x?{}:x,b=n.dataProp,N=void 0===b?"data.data":b,Z=n.mapData,w=n.onChange,k=(0,j.useState)(),S=(0,d.Z)(k,2),C=S[0],I=S[1],A=(0,j.useState)(),B=(0,d.Z)(A,2),V=B[0],q=B[1],F=(0,D.Z)(V,600),O=F.debouncedValue,R=F.isDebouncing,U=(0,j.useState)(null),G=(0,d.Z)(U,2),W=G[0],Q=G[1],H=localStorage.getItem("i18nextLng")||"uz";(0,j.useEffect)((function(){I({search:V})}),[O]);var K=(0,c.h_)(o,(0,r.Z)((0,r.Z)({},C),h),{enabled:!!o,suspense:!1}),X=K.data,J=K.isFetching,$=function(n){return null!==n&&void 0!==n&&n.firstName?"".concat(null===n||void 0===n?void 0:n.firstName," ").concat(null===n||void 0===n?void 0:n.lastName):null===n||void 0===n?void 0:n[f]},nn=((0,T.get)(X,N)||t).map((function(n){return(0,r.Z)((0,r.Z)({},n),{},{name:$(n)})})),en=(0,Y.lr)(),tn=(0,d.Z)(en,2),on=(tn[0],tn[1]),an=(0,M.Z)(),rn=(0,y.$G)().t;return(0,g.jsxs)(E.M,{children:[s&&(0,g.jsx)("label",{children:s}),(0,g.jsx)(P.Z,{options:Z?Z(nn):nn,getOptionLabel:function(n){var e;return(null===n||void 0===n||null===(e=n.name)||void 0===e?void 0:e[H])||""},onChange:function(n,e){null===w||void 0===w||w(e),Q(l?null===e||void 0===e?void 0:e._id:e),p&&(e?on((0,r.Z)((0,r.Z)({},an),{},(0,_.Z)({},p,null===e||void 0===e?void 0:e._id))):(delete an[p],on((0,r.Z)({},an))))},loading:J||R,disabled:u,sx:{"& fieldset":{border:"none"}},loadingText:"izlamoqda...",noOptionsText:!R&&"malumot topilmadi",value:l?(0,L.e)(nn,W):W,renderInput:function(n){return(0,g.jsx)(g.Fragment,{children:(0,g.jsx)(z.Z,(0,r.Z)((0,r.Z)({},n),{},{inputProps:(0,r.Z)((0,r.Z)({},n.inputProps),{},{onChange:function(e){var t,i;null===n||void 0===n||null===(t=n.inputProps)||void 0===t||null===(i=t.onChange)||void 0===i||i.call(t,e),q(e.target.value||"")}}),onBlur:function(){return q(void 0)},variant:"outlined",fullWidth:!0,placeholder:m||rn("LABELS.ROLE_ALL.TITLE")}))})}})]})},F=t(55210),O=function(){var n=(0,j.useState)(),e=(0,d.Z)(n,2),t=e[0],i=e[1],o=(0,Z.T)(),u=((0,N.w)(),(0,Z.C)((function(n){return n.SocketState.render}))),m=(0,M.Z)(),p=(0,j.useState)([]),v=(0,d.Z)(p,2),f=v[0],x=v[1],h=(0,c.uC)("order/state/".concat(null===t||void 0===t?void 0:t.orderId),"put",{onSuccess:function(){i(void 0),o((0,s.xV)(!0))}}),S=h.mutate,_=h.reset;(0,j.useEffect)((function(){t&&S({stateId:t.stateId,_id:t.orderId,position:1})}),[t]);var P=function(n,e){var t=(0,y.$G)().t;return[{field:t("common.number"),renderCell:function(n){return n.row.number},flex:.6},{field:t("common.price"),renderCell:function(n){var e=n.row;return(0,I.Y)(e.totalPrice)},flex:.6},{field:t("order.receiver"),renderCell:function(n){var e,t,i=n.row,o=null===i||void 0===i||null===(e=i.customer)||void 0===e?void 0:e.firstName,a=(null===o||void 0===o?void 0:o.length)>10?"".concat(o.substring(0,10),"..."):o,r=null===i||void 0===i||null===(t=i.customer)||void 0===t?void 0:t.lastName,d=(null===r||void 0===r?void 0:r.length)>10?"".concat(r.substring(0,10),"..."):r,l="".concat(a).concat(r?" ".concat(d):""),s="".concat(o).concat(r?" ".concat(r):"");return(0,g.jsx)(w.Z,{title:s,arrow:!0,children:(0,g.jsx)("span",{children:l})})}},{field:t("common.phoneNumber"),renderCell:function(n){var e;return null===(e=n.row.customer)||void 0===e?void 0:e.phoneNumber}},{field:t("common.receiverPhoneNumber"),renderCell:function(n){var e;return null===(e=n.row.receiverCustomer)||void 0===e?void 0:e.phoneNumber}},{field:t("common.paymentType"),renderCell:function(n){var e=n.row;return t("enum.".concat(e.paymentType))},flex:.6},{field:"store",headerName:"Do'kon",renderCell:function(n){var e,t=n.row;return null!==t&&void 0!==t&&null!==(e=t.store)&&void 0!==e&&e.name?t.store.name:"string"===typeof(null===t||void 0===t?void 0:t.storeId)?"uygaayt"===t.storeId.toLowerCase()?"Uygaayt":t.storeId:null!==t&&void 0!==t&&t.storeId&&"object"===typeof t.storeId?t.storeId.toString():(null===t||void 0===t?void 0:t.storeId)||"-"},flex:.8},{field:t("common.time"),renderCell:function(n){var e=n.row;return C()(e.createdAt).format("DD.MM.YYYY HH:mm")}},{field:t("common.status"),renderCell:function(t){var i,o,a,r,d,l=t.row,s=null===l||void 0===l||null===(i=l.state)||void 0===i||null===(o=i.color)||void 0===o?void 0:o.substring(1),c=parseInt(s,16),u=.2126*(c>>16&255)+.7152*(c>>8&255)+.0722*(255&c);return(0,g.jsx)(A,{stateColor:null===l||void 0===l||null===(a=l.state)||void 0===a?void 0:a.color,luma:u,onClick:function(n){return n.stopPropagation()},children:(0,g.jsx)(k.Ph,{onChange:function(e){return n({stateId:e,orderId:l._id})},customValue:l.stateId,options:e,disabled:"completed"===(null===(r=l.state)||void 0===r?void 0:r.state)||"cancelled"===(null===(d=l.state)||void 0===d?void 0:d.state)})})}}]}(i,f),z=(0,a.s0)(),E=(0,y.$G)().t;(0,j.useEffect)((function(){u&&(_(),o((0,F.zm)(!1)))}),[u]);var L=(0,g.jsx)(g.Fragment,{children:(0,g.jsxs)(l.ZP,{className:"lg:w-[60%] w-full gap-y-2 sm:gap-y-0 grid sm:grid-cols-3 items-center gap-x-2",children:[(0,g.jsx)(l.ZP,{item:!0,className:"",children:(0,g.jsx)(q,{optionsUrl:"order-state/get-all",filterName:"stateId",placeholder:E("common.status"),dataProp:"data"})}),(0,g.jsx)(l.ZP,{item:!0,className:"",children:(0,g.jsx)(k.$m,{})}),(0,g.jsx)(l.ZP,{item:!0,className:" flex justify-end",children:(0,g.jsx)(b,{})})]})}),D=(0,c.h_)("order-state/get-all",{},{onSuccess:function(n){var e=n.data;x(e||[])}});D.data,D.status,D.refetch;return(0,g.jsx)(g.Fragment,{children:(0,g.jsx)(k.iA,{dataUrl:"/order/paging",columns:P,headerChildren:L,searchable:!0,onAddButton:function(){return z("/order/add")},onRowClick:function(n){return z("/order/".concat(n._id))},exQueryParams:(0,r.Z)({},null!==m&&void 0!==m&&m.stateId&&""!==m.stateId.trim()?{stateId:m.stateId}:{})})})},R=t(93433),U=t(48541),G=t(31976),W=t(23786),Q=t(13400),H=function(n,e){var t,i=j.useState(null),o=(0,d.Z)(i,2),a=o[0],r=o[1],l=function(){r(null)};return(0,g.jsxs)("div",{className:"d-flex justify-content-between align-items-center lane_title",children:[(0,g.jsx)("h3",{children:n.title}),(0,g.jsx)("div",{children:0===(null===(t=n.cards)||void 0===t?void 0:t.length)?(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(Q.Z,{"aria-owns":a?"simple-menu":void 0,"aria-haspopup":"true",onClick:function(n){r(n.currentTarget)}}),(0,g.jsx)(G.Z,{id:"simple-menu",anchorEl:a,open:Boolean(a),onClose:l,children:(0,g.jsx)(W.Z,{onClick:function(){e({ids:[null===n||void 0===n?void 0:n.id]}),n.onDelete(null===n||void 0===n?void 0:n.id),l()},children:"Statusni o'chirish"})})]}):" "})]})},K=x.default.div(B||(B=(0,f.Z)(["\n  position: relative;\n  overflow-y: hidden !important;\n  background-color: #fff;\n  padding: 20px;\n  border-radius: 12px;\n  box-shadow: 0px 0px 4px 0px rgba(0, 0, 0, 0.07);\n  .header {\n    display: flex;\n    align-items: center;\n    justify-content: end;\n    margin-bottom: 10px;\n  }\n  .react-trello-board {\n    background-color: transparent;\n    height: 75vh !important;\n    padding: 0;\n    .react-trello-lane {\n      position: relative;\n      border-radius: 12px;\n      border: 1px solid #d9d9d9;\n      background-color: #ffffff;\n      width: 260px;\n      max-height: 70vh;\n      & {\n        width: 200px;\n      }\n      div:nth-child(2):not(div.smooth-dnd-draggable-wrapper) {\n        margin-top: 45px;\n        &::-webkit-scrollbar {\n          width: 10px;\n        }\n        &::-webkit-scrollbar-track {\n          background-color: #f6f6f6;\n          border-radius: 3px;\n        }\n        &::-webkit-scrollbar-thumb {\n          background-color: #d9d9d9;\n          border-radius: 3px;\n\n          &:hover {\n            background-color: #999;\n          }\n        }\n      }\n      width: 12px;\n      header {\n        padding-bottom: 3px;\n        margin-bottom: 5px;\n        button {\n          display: none;\n        }\n      }\n      .lane_title {\n        position: absolute;\n        top: 0;\n        left: 0;\n        height: 48px;\n        width: 100%;\n        border-radius: 8px 8px 0 0;\n        display: flex;\n        align-items: center;\n        justify-content: space-between;\n        padding: 0 12px;\n        border-bottom: 1px solid #d9d9d9;\n      }\n    }\n    .react-trello-card {\n      border-radius: 8px;\n      border: 1px solid #d9d9d9;\n      background-color: #f8f8f8;\n      min-height: 70px;\n      textarea {\n        pointer-events: none !important;\n        font-size: 14px;\n        font-weight: 600;\n        color: #006ffd;\n      }\n      span:nth-child(2) textarea {\n        color: #000;\n        text-align: left;\n      }\n      div {\n        textarea {\n          color: #888888;\n          font-size: 14px;\n          font-weight: 500;\n        }\n      }\n    }\n    .smooth-dnd-draggable-wrapper,\n    .smooth-dnd-container {\n      article {\n        header {\n          display: flex;\n          flex-direction: column;\n          span {\n            width: 100%;\n          }\n          textarea {\n          }\n        }\n        div {\n          margin: 0 !important ;\n          padding: 0 !important;\n        }\n      }\n    }\n  }\n  .add-lane-form {\n    border-radius: 12px;\n    padding: 10px;\n    width: 300px;\n    background-color: #d9d9d9;\n    .MuiInputBase-input {\n      border: 1px solid #999;\n      background-color: white;\n    }\n  }\n  .filters {\n    .MuiAutocomplete-root {\n      position: relative;\n    }\n    margin-bottom: 1rem;\n    label {\n      position: absolute;\n      top: -15px;\n    }\n  }\n  .load-more {\n    width: 100%;\n    background-color: transparent !important;\n    height: 30px;\n  }\n"])));x.default.div(V||(V=(0,f.Z)(["\n  background-color: #f5f5f5;\n  border: 1px solid #f5f5f5;\n  border-radius: 12px;\n  margin-right: 18px;\n  .MuiToggleButton-root {\n    border-radius: 12px;\n    &:last-child {\n      background-color: #0f6fdf;\n      border-radius: 12px !important;\n      z-index: 2;\n      transition: all 0.3s ease !important;\n\n      &:hover {\n        background-color: #0f6fdf;\n      }\n    }\n    &:first-child {\n      border: none;\n      border-radius: 12px !important;\n      transition: all 0.3s ease !important;\n\n      &:hover {\n        background-color: #0f6fdf;\n      }\n    }\n  }\n"])));var X,J,$,nn,en,tn,on=t(57690),an=t(68002),rn=(0,U.er)({"Add another lane":"+Status qo'shish","Click to add card":"Buyurtma qo'shish","Delete lane":"Statusni o'chirish","Lane actions":"Status ustidagi amallar",button:{"Add card":"Buyurtma qo'shing","Add lane":"Status qo'shish",Cancel:"Bekor qilish"},placeholder:{title:"Nomi",description:"Tavsif",label:"Yorliq"}}),dn=function(){var n=(0,M.Z)(),e=(0,y.$G)().t,t=(0,a.s0)(),i=(0,j.useState)(),o=(0,d.Z)(i,2),l=o[0],u=o[1],m=(0,j.useState)(!1),p=(0,d.Z)(m,2),v=p[0],f=p[1],x=(0,j.useState)(""),h=(0,d.Z)(x,2),w=h[0],S=h[1],C=(0,j.useState)({}),I=(0,d.Z)(C,2),A=I[0],P=I[1],z=(0,j.useState)({}),E=(0,d.Z)(z,2),L=E[0],D=E[1],T=((0,N.w)(),(0,Z.C)((function(n){return n.SocketState.render}))),Y=(0,Z.T)(),B=(0,j.useState)(),V=(0,d.Z)(B,2),q=V[0],O=V[1],G=(0,c.h_)("order-state/get-all",(0,r.Z)({},n),{suspense:!1}),W=G.data,Q=G.status,X=G.refetch,J=(0,c.uC)("order/state/".concat(null===q||void 0===q?void 0:q.orderId),"put",{onSuccess:function(){O(void 0),Y((0,s.xV)(!0))}}),$=J.mutate,nn=J.reset;(0,j.useEffect)((function(){q&&$({stateId:q.stateId,_id:q.orderId,position:1})}),[q]);var en=(0,c.uC)("order/paging","post",{onSuccess:function(n,e){var t=n.data,i=e.stateId;u((function(n){return n?n.map((function(n){if(n._id===i){var e,o,a=1===L[i]?[]:n.orders||[],d=new Set(a.map((function(n){return n._id}))),l=null===t||void 0===t||null===(e=t.data)||void 0===e||null===(o=e.filter((function(n){return!d.has(n._id)})))||void 0===o?void 0:o.map((function(n){var e;return{number:n.number,totalPrice:n.totalPrice,addressName:n.addressName,createdAt:n.createdAt,state:null===(e=n.state)||void 0===e?void 0:e.state,_id:n._id,uniqueId:"".concat(n._id,"-").concat(n.createdAt)}}));return(0,r.Z)((0,r.Z)({},n),{},{orders:[].concat((0,R.Z)(a),(0,R.Z)(l||[]))})}return n})):n})),P((function(n){return(0,r.Z)((0,r.Z)({},n),{},(0,_.Z)({},i,!1))}))},onError:function(n,e){var t=e.stateId;P((function(n){return(0,r.Z)((0,r.Z)({},n),{},(0,_.Z)({},t,!1))}))}}),tn=en.mutate,dn=en.reset;(0,j.useEffect)((function(){T&&(nn(),dn(),X(),Y((0,F.zm)(!1)))}),[T]);(0,j.useEffect)((function(){var n=function(n){var e;null!==(e=n.data.state)&&void 0!==e&&e.isSoundable&&function(){try{new Audio(an).play()}catch(n){}}(),u((function(e){return e?e.map((function(e){if(e._id===n.data.stateId){var t,i={number:n.data.number,totalPrice:n.data.totalPrice,addressName:n.data.addressName,createdAt:n.data.createdAt,state:null===(t=n.data.state)||void 0===t?void 0:t.state,_id:n.data._id,uniqueId:"".concat(n.data._id,"-").concat(n.data.createdAt)},o=new Set((e.orders||[]).map((function(n){return n._id})));return o.has(i._id)?e:(0,r.Z)((0,r.Z)({},e),{},{orders:[].concat((0,R.Z)(e.orders||[]),[i])})}return e})):e}))};return on.W.on("orderCreated",n),function(){on.W.off("orderCreated",n)}}),[]),(0,j.useEffect)((function(){if("success"===Q&&null!==W&&void 0!==W&&W.data){u(W.data);var n=W.data.reduce((function(n,e){return(0,r.Z)((0,r.Z)({},n),{},(0,_.Z)({},e._id,1))}),{});D(n),W.data.forEach((function(n){P((function(e){return(0,r.Z)((0,r.Z)({},e),{},(0,_.Z)({},n._id,!0))})),tn({page:1,limit:10,stateId:n._id})}))}}),[Q,null===W||void 0===W?void 0:W.data]),(0,j.useEffect)((function(){l&&Object.values(A).every((function(n){return!n}))&&f(!0)}),[l,A]);var ln=(0,c.uC)("order/state/".concat(w),"put",{onSuccess:function(){S("")}}).mutate,sn=(0,c.uC)("status","put").mutate,cn=(0,c.uC)("status","delete").mutate,un=(0,j.useMemo)((function(){return v?function(n){var e=localStorage.getItem("i18nextLng")||"uz";return{lanes:null===n||void 0===n?void 0:n.map((function(n){var t,i;return{cards:(null===(t=n.orders)||void 0===t?void 0:t.map((function(n,e){return{id:n.uniqueId||n._id,label:"".concat(n.totalPrice," UZS"),title:"#".concat(n.number),description:n.addressName,draggable:!["completed","cancelled"].includes(n.state),metadata:{originalId:n._id}}})))||[],id:null===n||void 0===n?void 0:n._id,title:null===(i=n.name)||void 0===i?void 0:i[e],statusColor:n.color,style:{width:280,borderTop:"".concat("#ffffff"!==n.color?n.color:"#364880"," 5px solid")}}}))}}(l||[]):{lanes:[]}}),[l,v]);return(0,g.jsxs)(K,{children:[(0,g.jsx)("div",{className:"header",children:(0,g.jsx)(b,{})}),v?(0,g.jsx)(U.ZP,{data:un,editable:!0,handleDragEnd:function(n,e,t,i,o){var a;S((null===(a=o.metadata)||void 0===a?void 0:a.originalId)||o.id),setTimeout((function(){var n;return ln({position:i,stateId:t,_id:null===o||void 0===o||null===(n=o.metadata)||void 0===n?void 0:n.originalId})}),0)},handleLaneDragEnd:function(n,e,t){sn({_id:t.id,position:+e+1})},editLaneTitle:!1,canAddLanes:!1,hideCardDeleteIcon:!0,onCardClick:function(n,e){var i=null===e||void 0===e?void 0:e.originalId;i&&t("/order/".concat(i))},components:{LaneHeader:function(n){return H(n,cn)},AddCardLink:function(n){var t=n.laneId;return(0,g.jsx)(k.c7,{title:A[t]?e("general.loading"):e("general.loadMore"),className:"load-more",disabled:A[t],onClick:function(){return function(n){if(!A[n]){P((function(e){return(0,r.Z)((0,r.Z)({},e),{},(0,_.Z)({},n,!0))}));var e=(L[n]||1)+1;D((function(t){return(0,r.Z)((0,r.Z)({},t),{},(0,_.Z)({},n,e))})),tn({page:e,limit:10,stateId:n})}}(t)}})}},lang:"ru",t:rn}):(0,g.jsx)(k.gb,{})]})},ln=x.default.div(X||(X=(0,f.Z)(["\n  margin-top: 12px;\n"]))),sn=x.default.div(J||(J=(0,f.Z)(["\n  border-radius: 12px;\n  background: #fff;\n  box-shadow: 0px 0px 4px 0px rgba(0, 0, 0, 0.07);\n  padding: 16px;\n  height: calc(100vh - 110px);\n  overflow: auto;\n  .tab {\n    margin-bottom: 16px;\n    .tab-btn {\n      color: #999;\n      font-size: 14px;\n      font-weight: 600;\n      padding: 12px;\n      width: 50%;\n      border: none;\n      border-bottom: 2px solid #e9e9e9;\n      background: none;\n      cursor: pointer;\n      &.active {\n        color: #000;\n        border-bottom: 2px solid #006ffd;\n      }\n    }\n  }\n  .search {\n    display: flex;\n    align-items: center;\n    justify-content: end;\n    > div {\n      width: 100%;\n    }\n    .clear-basket {\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      max-width: 42px;\n      min-width: 42px;\n      height: 42px;\n      border-radius: 10px;\n      background: #f5f5f5;\n      margin-left: 30px;\n      cursor: pointer;\n      svg path {\n        fill: #999;\n      }\n    }\n  }\n  .product-card {\n    position: relative;\n    padding: 10px;\n    border-radius: 16px;\n    background: #f5f5f5;\n    cursor: pointer;\n    .amount {\n      position: absolute;\n      top: -10px;\n      left: -10px;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      font-size: 12px;\n      font-weight: 600;\n      min-width: 25px;\n      padding: 5px;\n      height: 25px;\n      border-radius: 50%;\n      background-color: #006ffd;\n      color: #fff;\n    }\n    .name {\n      display: -webkit-box;\n      -webkit-line-clamp: 1;\n      -webkit-box-orient: vertical;\n      color: #454545;\n      font-size: 14px;\n      line-height: 20px;\n      overflow: hidden;\n    }\n    .price {\n      display: block;\n      font-size: 14px;\n      margin-top: 10px;\n      font-weight: 600;\n    }\n    .in-stock {\n      font-size: 12px;\n      color: #999;\n    }\n  }\n  .basket-item {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    padding: 8px 0;\n    border-bottom: 1px solid #e9e9e9;\n    .name {\n      font-size: 14px;\n      color: #454545;\n      padding-left: 10px;\n      width: 75%;\n      word-wrap: break-word;\n    }\n    .action {\n      display: flex;\n      align-items: center;\n      span {\n        border-radius: 8px;\n        background: #f5f5f5;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n      }\n      .icon {\n        width: 34px;\n        height: 34px;\n        cursor: pointer;\n      }\n      .amount-input {\n        display: block;\n        height: 34px;\n        padding: 0 10px;\n        width: 64px;\n        margin: 0 8px;\n        border-radius: 8px;\n        background: #f5f5f5;\n        border: none;\n        font-size: 16px;\n        font-weight: 600;\n        text-align: center;\n      }\n    }\n  }\n"]))),cn=t(61134),un=t(81502),mn=t(697),pn=t(29749),vn=t(93385),fn=t(40260),xn=function(n){var e=n.totalItems,t=n.itemsPerPage,i=n.allParams,o=n.setSearchParams,a=(0,j.useState)(parseInt(i.page||"1")),l=(0,d.Z)(a,2),s=l[0],c=l[1],u=Math.ceil(e/t),m=function(n){n<1||n>u||(c(n),o((0,r.Z)((0,r.Z)({},i),{},{page:n.toString(),limit:t.toString()})))};return(0,j.useEffect)((function(){o((0,r.Z)((0,r.Z)({},i),{},{page:s.toString(),limit:t.toString()}))}),[s]),(0,g.jsxs)("div",{className:"pagination flex items-center justify-center space-x-3 mt-4",children:[(0,g.jsx)("button",{onClick:function(){return m(s-1)},disabled:s<=1,className:"pagination-btn p-1 bg-gray-300 rounded-lg text-gray-700 disabled:opacity-50",children:(0,g.jsx)(fn.Z,{})}),(0,g.jsxs)("span",{className:"text-lg",children:["Page ",s," of ",u]}),(0,g.jsx)("button",{onClick:function(){return m(s+1)},disabled:s>=u,className:"pagination-btn p-1 bg-gray-300 rounded-lg text-gray-700 disabled:opacity-50",children:(0,g.jsx)(vn.Z,{})})]})},hn=function(n){var e,t,i,o,a,s,u,m=n.basketItems,v=n.setBasketItems,f=(0,j.useState)("product"),x=(0,d.Z)(f,2),h=x[0],b=x[1],N=(0,j.useState)(!1),w=(0,d.Z)(N,2),S=w[0],C=w[1],A=(0,j.useState)(null),_=(0,d.Z)(A,2),P=_[0],z=_[1],E=(0,j.useState)([]),L=(0,d.Z)(E,2),B=L[0],V=L[1],q=(0,M.Z)(),F=(0,cn.cI)(),O=(F.control,F.watch,(0,j.useState)(q.search||"")),U=(0,d.Z)(O,2),G=U[0],W=U[1],Q=(0,D.Z)(G,500).debouncedValue,H=(0,y.$G)().t,K=(0,Y.lr)(),X=(0,d.Z)(K,2),J=X[0],$=X[1],nn=(0,Z.C)((function(n){return n.tableState.render})),en=localStorage.getItem("i18nextLng")||"uz",tn=(0,j.useState)({page:J.get("page")||1,limit:J.get("limit")||10,search:J.get("search")||""}),on=(0,d.Z)(tn,2),an=on[0],rn=on[1];(0,j.useEffect)((function(){$((0,r.Z)((0,r.Z)({},q),{},{search:G||"",page:G?"1":q.page||"1",limit:q.limit||"10"}))}),[Q]);var dn=(0,pn.Z)().state.data,ln=(0,c.uC)("product/paging","post",{onSuccess:function(n){rn((0,r.Z)((0,r.Z)({},q),{},{search:Q||"",page:G?"1":q.page||"1",limit:q.limit||"10"}))},onError:function(n){console.error("Error creating product:",n)}}),vn=ln.data,fn=ln.mutate;(0,j.useEffect)((function(){fn((0,r.Z)((0,r.Z)({},an),q))}),[nn,Q,J]);var hn=function(n,e,t){var i=null===m||void 0===m?void 0:m.find((function(e){return e._id===(null===n||void 0===n?void 0:n._id)}));if(i)return"minus"===e&&1===i.amount?v((function(n){return n.filter((function(n){return n._id!==i._id}))})):v((function(o){return o.map((function(o){if(o._id===(null===n||void 0===n?void 0:n._id)){var a=o.amount;return(0,r.Z)((0,r.Z)({},o),{},{amount:t?"noValue"===t?"":Number(t)<=n.inStock?Number(t):a:e?"minus"===e&&a>1?a-1:"plus"===e&&i.amount<n.inStock?a+1:a:i.amount<n.inStock?a+1:a})}return o}))}));n&&v((function(e){return[].concat((0,R.Z)(e),[(0,r.Z)((0,r.Z)({},n),{},{amount:1,salom:"hello"})])}))},gn=function(){C(!1),z(null),V([])};return(0,g.jsxs)(sn,{children:[(0,g.jsxs)("div",{className:"tab",children:[(0,g.jsx)("button",{className:"tab-btn ".concat("product"===h&&"active"),onClick:function(){return b("product")},children:H("order.products")}),(0,g.jsx)("button",{className:"tab-btn ".concat("basket"===h&&"active"),onClick:function(){return b("basket")},children:H("order.basket")})]}),(0,g.jsxs)("div",{className:"mb-3 search",children:["product"===h&&(0,g.jsx)(k.Mj,{value:G,onChange:function(n){var e;W(null===n||void 0===n||null===(e=n.target)||void 0===e?void 0:e.value)}}),"basket"===h&&(0,g.jsx)("div",{className:"clear-basket",onClick:function(){return v([])},children:(0,g.jsx)(p.pJ,{})})]}),"product"===h&&(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(l.ZP,{container:!0,spacing:2,children:null===vn||void 0===vn||null===(e=vn.data)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.map((function(n){var e=m.find((function(e){return e._id===n._id}));return(0,g.jsx)(l.ZP,{item:!0,md:4,children:(0,g.jsxs)("div",{className:"product-card",style:{border:"1px solid #e0e0e0",borderRadius:"8px",padding:"16px",backgroundColor:"#F5F5F5",display:"flex",flexDirection:"column",alignItems:"center",gap:"12px",height:"170px",justifyContent:"space-between",transition:"transform 0.2s ease"},onClick:function(){var e;(null===(e=n.attributes)||void 0===e?void 0:e.length)>0?function(n){z(n),C(!0)}(n):hn(n)},onMouseEnter:function(n){return n.currentTarget.style.transform="scale(1.02)"},onMouseLeave:function(n){return n.currentTarget.style.transform="scale(1)"},children:[e&&(0,g.jsxs)("div",{style:{background:"#f44336",color:"#fff",padding:"4px 8px",borderRadius:"12px",fontSize:"12px",position:"absolute",top:"12px",right:"12px"},children:[e.amount," dona"]}),(0,g.jsx)("div",{style:{fontWeight:"600",fontSize:"16px",color:"#333",textAlign:"center"},children:n.name}),(0,g.jsxs)("div",{style:{width:"100%",display:"block",justifyContent:"space-between",fontSize:"14px",textAlign:"center"},children:[!1===(null===n||void 0===n?void 0:n.discountEnabled)?"":(0,g.jsxs)("div",{style:{color:"#ed0e0e"},children:[H("order.original_price"),":",(0,g.jsxs)("s",{style:{marginLeft:"4px"},children:[(0,I.Y)(n.price)," ",(0,T.get)(dn,"currency","uzs")]})]}),(null===n||void 0===n?void 0:n.discountEnabled)&&(0,g.jsxs)("div",{style:{color:"#4caf50",fontWeight:"bold"},children:[H("common.discount"),": ",(0,I.Y)(null===n||void 0===n?void 0:n.discountValue)," ","percent"===(null===n||void 0===n?void 0:n.discountType)?"%":(0,T.get)(dn,"currency","uzs")]})]}),(0,g.jsxs)("div",{style:{fontSize:"18px",fontWeight:"700",color:"#000"},children:[(0,I.Y)(n.salePrice)," ",(0,T.get)(dn,"currency","uzs")]}),(0,g.jsxs)("div",{style:{fontSize:"12px",color:"#757575",marginTop:"8px"},children:[H("order.in_warehouse"),": ",(0,I.Y)(n.inStock)]})]})},n._id)}))}),(0,g.jsx)(l.ZP,{children:(0,g.jsx)(xn,{totalItems:null===vn||void 0===vn||null===(i=vn.data)||void 0===i?void 0:i.total,itemsPerPage:+q.limit||10,allParams:q,setSearchParams:$})})]}),(0,g.jsx)(un.Z,{open:S,onClose:gn,"aria-labelledby":"modal-title","aria-describedby":"modal-description",children:(0,g.jsxs)(mn.Z,{sx:{padding:"20px",background:"#fff",borderRadius:"8px",maxWidth:"500px",margin:"auto",boxShadow:"0 4px 10px rgba(0, 0, 0, 0.1)"},children:[(0,g.jsx)("h2",{id:"modal-title",style:{textAlign:"center",marginBottom:"20px",fontSize:"20px",color:"#333"},children:H("general.again_choose")}),null===P||void 0===P||null===(o=P.attributes)||void 0===o?void 0:o.map((function(n,e){var t,i;return(0,g.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,g.jsx)("h3",{style:{fontSize:"16px",fontWeight:"600",color:"#333",marginBottom:"10px",borderBottom:"1px solid #eee",paddingBottom:"5px"},children:(null===n||void 0===n||null===(t=n.attribute)||void 0===t||null===(i=t.name)||void 0===i?void 0:i[en])||""}),(0,g.jsx)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px",marginTop:"10px"},children:n.items.map((function(e,t){return(0,g.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",padding:"10px",border:B.some((function(t){var i;return t.attributeId===(null===n||void 0===n||null===(i=n.attribute)||void 0===i?void 0:i._id)&&t.attributeItem===e.attributeItem}))?"2px solid #2196f3":"1px solid #ddd",borderRadius:"8px",backgroundColor:B.some((function(t){var i;return t.attributeId===(null===n||void 0===n||null===(i=n.attribute)||void 0===i?void 0:i._id)&&t.attributeItem===e.attributeItem}))?"#f1f9ff":"#fff",cursor:"pointer",transition:"all 0.3s ease"},onClick:function(){var t,i,o;return i=e,o=null===n||void 0===n||null===(t=n.attribute)||void 0===t?void 0:t._id,void V((function(n){var e=n.filter((function(n){return n.attributeId!==o})),t=[].concat((0,R.Z)(e),[(0,r.Z)((0,r.Z)({},i),{},{attributeId:o})]);return console.log("Updated Variants:",t),t}))},children:[(0,g.jsx)("div",{style:{fontWeight:"500",fontSize:"14px",color:"#333"},children:e.attributeItem}),(0,g.jsxs)("div",{style:{fontSize:"12px",color:"#888",marginTop:"5px"},children:["+ ",(0,I.Y)(e.amount)," ",(0,T.get)(dn,"currency","uzs")]})]},t)}))})]},e)})),(0,g.jsx)("div",{style:{marginTop:"30px",display:"flex",justifyContent:"center",alignItems:"center"},children:(0,g.jsx)("button",{onClick:function(){if(P&&B){var n=(0,r.Z)((0,r.Z)({},P),{},{variants:B.map((function(n){return{attributeId:n.attributeId,attributeItem:n.attributeItem}}))});hn(n),gn()}},style:{padding:"10px 20px",background:B.length===(null===P||void 0===P||null===(a=P.attributes)||void 0===a?void 0:a.length)?"#4caf50":"#ddd",color:"#fff",border:"none",borderRadius:"4px",cursor:B.length===(null===P||void 0===P||null===(s=P.attributes)||void 0===s?void 0:s.length)?"pointer":"not-allowed",fontSize:"16px",fontWeight:"600",transition:"background-color 0.3s ease"},disabled:B.length!==(null===P||void 0===P||null===(u=P.attributes)||void 0===u?void 0:u.length),children:H("general.add_basket")})})]})}),"basket"===h&&(0,g.jsx)("div",{children:null===m||void 0===m?void 0:m.map((function(n){var e,t;return(0,g.jsxs)("div",{className:"basket-item",children:[(0,g.jsxs)("div",{className:"flex gap-2",children:[(0,g.jsx)("span",{className:"",children:n.name}),(null===n||void 0===n||null===(e=n.variants)||void 0===e?void 0:e.length)>0&&(0,g.jsx)("div",{className:"variant-info flex",children:null===n||void 0===n||null===(t=n.variants)||void 0===t?void 0:t.map((function(n,e){return(0,g.jsx)("div",{className:"variant-item flex",children:(0,g.jsxs)("span",{className:"variant-name ml-1",children:["-",n.attributeItem]})},e)}))})]}),(0,g.jsxs)("div",{className:"action",children:[(0,g.jsx)("span",{className:"icon",onClick:function(){return hn(n,"minus")},children:(0,g.jsx)(p.V_,{})}),(0,g.jsx)("input",{type:"text",className:"amount-input",value:n.amount,onChange:function(e){return hn(n,"",e.target.value||"noValue")}}),(0,g.jsx)("span",{className:"icon",onClick:function(){return hn(n,"plus")},children:(0,g.jsx)(p.pO,{})})]})]},n._id)}))})]})},gn=x.default.div($||($=(0,f.Z)(["\n  border-radius: 12px;\n  background: #fff;\n  box-shadow: 0px 0px 4px 0px rgba(0, 0, 0, 0.07);\n  padding: 16px;\n  max-height: calc(100vh - 110px);\n  overflow: auto;\n  .item {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    margin-bottom: 12px;\n    .key {\n      font-size: 14px;\n    }\n    .value {\n      font-size: 14px;\n      font-weight: 600;\n    }\n    &:last-of-type {\n      .key {\n        font-weight: 600;\n      }\n    }\n  }\n  .submit-btn {\n    width: 100%;\n  }\n"]))),bn=x.default.div(nn||(nn=(0,f.Z)(["\n  width: 860px;\n  height: 500px;\n  background-color: #fff;\n  border-radius: 24px;\n  overflow: hidden;\n  .modal-form {\n    display: flex;\n    flex-direction: column;\n    height: 100%;\n    padding: 24px;\n    .title {\n      display: flex;\n      align-items: center;\n      margin-bottom: 24px;\n      h2 {\n        font-size: 20px;\n        font-weight: 600;\n        margin-left: 23px;\n      }\n    }\n    .address-options {\n      position: absolute;\n      box-shadow: 0px 2px 10px rgba(0, 0, 0, 0.1);\n      padding: 10px 0;\n      border-radius: 10px;\n      background-color: #fff;\n      max-height: 300px;\n      overflow: auto;\n      z-index: 1;\n      .option {\n        padding: 8px 15px;\n        cursor: pointer;\n        &:hover {\n          background-color: #f5f5f5;\n        }\n      }\n    }\n    .save-btn {\n      width: 100%;\n      margin-top: auto;\n    }\n  }\n"]))),jn=t(89303),yn=t(30709),Nn=t(75985),Zn=t(73405),wn=function(n){var e,t,i,o,a,r,l,s,u,m,p=n.getCoordinate,v=n.center,f=n.height,x=n.order,h=(0,j.useState)(v),b=(0,d.Z)(h,2),y=b[0],N=b[1],Z=(0,j.useRef)(null),w=(0,cn.cI)().reset,k=(0,c.h_)("settings-general",{},{onSuccess:function(n){var e=n.data;localStorage.setItem("settings",JSON.stringify(e))}}),S=k.data,C=k.status,I=(k.refetch,(0,c.h_)("store/get",{},{suspense:!1})),A=I.data,_=I.status;(0,j.useEffect)((function(){"success"===C&&w()}),[C]),(0,j.useEffect)((function(){"success"===_&&w()}),[_]);var P={latitude:null===A||void 0===A||null===(e=A.data)||void 0===e||null===(t=e.addressLocation)||void 0===t?void 0:t.latitude,longitude:null===A||void 0===A||null===(i=A.data)||void 0===i||null===(o=i.addressLocation)||void 0===o?void 0:o.longitude},z=1e3*(null===S||void 0===S||null===(a=S.data)||void 0===a?void 0:a.storeRadius);(0,j.useEffect)((function(){v&&(N(v),Z.current&&Z.current.setCenter([v.latitude,v.longitude]))}),[v]);var E=function(n,e){var t=n.latitude*Math.PI/180,i=e.latitude*Math.PI/180,o=(e.latitude-n.latitude)*Math.PI/180,a=(e.longitude-n.longitude)*Math.PI/180,r=Math.sin(o/2)*Math.sin(o/2)+Math.cos(t)*Math.cos(i)*Math.sin(a/2)*Math.sin(a/2);return 6371e3*(2*Math.atan2(Math.sqrt(r),Math.sqrt(1-r)))};return(0,g.jsx)(Zn.Yy,{children:(0,g.jsxs)(Zn.D5,{width:"100%",height:f||"500px",defaultState:{center:null!==v&&void 0!==v&&v.latitude?[v.latitude,v.longitude]:null!==x&&void 0!==x&&null!==(r=x.addressLocation)&&void 0!==r&&r.latitude?[null===x||void 0===x||null===(l=x.addressLocation)||void 0===l?void 0:l.latitude,null===x||void 0===x||null===(s=x.addressLocation)||void 0===s?void 0:s.longitude]:[P.latitude,P.longitude],zoom:14,behaviors:["default","scrollZoom"]},instanceRef:function(n){Z.current=n},onClick:function(n){var e,t={latitude:n.get("coords")[0],longitude:n.get("coords")[1]};E(t,P)<=z?(N(t),p(t)):Nn.Am.error("Kechirasiz, siz faqat do'kondan ".concat(null===S||void 0===S||null===(e=S.data)||void 0===e?void 0:e.storeRadius," km radius ichida joy tanlay olasiz."))},children:[(0,g.jsx)(Zn.ah,{geometry:null!=(null===y||void 0===y?void 0:y.latitude)&&null!=(null===y||void 0===y?void 0:y.longitude)?[y.latitude,y.longitude]:[null===x||void 0===x||null===(u=x.addressLocation)||void 0===u?void 0:u.latitude,null===x||void 0===x||null===(m=x.addressLocation)||void 0===m?void 0:m.longitude]}),(0,g.jsx)(Zn.ot,{}),(0,g.jsx)(Zn.Bo,{options:{float:"left"},onClick:function(){navigator.geolocation?navigator.geolocation.getCurrentPosition((function(n){var e,t={latitude:n.coords.latitude,longitude:n.coords.longitude};E(t,P)<=z?(N(t),p(t),Z.current&&Z.current.setCenter([t.latitude,t.longitude],14)):Nn.Am.error("Kechirasiz, siz faqat do'kondan ".concat(null===S||void 0===S||null===(e=S.data)||void 0===e?void 0:e.storeRadius," km radius ichida joy tanlay olasiz."))}),(function(n){console.error("Geolocation error:",n)})):console.error("Geolocation is not supported by this browser.")}}),(0,g.jsx)(Zn.Sj,{options:{float:"right"}}),(0,g.jsx)(Zn.Ly,{options:{float:"right"}})]})})},kn=t(68096),Sn=t(58406),Cn=(0,x.default)(Sn.Z)(en||(en=(0,f.Z)(["\n  height: 45px;\n  .MuiSelect-select {\n    background-color: #fff;\n    padding: 0px 12px;\n    height: 45px !important;\n    border-radius: 10px !important;\n    border: 1px solid #d9d9d9;\n    line-height: 48px;\n  }\n  & ~ .text-error {\n    position: absolute;\n    bottom: -20px;\n  }\n"]))),In=x.default.div(tn||(tn=(0,f.Z)(["\n  padding: 6px 0;\n  label {\n    color: #232323;\n    font-weight: 500;\n    font-size: 14px;\n  }\n"])));var An,_n,Pn,zn=function(n){return{style:{color:n?"initial":"white"}}},En=function(n){var e=n.control,t=n.options,i=void 0===t?[]:t,o=n.name,a=n.label,d=n.disabled,l=void 0!==d&&d,s=n.optionsUrl,u=(n.className,n.placeholder,n.setValue,n.defaultValue),m=void 0===u?"":u,p=n.filterOptions,v=n.setAdditionalItem,f=n.rules,x=void 0===f?{required:{value:!0,message:"Majburiy"}}:f,h=n.onChange,b=(0,y.$G)().t,N=(0,c.uC)(s||"","post",{onSuccess:function(){console.log("success")}}),Z=N.mutate,w=N.data;N.reset,N.status,(0,j.useEffect)((function(){Z({optionsFromUrl:w})}),[Z]),(0,j.useEffect)((function(){w?console.log("Fetched optionsFromUrl:"):console.warn("optionsFromUrl is undefined")}),[w]),w&&w.data;var k=(null!==w&&void 0!==w&&w.data.data&&Array.isArray(w.data.data)?w.data.data:i).map((function(n){return(0,r.Z)((0,r.Z)({},n),{},{name:n.firstName?"".concat(n.firstName," ").concat(n.lastName):n.carBrand?"Brand: ".concat(n.carBrand,", Model: ").concat(n.carModel):"Number: ".concat(n.carNumber)})}));return(0,g.jsxs)(g.Fragment,{children:[a&&(0,g.jsxs)(In,{className:"select-label",children:[(0,g.jsx)("label",{children:a}),(0,g.jsx)("span",{children:a&&null!==x&&void 0!==x&&x.required?(0,g.jsx)("span",{className:"text-error mt-1",children:"*"}):null})]}),(0,g.jsx)(kn.Z,{fullWidth:!0,variant:"outlined",children:(0,g.jsx)(cn.Qr,{name:o,control:e,rules:x,render:function(n){var e,t=n.field,i=t.onChange,a=t.value,r=t.ref,d=t.onBlur,s=n.fieldState,c=!!s.error;return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(Cn,{onChange:function(n){i(n),null===h||void 0===h||h(n.target.value,null===k||void 0===k?void 0:k.find((function(e){var t;return(null===e||void 0===e?void 0:e._id)===(null===n||void 0===n||null===(t=n.target)||void 0===t?void 0:t.value)})))},value:a,labelId:o,id:o,ref:r,onBlur:d,color:s.error?"error":void 0,SelectDisplayProps:zn(a),disabled:l,sx:{"& fieldset":{border:"none"}},children:(null===k||void 0===k?void 0:k.length)>0?null===(e=p?p(k):k)||void 0===e?void 0:e.map((function(n){return(0,g.jsxs)(W.Z,{value:n._id,children:[n.fullName,null===v||void 0===v?void 0:v(n.fullName)]},n._id)})):(0,g.jsx)(W.Z,{disabled:!0,value:void 0,children:"Hech narsa topilmadi\u26d4"})}),c&&(0,g.jsx)("h6",{className:"text-error mt-1",children:b("general.required")})]})},defaultValue:m})})]})},Ln=function(n){var e,t,i,o,s,u,m,v,f,x,h,b,N,Z,w,S,A,_=n.basketItems,P=n.formStore,z=n.order,E=(0,j.useState)(!1),L=(0,d.Z)(E,2),M=L[0],Y=L[1],B=(0,j.useState)(!1),V=(0,d.Z)(B,2),q=V[0],F=V[1],O=(0,j.useState)(),R=(0,d.Z)(O,2),U=R[0],G=R[1],W=(0,j.useState)(""),Q=(0,d.Z)(W,2),H=Q[0],K=Q[1],X=(0,y.$G)().t,J=(0,cn.cI)(),$=J.control,nn=J.setValue,en=J.handleSubmit,tn=J.watch,on=J.setError,an=(J.reset,J.getValues),rn=((0,D.Z)(H,1e3).debouncedValue,(0,a.s0)()),dn=(0,a.UO)().id,ln=_.reduce((function(n,e){return n+e.salePrice*e.amount}),0),sn=(0,j.useState)(""),un=(0,d.Z)(sn,2),mn=un[0],vn=un[1],fn=(0,pn.Z)().state.data,xn=(0,c.uC)("address/by-name","post",{onSuccess:function(){Y(!0)},onError:function(n){console.error("Error fetching address:",n)}}),hn=xn.mutate,Zn=xn.data;(0,j.useEffect)((function(){"string"===typeof H&&H.trim()&&hn({name:H})}),[H]);var kn=(0,c.uC)("order/create","post",{onSuccess:function(){rn("/order")}}),Sn=kn.mutate,Cn=kn.status,In=(0,c.uC)("address/by-point","post",{onSuccess:function(n){var e=n.data;P?(null===P||void 0===P||P.setValue("addressName",null===e||void 0===e?void 0:e.name),null===P||void 0===P||P.setValue("addressLocation",U),null===P||void 0===P||P.setError("addressName",{})):(nn("addressName",null===e||void 0===e?void 0:e.name),nn("addressLocation",U),on("addressName",{}))},onError:function(n){console.error("Error fetching address:",n)}}),An=In.mutate;(0,j.useEffect)((function(){null!==U&&void 0!==U&&U.latitude&&null!==U&&void 0!==U&&U.longitude?An({latitude:U.latitude,longitude:U.longitude}):console.error("Coordinates are missing")}),[An,U]),console.log(_);var _n=(0,c.h_)("order/get-by-id/".concat(dn),{},{enabled:!!dn}).data,Pn=null===_n||void 0===_n||null===(e=_n.data)||void 0===e?void 0:e.courierId,zn=(0,c.uC)("order/set-courier","post",{onSuccess:function(n){vn(n.data.courierId)},onError:function(n){console.error("API Error:",n)}}),Ln=zn.mutate,Dn=(zn.data,zn.status,zn.isLoading,(0,c.uC)("order/calculate","post",{onSuccess:function(n){},onError:function(n){console.error("API Error:",n)}})),Mn=Dn.mutate,Tn=Dn.data,Yn=(Dn.status,Dn.isLoading,function(){var n=(null===P||void 0===P?void 0:P.getValues("phoneNumber"))||an("phoneNumber");Mn({paymentType:"cash",addressLocation:{latitude:null===U||void 0===U?void 0:U.latitude,longitude:null===U||void 0===U?void 0:U.longitude},items:_.map((function(n){var e;return{productId:n._id,amount:n.amount,attributes:null===n||void 0===n||null===(e=n.variants)||void 0===e?void 0:e.map((function(n){return{attributeId:n.attributeId,attributeItem:n.attributeItem}}))}})),phoneNumber:n})});return(0,j.useEffect)((function(){_.length>0&&Yn()}),[_,P,U]),(0,g.jsxs)(gn,{children:[!dn&&(0,g.jsx)("h3",{className:"mb-3",children:X("order.formalization")}),(0,g.jsxs)("form",{onSubmit:en((function(n){var e=tn("addressLocation");if(e&&e.latitude&&e.longitude){if(!_.length)return Nn.Am.warning(X("order.chooseProduct"));if(_.find((function(n){return!(n.amount>0)})))return Nn.Am.warning(X("order.validAmount"));var t=(0,T.get)(fn,"orderMinimumPrice",0);if(ln<t)return Nn.Am.warning("".concat(X("order.minimum_order_amount")," ").concat((0,I.Y)(t)," ").concat((0,T.get)(fn,"currency","uzs")));var i=(0,r.Z)((0,r.Z)({},n),{},{deliveryDate:C()(n.deliveryDate).format(),items:_.map((function(n){var e;return{productId:n._id,amount:n.amount,attributes:null===n||void 0===n||null===(e=n.variants)||void 0===e?void 0:e.map((function(n){return{attributeId:n.attributeId,attributeItem:n.attributeItem}}))}})),addressLocation:{latitude:null===U||void 0===U?void 0:U.latitude,longitude:null===U||void 0===U?void 0:U.longitude}});Sn(i)}else Nn.Am.error("Manzil noto'g'ri kiritilgan yoki xaritada topilmadi!")})),children:[(0,g.jsxs)(l.ZP,{container:!0,spacing:2,children:[(0,g.jsx)(l.ZP,{item:!0,sm:12,children:(0,g.jsxs)("div",{onClick:function(){return F(!0)},children:[(0,g.jsx)(k.oi,{control:P?P.control:$,name:"addressName",label:X("order.deliveryAddress"),placeholder:"Yetkazib berish manzili",searchIcon:!0,onCustomChange:function(n){K(n)},disabled:"completed"===(null===z||void 0===z||null===(t=z.state)||void 0===t?void 0:t.state)}),(0,g.jsx)("div",{className:"address-options",children:M&&(null===Zn||void 0===Zn||null===(i=Zn.data)||void 0===i?void 0:i.map((function(n){return(0,g.jsx)("div",{className:"option",onClick:function(){nn("addressName",n.name),nn("addressLocation",{latitude:n.latitude,longitude:n.longitude,name:n.name}),G({latitude:n.latitude,longitude:n.longitude,name:n.name}),Y(!1)},children:n.name})})))})]})}),(0,g.jsx)(l.ZP,{item:!0,md:6,children:(0,g.jsx)(k.oi,{control:P?null===P||void 0===P?void 0:P.control:$,name:"houseNumber",rules:{required:!1},label:X("order.home_number"),disabled:"completed"===(null===z||void 0===z||null===(o=z.state)||void 0===o?void 0:o.state)})}),(0,g.jsx)(l.ZP,{item:!0,md:6,children:(0,g.jsx)(k.oi,{control:P?null===P||void 0===P?void 0:P.control:$,name:"entrance",rules:{required:!1},label:X("order.entrance"),disabled:"completed"===(null===z||void 0===z||null===(s=z.state)||void 0===s?void 0:s.state)})}),(0,g.jsx)(l.ZP,{item:!0,md:6,children:(0,g.jsx)(k.oi,{control:P?null===P||void 0===P?void 0:P.control:$,name:"floor",rules:{required:!1},label:X("order.floor"),disabled:"completed"===(null===z||void 0===z||null===(u=z.state)||void 0===u?void 0:u.state)})}),(0,g.jsx)(l.ZP,{item:!0,md:6,children:(0,g.jsx)(k.oi,{control:P?null===P||void 0===P?void 0:P.control:$,name:"apartmentNumber",rules:{required:!1},label:X("order.apartment_number"),disabled:"completed"===(null===z||void 0===z||null===(m=z.state)||void 0===m?void 0:m.state)})}),(0,g.jsx)(l.ZP,{item:!0,sm:12,children:(0,g.jsx)(k.oi,{control:P?null===P||void 0===P?void 0:P.control:$,name:"receiverFirstName",label:X("order.receiver"),disabled:"completed"===(null===z||void 0===z||null===(v=z.state)||void 0===v?void 0:v.state)})}),(0,g.jsx)(l.ZP,{item:!0,sm:12,children:(0,g.jsx)(k.sb,{control:P?null===P||void 0===P?void 0:P.control:$,name:"phoneNumber",label:X("common.phoneNumber"),disabled:"completed"===(null===z||void 0===z||null===(f=z.state)||void 0===f?void 0:f.state),onChange:Yn})}),(0,g.jsx)(l.ZP,{item:!0,sm:12,children:(0,g.jsx)(k.sp,{label:X("common.date"),control:P?null===P||void 0===P?void 0:P.control:$,name:"deliveryDate",minDate:C()(new Date),defaultValue:C()(new Date),disabled:"completed"===(null===z||void 0===z||null===(x=z.state)||void 0===x?void 0:x.state)})}),(0,g.jsx)(l.ZP,{item:!0,sm:12,className:"w-full",children:(0,g.jsx)(k.p7,{control:P?null===P||void 0===P?void 0:P.control:$,name:"paymentType",options:yn.G4,defaultValue:"cash",label:X("common.paymentType"),disabled:"completed"===(null===z||void 0===z||null===(h=z.state)||void 0===h?void 0:h.state),onChange:Yn})}),dn&&(0,g.jsx)(l.ZP,{item:!0,sm:12,children:(0,g.jsx)(En,{control:P?null===P||void 0===P?void 0:P.control:$,name:"setCourier",label:X("common.courier"),optionsUrl:"courier/paging",value:mn,defaultValue:Pn,onChange:function(n){vn(n),Ln({courierId:n,_id:dn})},rules:{required:!1},disabled:"completed"===(null===z||void 0===z||null===(b=z.state)||void 0===b?void 0:b.state)})}),(0,g.jsxs)(l.ZP,{item:!0,sm:12,children:[(0,g.jsx)("label",{className:"custom-label",children:X("common.description")}),(0,g.jsx)(jn.Z,{minRows:3,value:null===P||void 0===P?void 0:P.watch("comment"),onChange:function(n){var e=n.target.value;P?null===P||void 0===P||P.setValue("comment",e):nn("comment",e)},style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #ccc",fontSize:"1rem"}})]})]}),!dn&&(0,g.jsxs)("div",{className:"info",children:[(0,g.jsxs)("div",{className:"item",children:[(0,g.jsxs)("span",{className:"key",children:[X("order.allProducts"),":"]}),(0,g.jsxs)("span",{className:"value",children:[(0,I.Y)((null===Tn||void 0===Tn||null===(N=Tn.data)||void 0===N?void 0:N.itemPrice)||0)," ",(0,T.get)(fn,"currency","uzs")]})]}),(0,g.jsxs)("div",{className:"item",children:[(0,g.jsxs)("span",{className:"key",children:[X("settings.discounts"),":"]}),(0,g.jsxs)("span",{className:"value",children:[(0,I.Y)((null===Tn||void 0===Tn||null===(Z=Tn.data)||void 0===Z?void 0:Z.discount)||0)," ",(0,T.get)(fn,"currency","uzs")]})]}),(0,g.jsxs)("div",{className:"item",children:[(0,g.jsxs)("span",{className:"key",children:[X("order.deliveryPrice"),":"]}),(0,g.jsxs)("span",{className:"value",children:[(0,I.Y)((null===Tn||void 0===Tn||null===(w=Tn.data)||void 0===w?void 0:w.deliveryPrice)||0)," ",(0,T.get)(fn,"currency","uzs")]})]}),(0,g.jsxs)("div",{className:"item",children:[(0,g.jsxs)("span",{className:"key",children:[X("order.totalPrice"),":"]}),(0,g.jsxs)("span",{className:"value",children:[(0,I.Y)((null===Tn||void 0===Tn||null===(S=Tn.data)||void 0===S?void 0:S.totalPrice)||0)," ",(0,T.get)(fn,"currency","uzs")]})]})]}),!dn&&(0,g.jsx)(k.c7,{variant:"contained",title:X("order.formalization"),className:"submit-btn",type:"submit",disabled:"loading"===Cn})]}),(0,g.jsx)(k.u_,{setOpen:F,open:q,children:(0,g.jsx)(bn,{children:(0,g.jsxs)(l.ZP,{container:!0,height:"100%",children:[(0,g.jsx)(l.ZP,{item:!0,md:6,children:(0,g.jsxs)("div",{className:"modal-form",children:[(0,g.jsxs)("div",{className:"title",children:[(0,g.jsx)("span",{onClick:function(){return F(!1)},children:(0,g.jsx)(p.qg,{})}),(0,g.jsx)("h2",{children:X("order.add_new_address")})]}),(0,g.jsxs)(l.ZP,{container:!0,spacing:2,children:[(0,g.jsxs)(l.ZP,{item:!0,md:12,position:"relative",children:[(0,g.jsx)(k.oi,{control:P?P.control:$,name:"addressName",placeholder:X("order.shipping_address"),searchIcon:!0,onCustomChange:function(n){K(n)}}),(0,g.jsx)("div",{className:"address-options",children:M&&(null===Zn||void 0===Zn||null===(A=Zn.data)||void 0===A?void 0:A.map((function(n){return(0,g.jsx)("div",{className:"option",onClick:function(){nn("addressName",n.name),nn("addressLocation",{latitude:n.latitude,longitude:n.longitude,name:n.name}),G({latitude:n.latitude,longitude:n.longitude,name:n.name}),Y(!1)},children:n.name})})))})]}),(0,g.jsx)(l.ZP,{item:!0,md:6,children:(0,g.jsx)(k.oi,{control:P?null===P||void 0===P?void 0:P.control:$,name:"houseNumber",rules:{required:!1},label:X("order.home_number")})}),(0,g.jsx)(l.ZP,{item:!0,md:6,children:(0,g.jsx)(k.oi,{control:P?null===P||void 0===P?void 0:P.control:$,name:"entrance",rules:{required:!1},label:X("order.entrance")})}),(0,g.jsx)(l.ZP,{item:!0,md:6,children:(0,g.jsx)(k.oi,{control:P?null===P||void 0===P?void 0:P.control:$,name:"floor",rules:{required:!1},label:X("order.floor")})}),(0,g.jsx)(l.ZP,{item:!0,md:6,children:(0,g.jsx)(k.oi,{control:P?null===P||void 0===P?void 0:P.control:$,name:"apartmentNumber",label:X("order.apartment_number"),rules:{required:!1}})})]}),(0,g.jsx)(k.c7,{title:X("FORMDRAWER.SAVE"),variant:"contained",color:"success",className:"save-btn",onClick:function(){var n=tn("addressLocation");n&&n.latitude&&n.longitude?F(!1):Nn.Am.error("Manzil noto'g'ri kiritilgan yoki xaritada topilmadi!")}})]})}),(0,g.jsx)(l.ZP,{item:!0,md:6,children:(0,g.jsx)("div",{className:"map",children:(0,g.jsx)(wn,{getCoordinate:G,center:tn("addressLocation"),order:z})})})]})})})]})},Dn=function(){var n=(0,j.useState)([]),e=(0,d.Z)(n,2),t=e[0],i=e[1];return(0,g.jsx)(ln,{children:(0,g.jsxs)(l.ZP,{container:!0,spacing:3,children:[(0,g.jsx)(l.ZP,{item:!0,md:8,children:(0,g.jsx)(hn,{basketItems:t,setBasketItems:i})}),(0,g.jsx)(l.ZP,{item:!0,md:4,children:(0,g.jsx)(Ln,{basketItems:t})})]})})},Mn=x.default.div(An||(An=(0,f.Z)(["\n  padding: 10px 0;\n  .top {\n    display: flex;\n    align-items: center;\n    width: 100%;\n    .state-select {\n      min-width: 180px;\n      margin-top: -3px;\n      div {\n        width: 100% !important;\n      }\n      margin-right: 15px;\n    }\n    .payment-type {\n      display: flex;\n      align-items: center;\n      padding: 4px 12px;\n      border-radius: 12px;\n      background: #fff;\n      width: 100%;\n      .type {\n        margin-left: 11px;\n        span {\n          color: #999;\n          font-size: 12px;\n          font-weight: 500;\n        }\n        h4 {\n          font-weight: 500;\n          font-size: 15px;\n        }\n      }\n      .state {\n        margin-left: auto;\n        color: #eb5757;\n        font-size: 15px;\n      }\n    }\n  }\n"]))),Tn=x.default.div(_n||(_n=(0,f.Z)(["\n  border-radius: 12px;\n  background: #fff;\n  padding: 20px;\n  margin-top: 24px;\n  .steps {\n    position: relative;\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    padding-bottom: 20px;\n    border-bottom: 1px dashed #e9e9e9;\n    .icon {\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      width: 56px;\n      height: 56px;\n      border-radius: 50%;\n      background-color: #e9e9e9;\n      &.active {\n        background-color: #f7e14b;\n        .line {\n          background: #f7e14b;\n        }\n        svg path {\n          fill: #000;\n        }\n      }\n      .line {\n        position: absolute;\n        width: 21.5%;\n        height: 4px;\n        background: #f5f5f5;\n        transform: translateX(-71%);\n      }\n    }\n  }\n  .products {\n    min-height: 450px;\n    display: flex;\n    flex-direction: column;\n    justify-content: space-between;\n\n    .product_info {\n      width: 100%;\n      display: flex;\n      flex-direction: column;\n      gap: 12px;\n\n      li {\n        list-style: none;\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n        font-size: 18px;\n\n        span {\n          color: #999;\n        }\n\n        .main {\n          color: #000;\n          font-weight: 600;\n        }\n      }\n    }\n  }\n  .product {\n    display: flex;\n    align-items: center;\n    padding: 16px 0;\n    border-bottom: 1px dashed #e9e9e9;\n    &:last-of-type {\n      border-bottom: none;\n    }\n    .default-image {\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      width: 48px;\n      height: 48px;\n      border-radius: 12px;\n      background: #f3f3f8;\n      margin-right: 12px;\n      overflow: hidden;\n      img {\n        width: 100%;\n        height: 100%;\n        object-fit: cover;\n      }\n      svg {\n        width: 20px;\n        height: 20px;\n      }\n    }\n    .info {\n      .name {\n        display: block;\n        color: #454545;\n        font-size: 14px;\n        font-weight: 500;\n        margin-bottom: 5px;\n      }\n      .amount-price {\n        font-size: 14px;\n        font-weight: 700;\n      }\n    }\n    .action {\n      display: flex;\n      margin-left: auto;\n      span {\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        width: 36px;\n        height: 36px;\n        border-radius: 50%;\n        background: #f3f3f8;\n        cursor: pointer;\n        &:first-of-type {\n          margin-right: 16px;\n          svg {\n            width: 22px;\n            height: 22px;\n          }\n        }\n      }\n    }\n  }\n"]))),Yn=t(86657),Bn=t(84544),Vn=function(n){var e,t=n.formStore,i=n.state,o=n.order,a=(0,j.useState)(0),l=(0,d.Z)(a,2),s=l[0],c=l[1],u=(0,j.useState)(),m=(0,d.Z)(u,2),v=m[0],f=m[1],x=(0,y.$G)().t,h=(0,pn.Z)().state.data,b=(0,cn.Dq)({control:null===t||void 0===t?void 0:t.control,name:"items"}),N=b.fields,Z=b.remove,w=b.update,S="created"===i?1:"inProcess"===i?2:"inDelivery"===i?3:"completed"===i?4:0;return(0,g.jsxs)(Tn,{children:[(0,g.jsxs)("div",{className:"steps",style:{border:"none"},children:[(0,g.jsx)("span",{className:"icon ".concat(S&&"active"),children:(0,g.jsx)(p.Ye,{})}),(0,g.jsxs)("span",{className:"icon ".concat(S>1&&"active"),children:[(0,g.jsx)(p.T3,{}),(0,g.jsx)("div",{className:"line"})]}),(0,g.jsxs)("span",{className:"icon ".concat(S>2&&"active"),children:[(0,g.jsx)(p.Yw,{}),(0,g.jsx)("div",{className:"line"})]}),(0,g.jsxs)("span",{className:"icon ".concat(S>3&&"active"),children:[(0,g.jsx)(p.U6,{}),(0,g.jsx)("div",{className:"line"})]})]}),(0,g.jsxs)("div",{className:"steps",children:[(0,g.jsx)("span",{className:"".concat(S&&"active"),children:(0,T.get)(o,"createdAt",0)?new Date(new Date(o.createdAt).getTime()+18e6).toISOString().slice(11,19):""}),(0,g.jsx)("span",{className:"".concat(S>1&&"active"),children:(0,T.get)(o,"acceptedAt",0)?new Date(new Date(o.acceptedAt).getTime()+18e6).toISOString().slice(11,19):""}),(0,g.jsx)("span",{className:"".concat(S>2&&"active"),children:(0,T.get)(o,"inDeliveryAt",0)?new Date(new Date(o.inDeliveryAt).getTime()+18e6).toISOString().slice(11,19):""}),(0,g.jsx)("span",{className:"".concat(S>3&&"active"),children:(0,T.get)(o,"completedAt",0)?new Date(new Date(o.completedAt).getTime()+18e6).toISOString().slice(11,19):""})]}),(0,g.jsxs)("div",{className:"products",children:[(0,g.jsx)("div",{children:null===N||void 0===N?void 0:N.map((function(n,e){var t,o,a;return(0,g.jsxs)("div",{className:"product",children:[(0,g.jsx)("span",{className:"default-image",children:n.product.mainImage?(0,g.jsx)("img",{src:"http://localhost:3003/v1/"+n.product.mainImage.url,alt:"product"}):(0,g.jsx)(p.Q_,{})}),(0,g.jsxs)("div",{className:"info",children:[(0,g.jsxs)("div",{className:"flex",children:[(0,g.jsx)("span",{className:"name",children:null===n||void 0===n||null===(t=n.product)||void 0===t?void 0:t.name}),(null===n||void 0===n||null===(o=n.attributes)||void 0===o?void 0:o.length)>0&&(0,g.jsx)("div",{className:"variant-info flex",children:null===n||void 0===n||null===(a=n.attributes)||void 0===a?void 0:a.map((function(n,e){return(0,g.jsx)("div",{className:"variant-item flex",children:(0,g.jsx)("span",{className:"name ml-1",children:n.attributeItem})},e)}))})]}),(0,g.jsxs)("div",{className:"amount-price",children:[n.amount," x ",(0,I.Y)(n.price)," ",(0,T.get)(h,"currency","uzs")]})]}),"completed"!==i&&"cancelled"!==i&&(0,g.jsx)("div",{className:"action",children:"inDelivery"!==i&&(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("span",{onClick:function(){return c(e+1)},children:(0,g.jsx)(p.pJ,{})}),(0,g.jsx)("span",{onClick:function(){return f((0,r.Z)((0,r.Z)({},n),{},{index:e}))},children:(0,g.jsx)(Yn.Z,{})})]})})]})}))}),(0,g.jsxs)("ul",{className:"product_info",children:[(0,g.jsxs)("li",{children:[(0,g.jsx)("span",{children:"Barcha mahsulotlar:"})," ",(0,g.jsxs)("b",{children:[(0,I.Y)((0,T.get)(o,"itemPrice",0))," ",(0,T.get)(h,"currency","uzs")]})]}),(0,g.jsxs)("li",{children:[(0,g.jsx)("span",{children:"Yetkazib berish:"}),(0,g.jsxs)("b",{children:[(0,I.Y)((0,T.get)(o,"deliveryPrice",0))," ",(0,T.get)(h,"currency","uzs")]})]}),(0,g.jsxs)("li",{children:[(0,g.jsx)("span",{children:"Foydalanilgan balans:"}),(0,g.jsxs)("b",{children:["-",(0,I.Y)((0,T.get)(o,"usedBalance",0))," ",(0,T.get)(h,"currency","uzs")]})]}),0!==(0,T.get)(o,"discount")?(0,g.jsxs)("li",{children:[(0,g.jsxs)("span",{children:[x("common.discount"),":"]}),(0,g.jsxs)("b",{children:["-",(0,I.Y)((0,T.get)(o,"discount",""))," ",(0,T.get)(h,"currency","uzs")]})]}):"",(0,T.get)(o,"promocode.amount","")&&(0,g.jsxs)("li",{children:[(0,g.jsx)("span",{children:"Promokod:"}),(0,g.jsxs)("b",{children:["-",(0,I.Y)((0,T.get)(o,"promocode.amount",0))," ",(0,T.get)(h,"currency","uzs")]})]}),(0,g.jsxs)("li",{children:[(0,g.jsx)("span",{className:"main",children:"Umumiy:"})," ",(0,g.jsxs)("b",{children:[(0,I.Y)((0,T.get)(o,"totalPrice",0))," ",(0,T.get)(h,"currency","uzs")]})]})]})]}),(0,g.jsx)(Bn.Z,{open:s,setOpen:c,confirmFn:function(){Z(s-1),c(0)}}),(0,g.jsx)(k.u_,{setOpen:f,open:!!v,children:(0,g.jsxs)("div",{className:"custom-modal",children:[(0,g.jsxs)("span",{className:"d-block mb-2",children:[null===v||void 0===v?void 0:v.product.name," (",x("common.residue"),":"," ",(null===v||void 0===v||null===(e=v.product)||void 0===e?void 0:e.inStock)||0,")"]}),(0,g.jsx)(k.oi,{control:null===t||void 0===t?void 0:t.control,name:"items.".concat(null===v||void 0===v?void 0:v.index,".amount"),type:"number",onCustomChange:function(n){n.floatValue<=v.product.inStock&&w(null===v||void 0===v?void 0:v.index,(0,r.Z)((0,r.Z)({},v),{},{amount:(null===n||void 0===n?void 0:n.floatValue)||0}))}}),(0,g.jsx)(k.c7,{title:x("general.save"),fullWidth:!0,variant:"contained",className:"mt-3",onClick:function(){t.watch("items.".concat(null===v||void 0===v?void 0:v.index,".amount"))<=v.product.inStock?f(null):Nn.Am.warn("Max: ".concat(v.product.inStock))}})]})})]})},qn=x.default.div(Pn||(Pn=(0,f.Z)(["\n  max-height: calc(100vh - 110px);\n  overflow: auto;\n  .card {\n    padding: 16px 20px;\n    border-radius: 12px;\n    background: #fff;\n    box-shadow: 0px 0px 4px 0px rgba(0, 0, 0, 0.07);\n    margin-bottom: 16px;\n    &:last-of-type {\n      margin-bottom: 0;\n    }\n    .title {\n      font-size: 18px;\n      border-bottom: 1px dashed #e9e9e9;\n      padding-bottom: 10px;\n      margin-bottom: 16px;\n    }\n    .info {\n      display: flex;\n      align-items: center;\n      .image {\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        background-color: #f3f3f8;\n        width: 56px;\n        height: 56px;\n        border-radius: 50%;\n        margin-right: 12px;\n        overflow: hidden;\n        img {\n          width: 100%;\n          height: 100%;\n          object-fit: cover;\n        }\n        svg {\n          width: 25px;\n          height: 25px;\n        }\n      }\n      .phone {\n        color: #999;\n        font-size: 14px;\n      }\n    }\n    .car {\n      display: flex;\n      align-items: center;\n      justify-content: space-between;\n      border-top: 1px dashed #e9e9e9;\n      margin-top: 16px;\n      padding-top: 16px;\n      .number {\n        padding: 3px 7px;\n        font-weight: 600;\n        font-size: 15px;\n        border-radius: 4px;\n        background: #f5f5f5;\n      }\n    }\n  }\n\n  .comment_boxes {\n    display: flex;\n    align-items: flex-start;\n    flex-wrap: wrap;\n    gap: 10px;\n\n    .comment_box {\n      width: 76px;\n      background-color: inherit;\n\n      .comment_img {\n        display: flex;\n        justify-content: center;\n        align-items: center;\n        box-shadow: 0px 0px 12px -2px rgba(0, 0, 0, 0.12);\n        border-radius: 6px;\n        width: 100%;\n        height: 62px;\n\n        img {\n          width: 80%;\n          object-fit: cover;\n        }\n      }\n\n      p {\n        display: inline-block;\n        font-size: 10px !important;\n        font-weight: 600;\n        color: #000;\n        width: 100%;\n        white-space: nowrap;\n        overflow: hidden !important;\n        text-overflow: ellipsis;\n      }\n    }\n  }\n"]))),Fn=t(4729),On=function(n){var e,t,i,o,a,r,d,l,s=n.formStore,c=n.order;return(0,g.jsxs)(qn,{children:[(0,g.jsx)(Ln,{order:c,basketItems:[],formStore:s}),(0,g.jsxs)("div",{className:"card mt-3",children:[(0,g.jsx)("h4",{className:"title",children:"Mijoz"}),(0,g.jsxs)("div",{className:"info border-bottom mb-3 pb-3",children:[(0,g.jsx)("div",{className:"image",children:null!==c&&void 0!==c&&null!==(e=c.customer)&&void 0!==e&&e.image?(0,g.jsx)("img",{src:"https://picsum.photos/100",alt:""}):(0,g.jsx)(p.Q_,{})}),(0,g.jsxs)("div",{children:[(0,g.jsx)("h4",{className:"name",children:(0,T.get)(c,"customer.firstName","")+" "+(0,T.get)(c,"customer.lastName","")}),(0,g.jsx)("span",{className:"phone",children:null===c||void 0===c||null===(t=c.customer)||void 0===t?void 0:t.phoneNumber})]})]}),"completed"===(0,T.get)(c,"state.state","")&&(0,g.jsxs)("div",{children:[(0,g.jsx)("h3",{className:"mb-2",children:"Reyting va izoh"}),(0,T.get)(c,"rateComment","")&&(0,g.jsx)("p",{className:"border-bottom pb-3",children:(0,T.get)(c,"rateComment","")}),(0,g.jsx)("div",{className:"py-3 border-bottom",children:(0,g.jsx)(Fn.Z,{name:"read-only",value:(0,T.get)(c,"rate",5),readOnly:!0})}),(0,g.jsx)("div",{className:"comment_boxes pt-3",children:(0,T.get)(c,"rateComments",[]).map((function(n){return(0,g.jsxs)("div",{className:"comment_box",children:[(0,g.jsx)("div",{className:"comment_img",children:(0,g.jsx)("img",{src:"http://localhost:3003/v1"+(0,T.get)(n,"image.url",""),alt:"rate"})}),(0,g.jsx)("p",{children:(0,T.get)(n,"title","")})]})}))})]})]}),c.courier&&(0,g.jsxs)("div",{className:"card",children:[(0,g.jsx)("h4",{className:"title",children:"Kuryer"}),(0,g.jsxs)("div",{className:"info",children:[(0,g.jsx)("div",{className:"image",children:null!==c&&void 0!==c&&null!==(i=c.courier)&&void 0!==i&&i.image?(0,g.jsx)("img",{src:"http://localhost:3003/v1/"+(null===c||void 0===c||null===(o=c.courier)||void 0===o||null===(a=o.image)||void 0===a?void 0:a.url),alt:""}):(0,g.jsx)("span",{children:(0,g.jsx)(p.Q_,{})})}),(0,g.jsxs)("div",{children:[(0,g.jsxs)("h4",{className:"name",children:[(0,T.get)(c,"courier.firstName","")," ",(0,T.get)(c,"courier.lastName","")]}),(0,g.jsx)("span",{className:"phone",children:(0,T.get)(c,"courier.phoneNumber","")})]})]}),(0,g.jsxs)("div",{className:"car",children:[(0,g.jsx)("span",{className:"name",children:(0,T.get)(c,"courier.carBrand","")}),(0,g.jsx)("span",{className:"number",children:(0,T.get)(c,"courier.carNumber","")})]})]}),(null===c||void 0===c?void 0:c.employee)&&(0,g.jsxs)("div",{className:"card",children:[(0,g.jsx)("h4",{className:"title",children:"Xodim"}),(0,g.jsxs)("div",{className:"info",children:[(0,g.jsx)("div",{className:"image",children:null!==c&&void 0!==c&&null!==(r=c.employee)&&void 0!==r&&r.image?(0,g.jsx)("img",{src:"http://localhost:3003/v1/"+(null===c||void 0===c||null===(d=c.employee)||void 0===d||null===(l=d.image)||void 0===l?void 0:l.url),alt:""}):(0,g.jsx)("span",{children:(0,g.jsx)(p.Q_,{})})}),(0,g.jsxs)("div",{children:[(0,g.jsxs)("h4",{className:"name",children:[(0,T.get)(c,"employee.firstName","")," ",(0,T.get)(c,"employee.lastName","")]}),(0,g.jsx)("span",{className:"phone",children:(0,T.get)(c,"employee.phoneNumber","")})]})]})]}),(null===c||void 0===c?void 0:c.store)&&(0,g.jsxs)("div",{className:"card",children:[(0,g.jsx)("h4",{className:"title",children:"Do'kon"}),(0,g.jsx)("div",{className:"info",children:(0,g.jsxs)("div",{children:[(0,g.jsx)("h4",{className:"name",children:(0,T.get)(c,"store.name","")}),(0,T.get)(c,"store.phoneNumber","")&&(0,g.jsx)("span",{className:"phone",children:(0,T.get)(c,"store.phoneNumber","")}),(0,T.get)(c,"store.addressName","")&&(0,g.jsx)("span",{className:"phone",children:(0,T.get)(c,"store.addressName","")})]})})]})]})},Rn=t(59434),Un=function(){var n,e,t,i,o,s,u=(0,a.UO)().id,m=(0,y.$G)().t,p=(0,cn.cI)(),v=p.setValue,f=p.reset,x=p.handleSubmit,h=(p.control,(0,Z.C)((function(n){return n.SocketState.render}))),b=(0,Rn.I0)(),N=localStorage.getItem("i18nextLng")||"uz",w=(0,j.useState)(""),S=(0,d.Z)(w,2),C=(S[0],S[1],(0,c.h_)("order/get-by-id/".concat(u),{},{enabled:!!u})),I=C.data,A=C.status,_=C.refetch,P=null===I||void 0===I?void 0:I.data,z="completed"===(null===P||void 0===P||null===(n=P.state)||void 0===n?void 0:n.state),E="cancelled"===(null===P||void 0===P||null===(e=P.state)||void 0===e?void 0:e.state),L=(0,c.h_)("order-state/get-all",{},{suspense:!1}),D=L.data,M=(L.refetch,(0,c.uC)("order/state/".concat(null===P||void 0===P?void 0:P._id),"put",{onSuccess:function(){_(),Nn.Am.success(m("general.success"))}}).mutate),Y=(0,c.uC)("order/update","put").mutate;(0,j.useEffect)((function(){var n;"success"===A&&(v("items",null===P||void 0===P?void 0:P.items),f({items:null===P||void 0===P?void 0:P.items,addressName:null===P||void 0===P?void 0:P.addressName,addressLocation:null===P||void 0===P?void 0:P.addressLocation,customer:(0,T.get)(P,"customer.firstName","")+" "+(0,T.get)(P,"customer.lastName",""),receiverFirstName:(0,T.get)(P,"receiverCustomer.firstName",""),phoneNumber:null===P||void 0===P||null===(n=P.customer)||void 0===n?void 0:n.phoneNumber,paymentType:null===P||void 0===P?void 0:P.paymentType,houseNumber:null===P||void 0===P?void 0:P.houseNumber,entrance:null===P||void 0===P?void 0:P.entrance,floor:null===P||void 0===P?void 0:P.floor,deliveryDate:(0,T.get)(P,"deliveryDate",""),apartmentNumber:null===P||void 0===P?void 0:P.apartmentNumber}),setTimeout((function(){return v("comment",null===P||void 0===P?void 0:P.comment)}),0))}),[A]);var B=x((function(n){var e,t=(0,r.Z)((0,r.Z)({},n),{},{items:null===n||void 0===n||null===(e=n.items)||void 0===e?void 0:e.map((function(n){var e;return{productId:n.productId,amount:n.amount,attributes:null===n||void 0===n||null===(e=n.attributes)||void 0===e?void 0:e.map((function(n){return{attributeId:null===n||void 0===n?void 0:n.attributeId,attributeItem:null===n||void 0===n?void 0:n.attributeItem}}))}})),_id:null===P||void 0===P?void 0:P._id,cardId:null===P||void 0===P?void 0:P._id});Y(t)})),V=null===D||void 0===D||null===(t=D.data)||void 0===t?void 0:t.findIndex((function(n){return n._id===(null===P||void 0===P?void 0:P.state._id)}));return(0,j.useEffect)((function(){h&&(_(),b((0,F.zm)(!1)))}),[h]),(0,g.jsx)(Mn,{children:(0,g.jsxs)(l.ZP,{container:!0,columnSpacing:3,children:[(0,g.jsxs)(l.ZP,{item:!0,md:8,children:[(0,g.jsxs)("div",{className:"top",children:[!E&&!z&&(0,g.jsxs)("div",{className:"d-flex",children:[(0,g.jsx)(k.c7,{title:null===D||void 0===D||null===(i=D.data[V+1])||void 0===i||null===(o=i.name)||void 0===o?void 0:o[N],variant:"contained",className:"me-3",onClick:function(){var n;return M({stateId:null===D||void 0===D||null===(n=D.data[V+1])||void 0===n?void 0:n._id,_id:null===P||void 0===P?void 0:P._id,position:1})}}),(0,g.jsx)(k.c7,{title:"Bekor qilish",variant:"outlined",color:"error",className:"me-3",onClick:function(){return M({stateId:null===D||void 0===D?void 0:D.data[(null===D||void 0===D?void 0:D.data.length)-1]._id,_id:null===P||void 0===P?void 0:P._id,position:1})}})]}),(0,g.jsxs)("div",{className:"payment-type",children:[(0,g.jsx)("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAG6SURBVHgB7ZPLTsJAFIb/Di0gpVgRr5h4i9G4VOPCxJ2P4cYn8Cl8DXc+h4kP4MoYDQnRECOIhUJLbaEXT4dQSCyyYMvfTDqXM9+cM+cMMNO0Ei7vrm9ZwCRMqQA+s+pmXWQQriAEYw2L6jyKCyps18RHswXNdGPtBPrAAoijk3nFhCT1N6RFGUfFE2wQzHH7c8KOi5JWwmu1AtfvkVsefrou2p2ViBEBF+fbWC/o0cLx2jmUpEobfdy/luB5Pi4O97Gb3wZLtFEzy9zOdgz+H0DZAFBQzQimplcJluf9t28NaUnEztIiGQvkeZavpyiCUMlkBopci/YyxEhNLUf95WyWoA20bRuSmOhfR0Lm4DjFAkeVy8zhdHsTpu3g+bM6yTweqDvDEAzyLLxHOZ0K88jV9SxKVOd/YKM1DEG3a7yFCqiiKloTXcr0weoKHILpTp2XEYf3LBhxWa7rOfiBADHh8fGD8YSzzQwKioLzvV2kKDGOb+GlVkZZ0+B6OTrNRceZg2kt/QWG0lrK6BDvX4+8DtepuG0K8UPXoRlhTcoYJ5EeyY0vYGucQaWp8zZJxGH0/izMNLV+ASXZrtTxzAUrAAAAAElFTkSuQmCC",alt:"money"}),(0,g.jsxs)("div",{className:"type",children:[(0,g.jsx)("span",{children:"To'lov turi"}),(0,g.jsx)("h4",{children:m("enum.".concat(null===P||void 0===P?void 0:P.paymentType))})]}),(0,g.jsx)("span",{className:"state",children:"cash"===(null===P||void 0===P?void 0:P.paymentType)&&"completed"===P.state.state||null!==P&&void 0!==P&&P.isPaid?"To'langan":"To'lanmagan"})]}),!z&&!E&&(0,g.jsx)(k.c7,{title:"Saqlash",variant:"contained",className:"ms-3",onClick:B})]}),(0,g.jsx)(Vn,{formStore:p,state:null===P||void 0===P||null===(s=P.state)||void 0===s?void 0:s.state,order:P})]}),(0,g.jsx)(l.ZP,{item:!0,md:4,children:(0,g.jsx)(On,{formStore:p,order:P})})]})})},Gn=function(){return(0,g.jsxs)(a.Z5,{children:[(0,g.jsx)(a.AW,{path:"table",element:(0,g.jsx)(O,{})}),(0,g.jsx)(a.AW,{path:"board",element:(0,g.jsx)(dn,{})}),(0,g.jsx)(a.AW,{path:"add",element:(0,g.jsx)(Dn,{})}),(0,g.jsx)(a.AW,{path:":id",element:(0,g.jsx)(Un,{})}),(0,g.jsx)(a.AW,{path:"*",element:(0,g.jsx)(a.Fg,{to:"/order/table",replace:!0})})]})}},30709:function(n,e,t){t.d(e,{Fv:function(){return r},G4:function(){return i},od:function(){return a},v5:function(){return o}});var i=[{_id:"cash",name:"Naqd",trans_key:"cash"}],o=[{_id:"percent",name:"Foiz",trans_key:"percent"},{_id:"amount",name:"Miqdor",trans_key:"amount"}],a=[{name:"functionality",key:"functionality",role:"role"},{name:"discounts",key:"discountOrder",role:"role"},{name:"bonus",key:"bonusOrder",role:"role"},{name:"premium_discounts",key:"premiumDiscountOrder",role:"role"},{name:"main_address",key:"mainAddress",role:"role"},{name:"website_conditions",key:"websiteConditions",role:"role"}],r=[{rate:5},{rate:4},{rate:3},{rate:2},{rate:1}]},90816:function(n,e,t){t.d(e,{Y:function(){return i}});var i=function(n){return n||0===n?(Math.round(100*(n+Number.EPSILON))/100).toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0}).replaceAll(","," "):""}}}]);
//# sourceMappingURL=706.3177f476.chunk.js.map