"use strict";(self.webpackChunkbestune_admin=self.webpackChunkbestune_admin||[]).push([[789],{45789:function(e,n,o){o.r(n),o.d(n,{default:function(){return Z}});var r,t=o(29439),i=o(35980),a=o(72791),l=o(763),c=o(39230),d=o(79405),u=o(36978),s=o(61134),m=o(29001),f=o(93433),p=o(1413),v=o(36459),x=o(61889),g=o(62750),h=o(59460),j=o(80184),b=function(e){var n,o=e.formStore,r=e.editingCourierId,l=e.resetForm,s=e.productProps,m=(0,c.$G)().t,b=o.control,N=o.handleSubmit,_=o.reset,C=o.watch,Z=o.setValue,I=(0,a.useState)(),w=(0,t.Z)(I,2),y=w[0],k=w[1],P=s.courierImages,S=s.setCourierImages,E=s.mainImageId,F=s.setMainImageId,M=(0,d.T)();(0,v.Z)((0,g.h_)("employee/check?phoneNumber=".concat(C("phoneNumber")),{},{enabled:(null===(n=C("phoneNumber"))||void 0===n?void 0:n.length)>12&&!r,suspense:!1,onSuccess:function(e){var n=e.data;k(n)}}));var G=(0,g.uC)(r?"courier/update":"courier/create","post"),T=G.mutate,B=G.status,D=(0,g.uC)("courier/get-by-id/".concat(r),"post",{onSuccess:function(){M((0,u.dl)(!0))},onError:function(){M((0,u.dl)(!1))}}),O=D.mutate,$=D.data,q=D.status;(0,a.useEffect)((function(){r?O({_id:r}):M((0,u.dl)(!1))}),[r,O]),(0,a.useEffect)((function(){"success"===B&&l()}),[B]);return(0,a.useEffect)((function(){var e,n,o,r,t,i,a,l,c;"success"===q&&(_((0,p.Z)({},$.data)),S((null===(e=$.data)||void 0===e?void 0:e.images)||[]),(null===(n=$.data)||void 0===n||null===(o=n.images)||void 0===o?void 0:o.find((function(e){var n;return(null===e||void 0===e?void 0:e._id)===(null===(n=$.data.mainImage)||void 0===n?void 0:n._id)})))&&null!==(r=$.data)&&void 0!==r&&null!==(t=r.images)&&void 0!==t&&t.length?F(null===(c=$.data.mainImage)||void 0===c?void 0:c._id):F(null===(i=$.data)||void 0===i||null===(a=i.images)||void 0===a||null===(l=a[0])||void 0===l?void 0:l._id))}),[$,q]),(0,a.useEffect)((function(){var e=P.find((function(e){return e._id===E}));e?F(e._id):P.length&&F(P[0]._id)}),[P]),(0,j.jsx)("div",{className:"custom-drawer",children:(0,j.jsx)("form",{id:"courier",onSubmit:N((function(e){var n;T((0,p.Z)((0,p.Z)({},e),{},{imageId:P.map((function(e){return e._id})),mainImageId:P.length?E||(null===P||void 0===P||null===(n=P[0])||void 0===n?void 0:n._id):null,_id:r}))})),children:(0,j.jsxs)(x.ZP,{container:!0,spacing:2,children:[(0,j.jsxs)(x.ZP,{item:!0,md:12,children:[(0,j.jsx)(i.sb,{control:b,name:"phoneNumber",label:m("common.phoneNumber")}),(null===y||void 0===y?void 0:y._id)&&!r&&(0,j.jsxs)("div",{className:"d-flex justify-content-between",children:[(0,j.jsx)("span",{className:"text-error mt-2",children:m("common.alreadyExistEmployee")}),(0,j.jsx)(i.c7,{title:m("general.add"),onClick:function(){_((0,p.Z)((0,p.Z)({},y),{},{_id:void 0})),k(null)}})]})]}),(0,j.jsx)(x.ZP,{item:!0,md:12,children:(0,j.jsx)(i.oi,{control:b,name:"firstName",label:m("common.firstName")})}),(0,j.jsx)(x.ZP,{item:!0,md:12,children:(0,j.jsx)(i.oi,{control:b,name:"lastName",label:m("common.lastName")})}),(0,j.jsx)(x.ZP,{item:!0,md:12,children:(0,j.jsx)(i.oi,{control:b,name:"password",label:m("common.password"),type:"password",rules:{required:!1}})}),(0,j.jsx)(x.ZP,{item:!0,md:12,children:(0,j.jsx)(i.oi,{control:b,name:"carBrand",label:m("common.carBrand")})}),(0,j.jsx)(x.ZP,{item:!0,md:12,children:(0,j.jsx)(i.oi,{control:b,name:"carModel",label:m("common.carModel")})}),(0,j.jsx)(x.ZP,{item:!0,md:12,children:(0,j.jsx)(i.oi,{control:b,name:"carNumber",label:m("common.carNumber")})}),(0,j.jsx)(x.ZP,{item:!0,md:12,children:(0,j.jsx)(i.oi,{control:b,name:"carColor",label:m("common.carColor")})}),(0,j.jsx)(x.ZP,{item:!0,md:12,children:(0,j.jsxs)("div",{className:"product-images",children:[(0,j.jsx)(i.aG,{control:b,setValue:Z,name:"image",rules:{required:!1},multiple:!0,getImage:function(e){return S((function(n){return[].concat((0,f.Z)(n),[e])}))},accept:".png, .jpg, .jpeg"}),null===P||void 0===P?void 0:P.map((function(e){return(0,j.jsxs)("div",{className:"product-image",children:[(0,j.jsx)("img",{src:"https://backend.uygaayt.kahero.uz/employee-api/v1/"+e.url,alt:"product"}),(0,j.jsxs)("div",{className:"on-hover",children:[(0,j.jsx)("span",{className:"delete",onClick:function(){return S((function(n){return n.filter((function(n){return n._id!==e._id}))}))},children:(0,j.jsx)(h.pJ,{})}),(0,j.jsx)("span",{className:"main-image ".concat(e._id===E&&"active"),onClick:function(){return S(e._id)}})]})]},e._id)}))]})})]})})})},N=o(30168),_=o(17939).default.div(r||(r=(0,N.Z)(["\n  background-color: #fff;\n  border-radius: 20px;\n  padding: 32px 42px 24px 42px;\n  h2 {\n    font-weight: 500;\n    font-size: 26px;\n  }\n  button {\n    width: 100px;\n  }\n"]))),C=function(e){var n=e.open,o=e.setOpen,r=e.title,t=e.url,l=e.confirmFn,d=(0,c.$G)().t,u=(0,g.uC)("".concat(t,"/").concat(n),"post"),s=u.mutate,m=u.status;return(0,a.useEffect)((function(){"success"===m&&o(null)}),[m,s,n]),(0,j.jsx)(i.u_,{setOpen:o,open:!!n,children:(0,j.jsxs)(_,{children:[(0,j.jsx)("h2",{children:r||d("general.reallyDelete")}),(0,j.jsx)(i.xq,{isCancelFromRoute:!1,SubmitTitle:d("general.yes"),cancelTitle:d("general.no"),onClick:function(){return t?s({_id:n}):l()},onCancel:function(){return o(!1)}})]})})},Z=function(){var e=(0,a.useState)(),n=(0,t.Z)(e,2),o=n[0],r=n[1],f=(0,a.useState)(),p=(0,t.Z)(f,2),v=p[0],x=p[1],g=function(){var e=(0,c.$G)().t;return[{field:e("common.fullName"),renderCell:function(e){return(0,l.get)(e,"row.firstName","")+" "+(0,l.get)(e,"row.lastName","")},flex:1.5},{field:e("common.phoneNumber"),renderCell:function(e){return e.row.phoneNumber}},{field:e("common.rating"),renderCell:function(e){var n;return null===(n=e.row.role)||void 0===n?void 0:n.name}}]}(),h=(0,m.w)(),N=(0,c.$G)().t,_=(0,d.T)(),Z=(0,s.cI)(),I=(0,a.useState)([]),w=(0,t.Z)(I,2),y=w[0],k=w[1],P=(0,a.useState)(),S=(0,t.Z)(P,2),E=S[0],F=S[1],M=function(){r(void 0),Z.reset({firstName:"",lastName:"",phoneNumber:"",password:"",carBrand:"",carColor:"",carModel:"",carNumber:"",imageUrl:""})};return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(i.iA,{dataUrl:"courier/paging",columns:g,searchable:!0,onAddButton:h("employeeCreate")?function(){return _((0,u.dl)(!0))}:void 0,onEditColumn:h("employeeUpdate")?function(e){r(e._id),_((0,u.dl)(!0))}:void 0,onDeleteColumn:h("employeeDelete")?function(e){return x(e._id)}:void 0}),(0,j.jsx)(C,{open:v,setOpen:x,url:"courier/delete"}),(0,j.jsx)(i._8,{FORM_ID:"courier",isEditing:!!o,customTitle:N("general.addCourier"),onClose:M,children:(0,j.jsx)(b,{formStore:Z,resetForm:M,editingCourierId:o,productProps:{courierImages:y,setCourierImages:k,mainImageId:E,setMainImageId:F}})})]})}}}]);
//# sourceMappingURL=789.0a3b11a6.chunk.js.map