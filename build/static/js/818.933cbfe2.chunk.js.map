{"version":3,"file":"static/js/818.933cbfe2.chunk.js","mappings":"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","sources":["pages/abc_analytics/container/AbcAnalytics.tsx","pages/abc_analytics/index.tsx","pages/abc_analytics/container/abc_analytics.columns.tsx","utils/numberFormat.ts"],"sourcesContent":["import React, { useEffect } from 'react';\r\nimport { Grid, FormControl, InputLabel, Select, MenuItem, Alert } from \"@mui/material\";\r\nimport { Controller, useForm } from \"react-hook-form\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { Table, TextInput } from \"components\";\r\nimport { useProductColumns } from \"./abc_analytics.columns\";\r\nimport { useRoleManager } from \"services/useRoleManager\";\r\nimport { useAppDispatch } from \"store/storeHooks\";\r\nimport { RangeDatePicker } from \"components\";\r\nimport useAllQueryParams from \"hooks/useGetAllQueryParams/useAllQueryParams\";\r\nimport { useState } from \"react\";\r\n\r\nconst Client = () => {\r\n  const allParams = useAllQueryParams();\r\n  const columns = useProductColumns();\r\n  const hasAccess = useRoleManager();\r\n  const dis = useAppDispatch();\r\n  const { t } = useTranslation();\r\n  const [sortBy, setSortBy] = useState(\"total_price\");\r\n  const [error, setError] = useState(\"\");\r\n\r\n  const formStore = useForm({\r\n    defaultValues: {\r\n      a: 20,\r\n      b: 40,\r\n      c: 40,\r\n      sortBy: {\r\n        _id: \"total_price\",\r\n        name: \"Umumiy narx\",\r\n        trans_key: \"total_price\",\r\n      },\r\n    },\r\n  });\r\n  \r\n  const { control, handleSubmit, reset, setValue, watch } = formStore;\r\n  const watchedValues = {\r\n    a: Number(watch('a')) || 0,\r\n    b: Number(watch('b')) || 0,\r\n    c: Number(watch('c')) || 0\r\n  };\r\n\r\n  // Validate total equals 100\r\n  useEffect(() => {\r\n    const total = watchedValues.a + watchedValues.b + watchedValues.c;\r\n    if (total !== 100) {\r\n      setError(`A, B, va C qiymatlarining yig'indisi 100 bo'lishi kerak. Hozirgi yig'indi: ${total}`);\r\n    } else {\r\n      setError(\"\");\r\n    }\r\n  }, [watchedValues.a, watchedValues.b, watchedValues.c]);\r\n\r\n  const renderHeader = (\r\n    <>\r\n      <Grid className='pb-2' container display={\"flex\"} alignItems={'center'} spacing={2} >\r\n        <Grid lg={3} md={6} xs={12} paddingBlockStart={5} paddingInlineStart={2}>\r\n          <RangeDatePicker />\r\n        </Grid>\r\n        <Grid lg={3} md={6} xs={12} paddingBlockStart={5} paddingInlineStart={2}>\r\n          <Controller\r\n            name=\"sortBy\"\r\n            control={control}\r\n            render={({ field }) => (\r\n              <FormControl fullWidth>\r\n                <InputLabel id=\"sort-by-label\">{t(\"Filter\")}</InputLabel>\r\n                <Select\r\n                  labelId=\"sort-by-label\"\r\n                  label={t(\"Filter\")}\r\n                  size=\"small\"\r\n                  onChange={(e: any) => {\r\n                    setSortBy(e.target.value);\r\n                  }}\r\n                  style={{ width: '150px', paddingBlock: 3, marginTop: 2, borderRadius: 10 }}\r\n                  defaultValue={'total_price'}\r\n                >\r\n                  <MenuItem value=\"total_price\">Umumiy narx</MenuItem>\r\n                  <MenuItem value=\"total_amount\">Sotilgan</MenuItem>\r\n                </Select>\r\n              </FormControl>\r\n            )}\r\n          />\r\n        </Grid>\r\n        <Grid item lg={2} md={4} xs={12}>\r\n          <TextInput\r\n            name=\"a\"\r\n            control={control}\r\n            type=\"number\"\r\n            label={t(\"A\")}\r\n            rules={{ \r\n              required: true,\r\n              min: 0,\r\n              max: 100\r\n            }}\r\n          />\r\n        </Grid>\r\n        <Grid item lg={2} md={4} xs={12}>\r\n          <TextInput\r\n            name=\"b\"\r\n            control={control}\r\n            type=\"number\"\r\n            label={t(\"B\")}\r\n            rules={{ \r\n              required: true,\r\n              min: 0,\r\n              max: 100\r\n            }}\r\n          />\r\n        </Grid>\r\n        <Grid item lg={2} md={4} xs={12}>\r\n          <TextInput\r\n            name=\"c\"\r\n            control={control}\r\n            type=\"number\"\r\n            label={t(\"C\")}\r\n            rules={{ \r\n              required: true,\r\n              min: 0,\r\n              max: 100\r\n            }}\r\n          />\r\n        </Grid>\r\n      </Grid>\r\n    </>\r\n  );\r\n\r\n  return (\r\n    <>\r\n      <Table\r\n        columns={columns}\r\n        dataUrl=\"report/abc\"\r\n        headerChildren={renderHeader}\r\n        isGetAll\r\n        // @ts-ignore\r\n        exQueryParams={!error ? {\r\n          a: watchedValues.a,\r\n          b: watchedValues.b,\r\n          c: watchedValues.c,\r\n          sortBy: sortBy,\r\n          dateFrom: allParams.dateFrom,\r\n          dateTo: allParams.dateTo,\r\n        } : null}\r\n      />\r\n    </>\r\n  );\r\n};\r\n\r\nexport default Client;","import Product from \"./container/AbcAnalytics\";\r\n\r\nexport default Product;\r\n","import { GridColumns } from \"@mui/x-data-grid\";\r\nimport { Tooltip } from \"antd\";\r\nimport { get } from \"lodash\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { numberFormat } from \"utils/numberFormat\";\r\n\r\nexport const useProductColumns = (): GridColumns => {\r\n  const { t } = useTranslation();\r\n  const currentLang = localStorage.getItem(\"i18nextLng\") || \"uz\";\r\n\r\n\r\n  return [\r\n    {\r\n      field: t(\"common.productName\"),\r\n      renderCell({ row }) {\r\n        const title = row?.product?.name?.[currentLang];\r\n        const truncatedTitle = title?.length > 30 ? `${title.substring(0, 30)}...` : title;\r\n    \r\n        return (\r\n          <Tooltip title={title} arrow>\r\n            <span>{truncatedTitle}</span>\r\n          </Tooltip>\r\n        );\r\n      },\r\n    },\r\n    {\r\n      field: \"total_amount\",\r\n      headerName: t(\"common.sold\")!,\r\n      renderCell({ row }) {\r\n        return numberFormat(get(row, \"total_amount\", \"\"));\r\n      },\r\n    },\r\n    {\r\n      field: \"total_price\",\r\n      headerName: t(\"order.totalPrice\")!,\r\n      renderCell({ row }) {\r\n        return numberFormat(get(row, \"total_price\", \"\"));\r\n      },\r\n    },\r\n    {\r\n      field: \"share\",\r\n      headerName: t(\"general.share\") + \" (%)\"!,\r\n      renderCell({ row }) {\r\n        return numberFormat(get(row, \"share\", \"\"));\r\n      },\r\n    },\r\n    {\r\n      field: \"group\",\r\n      headerName: t(\"common.type\")!,\r\n      renderCell({ row }) {\r\n        return numberFormat(get(row, \"group\", \"\"));\r\n      },\r\n    },\r\n    // {\r\n    //   field: t(\"common.status\"),\r\n    //   renderCell({ row }) {\r\n    //     return get(row, \"status\", \"\");\r\n    //   },\r\n    // },\r\n  ];\r\n};\r\n","export const numberFormat = (number: any) => {\r\n  if (number || number === 0) {\r\n    // Floating-point xatoliklarni oldini olish\r\n    const rounded = Math.round((number + Number.EPSILON) * 100) / 100;\r\n\r\n    return rounded\r\n      .toLocaleString(\"en-US\", {\r\n        minimumFractionDigits: 0, // Har doim 2 kasr\r\n        maximumFractionDigits: 0, // Kasr 2 dan oshmaydi\r\n      })\r\n      .replaceAll(\",\", \" \"); // Minglik ajratgich\r\n  }\r\n  return \"\";\r\n};\r\n"],"names":["Client","allParams","useAllQueryParams","columns","useProductColumns","t","useTranslation","currentLang","localStorage","getItem","field","renderCell","_ref","_row$product","_row$product$name","row","title","product","name","truncatedTitle","length","concat","substring","_jsx","Tooltip","arrow","children","headerName","_ref2","numberFormat","get","_ref3","_ref4","_ref5","useRoleManager","useAppDispatch","sortBy","setSortBy","useState","error","setError","formStore","useForm","defaultValues","a","b","c","_id","trans_key","control","handleSubmit","reset","setValue","watch","watchedValues","Number","useEffect","total","renderHeader","_Fragment","_jsxs","Grid","className","container","display","alignItems","spacing","lg","md","xs","paddingBlockStart","paddingInlineStart","RangeDatePicker","Controller","render","FormControl","fullWidth","InputLabel","id","Select","labelId","label","size","onChange","e","target","value","style","width","paddingBlock","marginTop","borderRadius","defaultValue","MenuItem","item","TextInput","type","rules","required","min","max","Table","dataUrl","headerChildren","isGetAll","exQueryParams","dateFrom","dateTo","number","Math","round","EPSILON","toLocaleString","minimumFractionDigits","maximumFractionDigits","replaceAll"],"sourceRoot":""}