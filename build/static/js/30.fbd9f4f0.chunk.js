"use strict";(self.webpackChunkbestune_admin=self.webpackChunkbestune_admin||[]).push([[30],{40223:function(n,e,t){var i=t(4942),o=t(1413),r=t(29439),a=t(75912),d=t(27391),l=t(1048),s=t(39500),c=t(32188),u=t(71257),m=t(35834),p=t(763),v=t(72791),x=t(39230),f=t(11087),h=t(80184);e.Z=function(n){var e=n.options,t=void 0===e?[]:e,g=n.optionsUrl,b=void 0===g?"":g,j=n.returnOnlyId,y=void 0===j||j,N=n.label,Z=n.disabled,k=n.placeholder,w=n.filterName,S=n.nameProp,I=void 0===S?"name":S,C=n.exQueryParams,z=void 0===C?{}:C,A=n.dataProp,_=void 0===A?"data.data":A,P=n.mapData,E=n.onChange,T=(0,v.useState)(),L=(0,r.Z)(T,2),B=L[0],D=L[1],M=(0,v.useState)(),Y=(0,r.Z)(M,2),F=Y[0],V=Y[1],q=(0,u.Z)(F,600),O=q.debouncedValue,W=q.isDebouncing,R=(0,v.useState)(null),U=(0,r.Z)(R,2),G=U[0],Q=U[1],H=localStorage.getItem("i18nextLng")||"uz";(0,v.useEffect)((function(){D({search:F})}),[O]);var K=(0,c.h_)(b,(0,o.Z)((0,o.Z)({},B),z),{enabled:!!b,suspense:!1}),X=K.data,J=K.isFetching,$=function(n){return null!==n&&void 0!==n&&n.firstName?"".concat(null===n||void 0===n?void 0:n.firstName," ").concat(null===n||void 0===n?void 0:n.lastName):null===n||void 0===n?void 0:n[I]},nn=((0,p.get)(X,_)||t).map((function(n){return(0,o.Z)((0,o.Z)({},n),{},{name:$(n)})})),en=(0,f.lr)(),tn=(0,r.Z)(en,2),on=(tn[0],tn[1]),rn=(0,m.Z)(),an=(0,x.$G)().t;return(0,h.jsxs)(l.M,{children:[N&&(0,h.jsx)("label",{children:N}),(0,h.jsx)(a.Z,{options:P?P(nn):nn,getOptionLabel:function(n){var e;return(null===n||void 0===n||null===(e=n.name)||void 0===e?void 0:e[H])||""},onChange:function(n,e){null===E||void 0===E||E(e),Q(y?null===e||void 0===e?void 0:e._id:e),w&&(e?on((0,o.Z)((0,o.Z)({},rn),{},(0,i.Z)({},w,null===e||void 0===e?void 0:e._id))):(delete rn[w],on((0,o.Z)({},rn))))},loading:J||W,disabled:Z,sx:{"& fieldset":{border:"none"}},loadingText:"izlamoqda...",noOptionsText:!W&&"malumot topilmadi",value:y?(0,s.e)(nn,G):G,renderInput:function(n){return(0,h.jsx)(h.Fragment,{children:(0,h.jsx)(d.Z,(0,o.Z)((0,o.Z)({},n),{},{inputProps:(0,o.Z)((0,o.Z)({},n.inputProps),{},{onChange:function(e){var t,i;null===n||void 0===n||null===(t=n.inputProps)||void 0===t||null===(i=t.onChange)||void 0===i||i.call(t,e),V(e.target.value||"")}}),onBlur:function(){return V(void 0)},variant:"outlined",fullWidth:!0,placeholder:k||an("LABELS.ROLE_ALL.TITLE")}))})}})]})}},2030:function(n,e,t){t.r(e),t.d(e,{default:function(){return qn}});var i,o,r,a,d=t(57689),l=t(1413),s=t(29439),c=t(61889),u=t(21836),m=t(32188),p=t(72186),v=t(40630),x=t(59460),f=t(25850),h=t(30168),g=t(17939),b=g.default.div(i||(i=(0,h.Z)(["\n  .MuiToggleButton-root {\n    border-radius: 12px;\n    background-color: #f5f5f5 !important;\n    z-index: 2;\n    transition: all 0.3s ease;\n    &.active {\n      background-color: #EB5B00 !important;\n    }\n  }\n"]))),j=t(80184),y=function(){var n=(0,d.s0)(),e=(0,d.TH)().pathname;return(0,j.jsx)(b,{path:(0,f.Yt)(e),children:(0,j.jsxs)(p.Z,{color:"primary",value:(0,f.Yt)(e),exclusive:!0,onChange:function(e,t){t&&n("/order/".concat(t))},"aria-label":"Platform",children:[(0,j.jsx)(v.Z,{value:"table",className:"table"===(0,f.Yt)(e)?"active":"",children:(0,j.jsx)(x.Pp,{})}),(0,j.jsx)(v.Z,{value:"board",className:"board"===(0,f.Yt)(e)?"active":"",children:(0,j.jsx)(x.b1,{})})]})})},N=t(72791),Z=t(39230),k=t(29001),w=t(79405),S=t(50131),I=t(71796),C=t(97892),z=t.n(C),A=t(90816),_=g.default.div(o||(o=(0,h.Z)(["\n  margin-bottom: 5px;\n  .MuiInputBase-root {\n    background-color: ",";\n    color: "," !important;\n  }\n  & .MuiSelect-select.Mui-disabled {\n    color: "," !important;\n    -webkit-text-fill-color: "," !important;\n  }\n\n  & svg {\n    path {\n      fill: "," !important;\n    }\n  }\n"])),(function(n){return n.stateColor}),(function(n){return n.luma>60?"#232323":"#ffffff"}),(function(n){return n.luma>60?"#232323":"#ffffff"}),(function(n){return n.luma>60?"#232323":"#ffffff"}),(function(n){return n.luma>60?"#232323":"#ffffff"})),P=t(40223),E=t(55210),T=t(35834),L=function(){var n=(0,N.useState)(),e=(0,s.Z)(n,2),t=e[0],i=e[1],o=(0,w.T)(),r=((0,k.w)(),(0,w.C)((function(n){return n.SocketState.render}))),a=(0,T.Z)(),p=(0,N.useState)([]),v=(0,s.Z)(p,2),x=v[0],f=v[1],h=(0,m.uC)("order/state/".concat(null===t||void 0===t?void 0:t.orderId),"put",{onSuccess:function(){i(void 0),o((0,u.xV)(!0))}}),g=h.mutate,b=h.reset;(0,N.useEffect)((function(){t&&g({stateId:t.stateId,_id:t.orderId,position:1})}),[t]);var C=function(n,e){var t=(0,Z.$G)().t;return[{field:t("common.number"),renderCell:function(n){return n.row.number},flex:.6},{field:t("common.price"),renderCell:function(n){var e=n.row;return(0,A.Y)(e.totalPrice)},flex:.6},{field:t("order.receiver"),renderCell:function(n){var e,t,i=n.row,o=null===i||void 0===i||null===(e=i.customer)||void 0===e?void 0:e.firstName,r=(null===o||void 0===o?void 0:o.length)>10?"".concat(o.substring(0,10),"..."):o,a=null===i||void 0===i||null===(t=i.customer)||void 0===t?void 0:t.lastName,d=(null===a||void 0===a?void 0:a.length)>10?"".concat(a.substring(0,10),"..."):a,l="".concat(r).concat(a?" ".concat(d):""),s="".concat(o).concat(a?" ".concat(a):"");return(0,j.jsx)(S.Z,{title:s,arrow:!0,children:(0,j.jsx)("span",{children:l})})}},{field:t("common.phoneNumber"),renderCell:function(n){var e;return null===(e=n.row.customer)||void 0===e?void 0:e.phoneNumber}},{field:t("common.receiverPhoneNumber"),renderCell:function(n){var e;return null===(e=n.row.receiverCustomer)||void 0===e?void 0:e.phoneNumber}},{field:t("common.paymentType"),renderCell:function(n){var e=n.row;return t("enum.".concat(e.paymentType))},flex:.6},{field:"store",headerName:"Do'kon",renderCell:function(n){var e,t=n.row;return null!==t&&void 0!==t&&null!==(e=t.store)&&void 0!==e&&e.name?t.store.name:"string"===typeof(null===t||void 0===t?void 0:t.storeId)?"uygaayt"===t.storeId.toLowerCase()?"Uygaayt":t.storeId:null!==t&&void 0!==t&&t.storeId&&"object"===typeof t.storeId?t.storeId.toString():(null===t||void 0===t?void 0:t.storeId)||"-"},flex:.8},{field:t("common.time"),renderCell:function(n){var e=n.row;return z()(e.createdAt).format("DD.MM.YYYY HH:mm")}},{field:t("common.status"),renderCell:function(t){var i,o,r,a,d,l=t.row,s=null===l||void 0===l||null===(i=l.state)||void 0===i||null===(o=i.color)||void 0===o?void 0:o.substring(1),c=parseInt(s,16),u=.2126*(c>>16&255)+.7152*(c>>8&255)+.0722*(255&c);return(0,j.jsx)(_,{stateColor:null===l||void 0===l||null===(r=l.state)||void 0===r?void 0:r.color,luma:u,onClick:function(n){return n.stopPropagation()},children:(0,j.jsx)(I.Ph,{onChange:function(e){return n({stateId:e,orderId:l._id})},customValue:l.stateId,options:e,disabled:"completed"===(null===(a=l.state)||void 0===a?void 0:a.state)||"cancelled"===(null===(d=l.state)||void 0===d?void 0:d.state)})})}}]}(i,x),L=(0,d.s0)(),B=(0,Z.$G)().t;(0,N.useEffect)((function(){r&&(b(),o((0,E.zm)(!1)))}),[r]);var D=(0,j.jsx)(j.Fragment,{children:(0,j.jsxs)(c.ZP,{className:"lg:w-[60%] w-full gap-y-2 sm:gap-y-0 grid sm:grid-cols-3 items-center gap-x-2",children:[(0,j.jsx)(c.ZP,{item:!0,className:"",children:(0,j.jsx)(P.Z,{optionsUrl:"order-state/get-all",filterName:"stateId",placeholder:B("common.status"),dataProp:"data"})}),(0,j.jsx)(c.ZP,{item:!0,className:"",children:(0,j.jsx)(I.$m,{})}),(0,j.jsx)(c.ZP,{item:!0,className:" flex justify-end",children:(0,j.jsx)(y,{})})]})}),M=(0,m.h_)("order-state/get-all",{},{onSuccess:function(n){var e=n.data;f(e||[])}});M.data,M.status,M.refetch;return(0,j.jsx)(j.Fragment,{children:(0,j.jsx)(I.iA,{dataUrl:"/order/paging",columns:C,headerChildren:D,searchable:!0,onAddButton:function(){return L("/order/add")},onRowClick:function(n){return L("/order/".concat(n._id))},exQueryParams:(0,l.Z)({},null!==a&&void 0!==a&&a.stateId&&""!==a.stateId.trim()?{stateId:a.stateId}:{})})})},B=t(4942),D=t(93433),M=t(48541),Y=t(31976),F=t(23786),V=t(13400),q=function(n,e){var t,i=N.useState(null),o=(0,s.Z)(i,2),r=o[0],a=o[1],d=function(){a(null)};return(0,j.jsxs)("div",{className:"d-flex justify-content-between align-items-center lane_title",children:[(0,j.jsx)("h3",{children:n.title}),(0,j.jsx)("div",{children:0===(null===(t=n.cards)||void 0===t?void 0:t.length)?(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(V.Z,{"aria-owns":r?"simple-menu":void 0,"aria-haspopup":"true",onClick:function(n){a(n.currentTarget)}}),(0,j.jsx)(Y.Z,{id:"simple-menu",anchorEl:r,open:Boolean(r),onClose:d,children:(0,j.jsx)(F.Z,{onClick:function(){e({ids:[null===n||void 0===n?void 0:n.id]}),n.onDelete(null===n||void 0===n?void 0:n.id),d()},children:"Statusni o'chirish"})})]}):" "})]})},O=g.default.div(r||(r=(0,h.Z)(["\n  position: relative;\n  overflow-y: hidden !important;\n  background-color: #fff;\n  padding: 20px;\n  border-radius: 12px;\n  box-shadow: 0px 0px 4px 0px rgba(0, 0, 0, 0.07);\n  .header {\n    display: flex;\n    align-items: center;\n    justify-content: end;\n    margin-bottom: 10px;\n  }\n  .react-trello-board {\n    background-color: transparent;\n    height: 75vh !important;\n    padding: 0;\n    .react-trello-lane {\n      position: relative;\n      border-radius: 12px;\n      border: 1px solid #d9d9d9;\n      background-color: #ffffff;\n      width: 260px;\n      max-height: 70vh;\n      & {\n        width: 200px;\n      }\n      div:nth-child(2):not(div.smooth-dnd-draggable-wrapper) {\n        margin-top: 45px;\n        &::-webkit-scrollbar {\n          width: 10px;\n        }\n        &::-webkit-scrollbar-track {\n          background-color: #f6f6f6;\n          border-radius: 3px;\n        }\n        &::-webkit-scrollbar-thumb {\n          background-color: #d9d9d9;\n          border-radius: 3px;\n\n          &:hover {\n            background-color: #999;\n          }\n        }\n      }\n      width: 12px;\n      header {\n        padding-bottom: 3px;\n        margin-bottom: 5px;\n        button {\n          display: none;\n        }\n      }\n      .lane_title {\n        position: absolute;\n        top: 0;\n        left: 0;\n        height: 48px;\n        width: 100%;\n        border-radius: 8px 8px 0 0;\n        display: flex;\n        align-items: center;\n        justify-content: space-between;\n        padding: 0 12px;\n        border-bottom: 1px solid #d9d9d9;\n      }\n    }\n    .react-trello-card {\n      border-radius: 8px;\n      border: 1px solid #d9d9d9;\n      background-color: #f8f8f8;\n      min-height: 70px;\n      textarea {\n        pointer-events: none !important;\n        font-size: 14px;\n        font-weight: 600;\n        color: #006ffd;\n      }\n      span:nth-child(2) textarea {\n        color: #000;\n        text-align: left;\n      }\n      div {\n        textarea {\n          color: #888888;\n          font-size: 14px;\n          font-weight: 500;\n        }\n      }\n    }\n    .smooth-dnd-draggable-wrapper,\n    .smooth-dnd-container {\n      article {\n        header {\n          display: flex;\n          flex-direction: column;\n          span {\n            width: 100%;\n          }\n          textarea {\n          }\n        }\n        div {\n          margin: 0 !important ;\n          padding: 0 !important;\n        }\n      }\n    }\n  }\n  .add-lane-form {\n    border-radius: 12px;\n    padding: 10px;\n    width: 300px;\n    background-color: #d9d9d9;\n    .MuiInputBase-input {\n      border: 1px solid #999;\n      background-color: white;\n    }\n  }\n  .filters {\n    .MuiAutocomplete-root {\n      position: relative;\n    }\n    margin-bottom: 1rem;\n    label {\n      position: absolute;\n      top: -15px;\n    }\n  }\n  .load-more {\n    width: 100%;\n    background-color: transparent !important;\n    height: 30px;\n  }\n"])));g.default.div(a||(a=(0,h.Z)(["\n  background-color: #f5f5f5;\n  border: 1px solid #f5f5f5;\n  border-radius: 12px;\n  margin-right: 18px;\n  .MuiToggleButton-root {\n    border-radius: 12px;\n    &:last-child {\n      background-color: #0f6fdf;\n      border-radius: 12px !important;\n      z-index: 2;\n      transition: all 0.3s ease !important;\n\n      &:hover {\n        background-color: #0f6fdf;\n      }\n    }\n    &:first-child {\n      border: none;\n      border-radius: 12px !important;\n      transition: all 0.3s ease !important;\n\n      &:hover {\n        background-color: #0f6fdf;\n      }\n    }\n  }\n"])));var W,R,U,G,Q,H,K=t(57690),X=t(68002),J=(0,M.er)({"Add another lane":"+Status qo'shish","Click to add card":"Buyurtma qo'shish","Delete lane":"Statusni o'chirish","Lane actions":"Status ustidagi amallar",button:{"Add card":"Buyurtma qo'shing","Add lane":"Status qo'shish",Cancel:"Bekor qilish"},placeholder:{title:"Nomi",description:"Tavsif",label:"Yorliq"}}),$=function(){var n=(0,T.Z)(),e=(0,Z.$G)().t,t=(0,d.s0)(),i=(0,N.useState)(),o=(0,s.Z)(i,2),r=o[0],a=o[1],c=(0,N.useState)(!1),p=(0,s.Z)(c,2),v=p[0],x=p[1],f=(0,N.useState)(""),h=(0,s.Z)(f,2),g=h[0],b=h[1],S=(0,N.useState)({}),C=(0,s.Z)(S,2),z=C[0],A=C[1],_=(0,N.useState)({}),P=(0,s.Z)(_,2),L=P[0],Y=P[1],F=((0,k.w)(),(0,w.C)((function(n){return n.SocketState.render}))),V=(0,w.T)(),W=(0,N.useState)(),R=(0,s.Z)(W,2),U=R[0],G=R[1],Q=(0,m.h_)("order-state/get-all",(0,l.Z)({},n),{suspense:!1}),H=Q.data,$=Q.status,nn=Q.refetch,en=(0,m.uC)("order/state/".concat(null===U||void 0===U?void 0:U.orderId),"put",{onSuccess:function(){G(void 0),V((0,u.xV)(!0))}}),tn=en.mutate,on=en.reset;(0,N.useEffect)((function(){U&&tn({stateId:U.stateId,_id:U.orderId,position:1})}),[U]);var rn=(0,m.uC)("order/paging","post",{onSuccess:function(n,e){var t=n.data,i=e.stateId;a((function(n){return n?n.map((function(n){if(n._id===i){var e,o,r=1===L[i]?[]:n.orders||[],a=new Set(r.map((function(n){return n._id}))),d=null===t||void 0===t||null===(e=t.data)||void 0===e||null===(o=e.filter((function(n){return!a.has(n._id)})))||void 0===o?void 0:o.map((function(n){var e;return{number:n.number,totalPrice:n.totalPrice,addressName:n.addressName,createdAt:n.createdAt,state:null===(e=n.state)||void 0===e?void 0:e.state,_id:n._id,uniqueId:"".concat(n._id,"-").concat(n.createdAt)}}));return(0,l.Z)((0,l.Z)({},n),{},{orders:[].concat((0,D.Z)(r),(0,D.Z)(d||[]))})}return n})):n})),A((function(n){return(0,l.Z)((0,l.Z)({},n),{},(0,B.Z)({},i,!1))}))},onError:function(n,e){var t=e.stateId;A((function(n){return(0,l.Z)((0,l.Z)({},n),{},(0,B.Z)({},t,!1))}))}}),an=rn.mutate,dn=rn.reset;(0,N.useEffect)((function(){F&&(on(),dn(),nn(),V((0,E.zm)(!1)))}),[F]);(0,N.useEffect)((function(){var n=function(n){var e;null!==(e=n.data.state)&&void 0!==e&&e.isSoundable&&function(){try{new Audio(X).play()}catch(n){}}(),a((function(e){return e?e.map((function(e){if(e._id===n.data.stateId){var t,i={number:n.data.number,totalPrice:n.data.totalPrice,addressName:n.data.addressName,createdAt:n.data.createdAt,state:null===(t=n.data.state)||void 0===t?void 0:t.state,_id:n.data._id,uniqueId:"".concat(n.data._id,"-").concat(n.data.createdAt)},o=new Set((e.orders||[]).map((function(n){return n._id})));return o.has(i._id)?e:(0,l.Z)((0,l.Z)({},e),{},{orders:[].concat((0,D.Z)(e.orders||[]),[i])})}return e})):e}))};return K.W.on("orderCreated",n),function(){K.W.off("orderCreated",n)}}),[]),(0,N.useEffect)((function(){if("success"===$&&null!==H&&void 0!==H&&H.data){a(H.data);var n=H.data.reduce((function(n,e){return(0,l.Z)((0,l.Z)({},n),{},(0,B.Z)({},e._id,1))}),{});Y(n),H.data.forEach((function(n){A((function(e){return(0,l.Z)((0,l.Z)({},e),{},(0,B.Z)({},n._id,!0))})),an({page:1,limit:10,stateId:n._id})}))}}),[$,null===H||void 0===H?void 0:H.data]),(0,N.useEffect)((function(){r&&Object.values(z).every((function(n){return!n}))&&x(!0)}),[r,z]);var ln=(0,m.uC)("order/state/".concat(g),"put",{onSuccess:function(){b("")}}).mutate,sn=(0,m.uC)("status","put").mutate,cn=(0,m.uC)("status","delete").mutate,un=(0,N.useMemo)((function(){return v?function(n){var e=localStorage.getItem("i18nextLng")||"uz";return{lanes:null===n||void 0===n?void 0:n.map((function(n){var t,i;return{cards:(null===(t=n.orders)||void 0===t?void 0:t.map((function(n,e){return{id:n.uniqueId||n._id,label:"".concat(n.totalPrice," UZS"),title:"#".concat(n.number),description:n.addressName,draggable:!["completed","cancelled"].includes(n.state),metadata:{originalId:n._id}}})))||[],id:null===n||void 0===n?void 0:n._id,title:null===(i=n.name)||void 0===i?void 0:i[e],statusColor:n.color,style:{width:280,borderTop:"".concat("#ffffff"!==n.color?n.color:"#364880"," 5px solid")}}}))}}(r||[]):{lanes:[]}}),[r,v]);return(0,j.jsxs)(O,{children:[(0,j.jsx)("div",{className:"header",children:(0,j.jsx)(y,{})}),v?(0,j.jsx)(M.ZP,{data:un,editable:!0,handleDragEnd:function(n,e,t,i,o){var r;b((null===(r=o.metadata)||void 0===r?void 0:r.originalId)||o.id),setTimeout((function(){var n;return ln({position:i,stateId:t,_id:null===o||void 0===o||null===(n=o.metadata)||void 0===n?void 0:n.originalId})}),0)},handleLaneDragEnd:function(n,e,t){sn({_id:t.id,position:+e+1})},editLaneTitle:!1,canAddLanes:!1,hideCardDeleteIcon:!0,onCardClick:function(n,e){var i=null===e||void 0===e?void 0:e.originalId;i&&t("/order/".concat(i))},components:{LaneHeader:function(n){return q(n,cn)},AddCardLink:function(n){var t=n.laneId;return(0,j.jsx)(I.c7,{title:z[t]?e("general.loading"):e("general.loadMore"),className:"load-more",disabled:z[t],onClick:function(){return function(n){if(!z[n]){A((function(e){return(0,l.Z)((0,l.Z)({},e),{},(0,B.Z)({},n,!0))}));var e=(L[n]||1)+1;Y((function(t){return(0,l.Z)((0,l.Z)({},t),{},(0,B.Z)({},n,e))})),an({page:e,limit:10,stateId:n})}}(t)}})}},lang:"ru",t:J}):(0,j.jsx)(I.gb,{})]})},nn=g.default.div(W||(W=(0,h.Z)(["\n  margin-top: 12px;\n"]))),en=g.default.div(R||(R=(0,h.Z)(["\n  border-radius: 12px;\n  background: #fff;\n  box-shadow: 0px 0px 4px 0px rgba(0, 0, 0, 0.07);\n  padding: 16px;\n  height: calc(100vh - 110px);\n  overflow: auto;\n  .tab {\n    margin-bottom: 16px;\n    .tab-btn {\n      color: #999;\n      font-size: 14px;\n      font-weight: 600;\n      padding: 12px;\n      width: 50%;\n      border: none;\n      border-bottom: 2px solid #e9e9e9;\n      background: none;\n      cursor: pointer;\n      &.active {\n        color: #000;\n        border-bottom: 2px solid #006ffd;\n      }\n    }\n  }\n  .search {\n    display: flex;\n    align-items: center;\n    justify-content: end;\n    > div {\n      width: 100%;\n    }\n    .clear-basket {\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      max-width: 42px;\n      min-width: 42px;\n      height: 42px;\n      border-radius: 10px;\n      background: #f5f5f5;\n      margin-left: 30px;\n      cursor: pointer;\n      svg path {\n        fill: #999;\n      }\n    }\n  }\n  .product-card {\n    position: relative;\n    padding: 10px;\n    border-radius: 16px;\n    background: #f5f5f5;\n    cursor: pointer;\n    .amount {\n      position: absolute;\n      top: -10px;\n      left: -10px;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      font-size: 12px;\n      font-weight: 600;\n      min-width: 25px;\n      padding: 5px;\n      height: 25px;\n      border-radius: 50%;\n      background-color: #006ffd;\n      color: #fff;\n    }\n    .name {\n      display: -webkit-box;\n      -webkit-line-clamp: 1;\n      -webkit-box-orient: vertical;\n      color: #454545;\n      font-size: 14px;\n      line-height: 20px;\n      overflow: hidden;\n    }\n    .price {\n      display: block;\n      font-size: 14px;\n      margin-top: 10px;\n      font-weight: 600;\n    }\n    .in-stock {\n      font-size: 12px;\n      color: #999;\n    }\n  }\n  .basket-item {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    padding: 8px 0;\n    border-bottom: 1px solid #e9e9e9;\n    .name {\n      font-size: 14px;\n      color: #454545;\n      padding-left: 10px;\n      width: 75%;\n      word-wrap: break-word;\n    }\n    .action {\n      display: flex;\n      align-items: center;\n      span {\n        border-radius: 8px;\n        background: #f5f5f5;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n      }\n      .icon {\n        width: 34px;\n        height: 34px;\n        cursor: pointer;\n      }\n      .amount-input {\n        display: block;\n        height: 34px;\n        padding: 0 10px;\n        width: 64px;\n        margin: 0 8px;\n        border-radius: 8px;\n        background: #f5f5f5;\n        border: none;\n        font-size: 16px;\n        font-weight: 600;\n        text-align: center;\n      }\n    }\n  }\n"]))),tn=t(61134),on=t(81502),rn=t(697),an=t(71257),dn=t(29749),ln=t(763),sn=t(11087),cn=t(93385),un=t(40260),mn=function(n){var e=n.totalItems,t=n.itemsPerPage,i=n.allParams,o=n.setSearchParams,r=(0,N.useState)(parseInt(i.page||"1")),a=(0,s.Z)(r,2),d=a[0],c=a[1],u=Math.ceil(e/t),m=function(n){n<1||n>u||(c(n),o((0,l.Z)((0,l.Z)({},i),{},{page:n.toString(),limit:t.toString()})))};return(0,N.useEffect)((function(){o((0,l.Z)((0,l.Z)({},i),{},{page:d.toString(),limit:t.toString()}))}),[d]),(0,j.jsxs)("div",{className:"pagination flex items-center justify-center space-x-3 mt-4",children:[(0,j.jsx)("button",{onClick:function(){return m(d-1)},disabled:d<=1,className:"pagination-btn p-1 bg-gray-300 rounded-lg text-gray-700 disabled:opacity-50",children:(0,j.jsx)(un.Z,{})}),(0,j.jsxs)("span",{className:"text-lg",children:["Page ",d," of ",u]}),(0,j.jsx)("button",{onClick:function(){return m(d+1)},disabled:d>=u,className:"pagination-btn p-1 bg-gray-300 rounded-lg text-gray-700 disabled:opacity-50",children:(0,j.jsx)(cn.Z,{})})]})},pn=function(n){var e,t,i,o,r,a,d,u=n.basketItems,p=n.setBasketItems,v=(0,N.useState)("product"),f=(0,s.Z)(v,2),h=f[0],g=f[1],b=(0,N.useState)(!1),y=(0,s.Z)(b,2),k=y[0],S=y[1],C=(0,N.useState)(null),z=(0,s.Z)(C,2),_=z[0],P=z[1],E=(0,N.useState)([]),L=(0,s.Z)(E,2),B=L[0],M=L[1],Y=(0,T.Z)(),F=(0,tn.cI)(),V=(F.control,F.watch,(0,N.useState)(Y.search||"")),q=(0,s.Z)(V,2),O=q[0],W=q[1],R=(0,an.Z)(O,500).debouncedValue,U=(0,Z.$G)().t,G=(0,sn.lr)(),Q=(0,s.Z)(G,2),H=Q[0],K=Q[1],X=(0,w.C)((function(n){return n.tableState.render})),J=localStorage.getItem("i18nextLng")||"uz",$=(0,N.useState)({page:H.get("page")||1,limit:H.get("limit")||10,search:H.get("search")||""}),nn=(0,s.Z)($,2),cn=nn[0],un=nn[1];(0,N.useEffect)((function(){K((0,l.Z)((0,l.Z)({},Y),{},{search:O||"",page:O?"1":Y.page||"1",limit:Y.limit||"10"}))}),[R]);var pn=(0,dn.Z)().state.data,vn=(0,m.uC)("product/paging","post",{onSuccess:function(n){un((0,l.Z)((0,l.Z)({},Y),{},{search:R||"",page:O?"1":Y.page||"1",limit:Y.limit||"10"}))},onError:function(n){console.error("Error creating product:",n)}}),xn=vn.data,fn=vn.mutate;(0,N.useEffect)((function(){fn((0,l.Z)((0,l.Z)({},cn),Y))}),[X,R,H]);var hn=function(n,e,t){var i=null===u||void 0===u?void 0:u.find((function(e){return e._id===(null===n||void 0===n?void 0:n._id)}));if(i)return"minus"===e&&1===i.amount?p((function(n){return n.filter((function(n){return n._id!==i._id}))})):p((function(o){return o.map((function(o){if(o._id===(null===n||void 0===n?void 0:n._id)){var r=o.amount;return(0,l.Z)((0,l.Z)({},o),{},{amount:t?"noValue"===t?"":Number(t)<=n.inStock?Number(t):r:e?"minus"===e&&r>1?r-1:"plus"===e&&i.amount<n.inStock?r+1:r:i.amount<n.inStock?r+1:r})}return o}))}));n&&p((function(e){return[].concat((0,D.Z)(e),[(0,l.Z)((0,l.Z)({},n),{},{amount:1,salom:"hello"})])}))},gn=function(){S(!1),P(null),M([])};return(0,j.jsxs)(en,{children:[(0,j.jsxs)("div",{className:"tab",children:[(0,j.jsx)("button",{className:"tab-btn ".concat("product"===h&&"active"),onClick:function(){return g("product")},children:U("order.products")}),(0,j.jsx)("button",{className:"tab-btn ".concat("basket"===h&&"active"),onClick:function(){return g("basket")},children:U("order.basket")})]}),(0,j.jsxs)("div",{className:"mb-3 search",children:["product"===h&&(0,j.jsx)(I.Mj,{value:O,onChange:function(n){var e;W(null===n||void 0===n||null===(e=n.target)||void 0===e?void 0:e.value)}}),"basket"===h&&(0,j.jsx)("div",{className:"clear-basket",onClick:function(){return p([])},children:(0,j.jsx)(x.pJ,{})})]}),"product"===h&&(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(c.ZP,{container:!0,spacing:2,children:null===xn||void 0===xn||null===(e=xn.data)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.map((function(n){var e=u.find((function(e){return e._id===n._id}));return(0,j.jsx)(c.ZP,{item:!0,md:4,children:(0,j.jsxs)("div",{className:"product-card",style:{border:"1px solid #e0e0e0",borderRadius:"8px",padding:"16px",backgroundColor:"#F5F5F5",display:"flex",flexDirection:"column",alignItems:"center",gap:"12px",height:"170px",justifyContent:"space-between",transition:"transform 0.2s ease"},onClick:function(){var e;(null===(e=n.attributes)||void 0===e?void 0:e.length)>0?function(n){P(n),S(!0)}(n):hn(n)},onMouseEnter:function(n){return n.currentTarget.style.transform="scale(1.02)"},onMouseLeave:function(n){return n.currentTarget.style.transform="scale(1)"},children:[e&&(0,j.jsxs)("div",{style:{background:"#f44336",color:"#fff",padding:"4px 8px",borderRadius:"12px",fontSize:"12px",position:"absolute",top:"12px",right:"12px"},children:[e.amount," dona"]}),(0,j.jsx)("div",{style:{fontWeight:"600",fontSize:"16px",color:"#333",textAlign:"center"},children:n.name}),(0,j.jsxs)("div",{style:{width:"100%",display:"block",justifyContent:"space-between",fontSize:"14px",textAlign:"center"},children:[!1===(null===n||void 0===n?void 0:n.discountEnabled)?"":(0,j.jsxs)("div",{style:{color:"#ed0e0e"},children:[U("order.original_price"),":",(0,j.jsxs)("s",{style:{marginLeft:"4px"},children:[(0,A.Y)(n.price)," ",(0,ln.get)(pn,"currency","uzs")]})]}),(null===n||void 0===n?void 0:n.discountEnabled)&&(0,j.jsxs)("div",{style:{color:"#4caf50",fontWeight:"bold"},children:[U("common.discount"),": ",(0,A.Y)(null===n||void 0===n?void 0:n.discountValue)," ","percent"===(null===n||void 0===n?void 0:n.discountType)?"%":(0,ln.get)(pn,"currency","uzs")]})]}),(0,j.jsxs)("div",{style:{fontSize:"18px",fontWeight:"700",color:"#000"},children:[(0,A.Y)(n.salePrice)," ",(0,ln.get)(pn,"currency","uzs")]}),(0,j.jsxs)("div",{style:{fontSize:"12px",color:"#757575",marginTop:"8px"},children:[U("order.in_warehouse"),": ",(0,A.Y)(n.inStock)]})]})},n._id)}))}),(0,j.jsx)(c.ZP,{children:(0,j.jsx)(mn,{totalItems:null===xn||void 0===xn||null===(i=xn.data)||void 0===i?void 0:i.total,itemsPerPage:+Y.limit||10,allParams:Y,setSearchParams:K})})]}),(0,j.jsx)(on.Z,{open:k,onClose:gn,"aria-labelledby":"modal-title","aria-describedby":"modal-description",children:(0,j.jsxs)(rn.Z,{sx:{padding:"20px",background:"#fff",borderRadius:"8px",maxWidth:"500px",margin:"auto",boxShadow:"0 4px 10px rgba(0, 0, 0, 0.1)"},children:[(0,j.jsx)("h2",{id:"modal-title",style:{textAlign:"center",marginBottom:"20px",fontSize:"20px",color:"#333"},children:U("general.again_choose")}),null===_||void 0===_||null===(o=_.attributes)||void 0===o?void 0:o.map((function(n,e){var t,i;return(0,j.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,j.jsx)("h3",{style:{fontSize:"16px",fontWeight:"600",color:"#333",marginBottom:"10px",borderBottom:"1px solid #eee",paddingBottom:"5px"},children:(null===n||void 0===n||null===(t=n.attribute)||void 0===t||null===(i=t.name)||void 0===i?void 0:i[J])||""}),(0,j.jsx)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px",marginTop:"10px"},children:n.items.map((function(e,t){return(0,j.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",padding:"10px",border:B.some((function(t){var i;return t.attributeId===(null===n||void 0===n||null===(i=n.attribute)||void 0===i?void 0:i._id)&&t.attributeItem===e.attributeItem}))?"2px solid #2196f3":"1px solid #ddd",borderRadius:"8px",backgroundColor:B.some((function(t){var i;return t.attributeId===(null===n||void 0===n||null===(i=n.attribute)||void 0===i?void 0:i._id)&&t.attributeItem===e.attributeItem}))?"#f1f9ff":"#fff",cursor:"pointer",transition:"all 0.3s ease"},onClick:function(){var t,i,o;return i=e,o=null===n||void 0===n||null===(t=n.attribute)||void 0===t?void 0:t._id,void M((function(n){var e=n.filter((function(n){return n.attributeId!==o})),t=[].concat((0,D.Z)(e),[(0,l.Z)((0,l.Z)({},i),{},{attributeId:o})]);return console.log("Updated Variants:",t),t}))},children:[(0,j.jsx)("div",{style:{fontWeight:"500",fontSize:"14px",color:"#333"},children:e.attributeItem}),(0,j.jsxs)("div",{style:{fontSize:"12px",color:"#888",marginTop:"5px"},children:["+ ",(0,A.Y)(e.amount)," ",(0,ln.get)(pn,"currency","uzs")]})]},t)}))})]},e)})),(0,j.jsx)("div",{style:{marginTop:"30px",display:"flex",justifyContent:"center",alignItems:"center"},children:(0,j.jsx)("button",{onClick:function(){if(_&&B){var n=(0,l.Z)((0,l.Z)({},_),{},{variants:B.map((function(n){return{attributeId:n.attributeId,attributeItem:n.attributeItem}}))});hn(n),gn()}},style:{padding:"10px 20px",background:B.length===(null===_||void 0===_||null===(r=_.attributes)||void 0===r?void 0:r.length)?"#4caf50":"#ddd",color:"#fff",border:"none",borderRadius:"4px",cursor:B.length===(null===_||void 0===_||null===(a=_.attributes)||void 0===a?void 0:a.length)?"pointer":"not-allowed",fontSize:"16px",fontWeight:"600",transition:"background-color 0.3s ease"},disabled:B.length!==(null===_||void 0===_||null===(d=_.attributes)||void 0===d?void 0:d.length),children:U("general.add_basket")})})]})}),"basket"===h&&(0,j.jsx)("div",{children:null===u||void 0===u?void 0:u.map((function(n){var e,t;return(0,j.jsxs)("div",{className:"basket-item",children:[(0,j.jsxs)("div",{className:"flex gap-2",children:[(0,j.jsx)("span",{className:"",children:n.name}),(null===n||void 0===n||null===(e=n.variants)||void 0===e?void 0:e.length)>0&&(0,j.jsx)("div",{className:"variant-info flex",children:null===n||void 0===n||null===(t=n.variants)||void 0===t?void 0:t.map((function(n,e){return(0,j.jsx)("div",{className:"variant-item flex",children:(0,j.jsxs)("span",{className:"variant-name ml-1",children:["-",n.attributeItem]})},e)}))})]}),(0,j.jsxs)("div",{className:"action",children:[(0,j.jsx)("span",{className:"icon",onClick:function(){return hn(n,"minus")},children:(0,j.jsx)(x.V_,{})}),(0,j.jsx)("input",{type:"text",className:"amount-input",value:n.amount,onChange:function(e){return hn(n,"",e.target.value||"noValue")}}),(0,j.jsx)("span",{className:"icon",onClick:function(){return hn(n,"plus")},children:(0,j.jsx)(x.pO,{})})]})]},n._id)}))})]})},vn=g.default.div(U||(U=(0,h.Z)(["\n  border-radius: 12px;\n  background: #fff;\n  box-shadow: 0px 0px 4px 0px rgba(0, 0, 0, 0.07);\n  padding: 16px;\n  max-height: calc(100vh - 110px);\n  overflow: auto;\n  .item {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    margin-bottom: 12px;\n    .key {\n      font-size: 14px;\n    }\n    .value {\n      font-size: 14px;\n      font-weight: 600;\n    }\n    &:last-of-type {\n      .key {\n        font-weight: 600;\n      }\n    }\n  }\n  .submit-btn {\n    width: 100%;\n  }\n"]))),xn=g.default.div(G||(G=(0,h.Z)(["\n  width: 860px;\n  height: 500px;\n  background-color: #fff;\n  border-radius: 24px;\n  overflow: hidden;\n  .modal-form {\n    display: flex;\n    flex-direction: column;\n    height: 100%;\n    padding: 24px;\n    .title {\n      display: flex;\n      align-items: center;\n      margin-bottom: 24px;\n      h2 {\n        font-size: 20px;\n        font-weight: 600;\n        margin-left: 23px;\n      }\n    }\n    .address-options {\n      position: absolute;\n      box-shadow: 0px 2px 10px rgba(0, 0, 0, 0.1);\n      padding: 10px 0;\n      border-radius: 10px;\n      background-color: #fff;\n      max-height: 300px;\n      overflow: auto;\n      z-index: 1;\n      .option {\n        padding: 8px 15px;\n        cursor: pointer;\n        &:hover {\n          background-color: #f5f5f5;\n        }\n      }\n    }\n    .save-btn {\n      width: 100%;\n      margin-top: auto;\n    }\n  }\n"]))),fn=t(89303),hn=t(30709),gn=t(75985),bn=t(73405),jn=function(n){var e,t,i,o,r,a,d,l,c,u,p=n.getCoordinate,v=n.center,x=n.height,f=n.order,h=(0,N.useState)(v),g=(0,s.Z)(h,2),b=g[0],y=g[1],Z=(0,N.useRef)(null),k=(0,tn.cI)().reset,w=(0,m.h_)("settings-general",{},{onSuccess:function(n){var e=n.data;localStorage.setItem("settings",JSON.stringify(e))}}),S=w.data,I=w.status,C=(w.refetch,(0,m.h_)("store/get",{},{suspense:!1})),z=C.data,A=C.status;(0,N.useEffect)((function(){"success"===I&&k()}),[I]),(0,N.useEffect)((function(){"success"===A&&k()}),[A]);var _={latitude:null===z||void 0===z||null===(e=z.data)||void 0===e||null===(t=e.addressLocation)||void 0===t?void 0:t.latitude,longitude:null===z||void 0===z||null===(i=z.data)||void 0===i||null===(o=i.addressLocation)||void 0===o?void 0:o.longitude},P=1e3*(null===S||void 0===S||null===(r=S.data)||void 0===r?void 0:r.storeRadius);(0,N.useEffect)((function(){v&&(y(v),Z.current&&Z.current.setCenter([v.latitude,v.longitude]))}),[v]);var E=function(n,e){var t=n.latitude*Math.PI/180,i=e.latitude*Math.PI/180,o=(e.latitude-n.latitude)*Math.PI/180,r=(e.longitude-n.longitude)*Math.PI/180,a=Math.sin(o/2)*Math.sin(o/2)+Math.cos(t)*Math.cos(i)*Math.sin(r/2)*Math.sin(r/2);return 6371e3*(2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a)))};return(0,j.jsx)(bn.Yy,{children:(0,j.jsxs)(bn.D5,{width:"100%",height:x||"500px",defaultState:{center:null!==v&&void 0!==v&&v.latitude?[v.latitude,v.longitude]:null!==f&&void 0!==f&&null!==(a=f.addressLocation)&&void 0!==a&&a.latitude?[null===f||void 0===f||null===(d=f.addressLocation)||void 0===d?void 0:d.latitude,null===f||void 0===f||null===(l=f.addressLocation)||void 0===l?void 0:l.longitude]:[_.latitude,_.longitude],zoom:14,behaviors:["default","scrollZoom"]},instanceRef:function(n){Z.current=n},onClick:function(n){var e,t={latitude:n.get("coords")[0],longitude:n.get("coords")[1]};E(t,_)<=P?(y(t),p(t)):gn.Am.error("Kechirasiz, siz faqat do'kondan ".concat(null===S||void 0===S||null===(e=S.data)||void 0===e?void 0:e.storeRadius," km radius ichida joy tanlay olasiz."))},children:[(0,j.jsx)(bn.ah,{geometry:null!=(null===b||void 0===b?void 0:b.latitude)&&null!=(null===b||void 0===b?void 0:b.longitude)?[b.latitude,b.longitude]:[null===f||void 0===f||null===(c=f.addressLocation)||void 0===c?void 0:c.latitude,null===f||void 0===f||null===(u=f.addressLocation)||void 0===u?void 0:u.longitude]}),(0,j.jsx)(bn.ot,{}),(0,j.jsx)(bn.Bo,{options:{float:"left"},onClick:function(){navigator.geolocation?navigator.geolocation.getCurrentPosition((function(n){var e,t={latitude:n.coords.latitude,longitude:n.coords.longitude};E(t,_)<=P?(y(t),p(t),Z.current&&Z.current.setCenter([t.latitude,t.longitude],14)):gn.Am.error("Kechirasiz, siz faqat do'kondan ".concat(null===S||void 0===S||null===(e=S.data)||void 0===e?void 0:e.storeRadius," km radius ichida joy tanlay olasiz."))}),(function(n){console.error("Geolocation error:",n)})):console.error("Geolocation is not supported by this browser.")}}),(0,j.jsx)(bn.Sj,{options:{float:"right"}}),(0,j.jsx)(bn.Ly,{options:{float:"right"}})]})})},yn=t(68096),Nn=t(58406),Zn=(0,g.default)(Nn.Z)(Q||(Q=(0,h.Z)(["\n  height: 45px;\n  .MuiSelect-select {\n    background-color: #fff;\n    padding: 0px 12px;\n    height: 45px !important;\n    border-radius: 10px !important;\n    border: 1px solid #d9d9d9;\n    line-height: 48px;\n  }\n  & ~ .text-error {\n    position: absolute;\n    bottom: -20px;\n  }\n"]))),kn=g.default.div(H||(H=(0,h.Z)(["\n  padding: 6px 0;\n  label {\n    color: #232323;\n    font-weight: 500;\n    font-size: 14px;\n  }\n"])));var wn,Sn,In,Cn=function(n){return{style:{color:n?"initial":"white"}}},zn=function(n){var e=n.control,t=n.options,i=void 0===t?[]:t,o=n.name,r=n.label,a=n.disabled,d=void 0!==a&&a,s=n.optionsUrl,c=(n.className,n.placeholder,n.setValue,n.defaultValue),u=void 0===c?"":c,p=n.filterOptions,v=n.setAdditionalItem,x=n.rules,f=void 0===x?{required:{value:!0,message:"Majburiy"}}:x,h=n.onChange,g=(0,Z.$G)().t,b=(0,m.uC)(s||"","post",{onSuccess:function(){console.log("success")}}),y=b.mutate,k=b.data;b.reset,b.status,(0,N.useEffect)((function(){y({optionsFromUrl:k})}),[y]),(0,N.useEffect)((function(){k?console.log("Fetched optionsFromUrl:"):console.warn("optionsFromUrl is undefined")}),[k]),k&&k.data;var w=(null!==k&&void 0!==k&&k.data.data&&Array.isArray(k.data.data)?k.data.data:i).map((function(n){return(0,l.Z)((0,l.Z)({},n),{},{name:n.firstName?"".concat(n.firstName," ").concat(n.lastName):n.carBrand?"Brand: ".concat(n.carBrand,", Model: ").concat(n.carModel):"Number: ".concat(n.carNumber)})}));return(0,j.jsxs)(j.Fragment,{children:[r&&(0,j.jsxs)(kn,{className:"select-label",children:[(0,j.jsx)("label",{children:r}),(0,j.jsx)("span",{children:r&&null!==f&&void 0!==f&&f.required?(0,j.jsx)("span",{className:"text-error mt-1",children:"*"}):null})]}),(0,j.jsx)(yn.Z,{fullWidth:!0,variant:"outlined",children:(0,j.jsx)(tn.Qr,{name:o,control:e,rules:f,render:function(n){var e,t=n.field,i=t.onChange,r=t.value,a=t.ref,l=t.onBlur,s=n.fieldState,c=!!s.error;return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(Zn,{onChange:function(n){i(n),null===h||void 0===h||h(n.target.value,null===w||void 0===w?void 0:w.find((function(e){var t;return(null===e||void 0===e?void 0:e._id)===(null===n||void 0===n||null===(t=n.target)||void 0===t?void 0:t.value)})))},value:r,labelId:o,id:o,ref:a,onBlur:l,color:s.error?"error":void 0,SelectDisplayProps:Cn(r),disabled:d,sx:{"& fieldset":{border:"none"}},children:(null===w||void 0===w?void 0:w.length)>0?null===(e=p?p(w):w)||void 0===e?void 0:e.map((function(n){return(0,j.jsxs)(F.Z,{value:n._id,children:[n.fullName,null===v||void 0===v?void 0:v(n.fullName)]},n._id)})):(0,j.jsx)(F.Z,{disabled:!0,value:void 0,children:"Hech narsa topilmadi\u26d4"})}),c&&(0,j.jsx)("h6",{className:"text-error mt-1",children:g("general.required")})]})},defaultValue:u})})]})},An=function(n){var e,t,i,o,r,a,u,p,v,f,h,g,b,y,k,w,S,C=n.basketItems,_=n.formStore,P=n.order,E=(0,N.useState)(!1),T=(0,s.Z)(E,2),L=T[0],B=T[1],D=(0,N.useState)(!1),M=(0,s.Z)(D,2),Y=M[0],F=M[1],V=(0,N.useState)(),q=(0,s.Z)(V,2),O=q[0],W=q[1],R=(0,N.useState)(""),U=(0,s.Z)(R,2),G=U[0],Q=U[1],H=(0,Z.$G)().t,K=(0,tn.cI)(),X=K.control,J=K.setValue,$=K.handleSubmit,nn=K.watch,en=K.setError,on=(K.reset,K.getValues),rn=((0,an.Z)(G,1e3).debouncedValue,(0,d.s0)()),sn=(0,d.UO)().id,cn=C.reduce((function(n,e){return n+e.salePrice*e.amount}),0),un=(0,N.useState)(""),mn=(0,s.Z)(un,2),pn=mn[0],bn=mn[1],yn=(0,dn.Z)().state.data,Nn=(0,m.uC)("address/by-name","post",{onSuccess:function(){B(!0)},onError:function(n){console.error("Error fetching address:",n)}}),Zn=Nn.mutate,kn=Nn.data;(0,N.useEffect)((function(){"string"===typeof G&&G.trim()&&Zn({name:G})}),[G]);var wn=(0,m.uC)("order/create","post",{onSuccess:function(){rn("/order")}}),Sn=wn.mutate,In=wn.status,Cn=(0,m.uC)("address/by-point","post",{onSuccess:function(n){var e=n.data;_?(null===_||void 0===_||_.setValue("addressName",null===e||void 0===e?void 0:e.name),null===_||void 0===_||_.setValue("addressLocation",O),null===_||void 0===_||_.setError("addressName",{})):(J("addressName",null===e||void 0===e?void 0:e.name),J("addressLocation",O),en("addressName",{}))},onError:function(n){console.error("Error fetching address:",n)}}),An=Cn.mutate;(0,N.useEffect)((function(){null!==O&&void 0!==O&&O.latitude&&null!==O&&void 0!==O&&O.longitude?An({latitude:O.latitude,longitude:O.longitude}):console.error("Coordinates are missing")}),[An,O]),console.log(C);var _n=(0,m.h_)("order/get-by-id/".concat(sn),{},{enabled:!!sn}).data,Pn=null===_n||void 0===_n||null===(e=_n.data)||void 0===e?void 0:e.courierId,En=(0,m.uC)("order/set-courier","post",{onSuccess:function(n){bn(n.data.courierId)},onError:function(n){console.error("API Error:",n)}}),Tn=En.mutate,Ln=(En.data,En.status,En.isLoading,(0,m.uC)("order/calculate","post",{onSuccess:function(n){},onError:function(n){console.error("API Error:",n)}})),Bn=Ln.mutate,Dn=Ln.data,Mn=(Ln.status,Ln.isLoading,function(){var n=(null===_||void 0===_?void 0:_.getValues("phoneNumber"))||on("phoneNumber");Bn({paymentType:"cash",addressLocation:{latitude:null===O||void 0===O?void 0:O.latitude,longitude:null===O||void 0===O?void 0:O.longitude},items:C.map((function(n){var e;return{productId:n._id,amount:n.amount,attributes:null===n||void 0===n||null===(e=n.variants)||void 0===e?void 0:e.map((function(n){return{attributeId:n.attributeId,attributeItem:n.attributeItem}}))}})),phoneNumber:n})});return(0,N.useEffect)((function(){C.length>0&&Mn()}),[C,_,O]),(0,j.jsxs)(vn,{children:[!sn&&(0,j.jsx)("h3",{className:"mb-3",children:H("order.formalization")}),(0,j.jsxs)("form",{onSubmit:$((function(n){var e=nn("addressLocation");if(e&&e.latitude&&e.longitude){if(!C.length)return gn.Am.warning(H("order.chooseProduct"));if(C.find((function(n){return!(n.amount>0)})))return gn.Am.warning(H("order.validAmount"));var t=(0,ln.get)(yn,"orderMinimumPrice",0);if(cn<t)return gn.Am.warning("".concat(H("order.minimum_order_amount")," ").concat((0,A.Y)(t)," ").concat((0,ln.get)(yn,"currency","uzs")));var i=(0,l.Z)((0,l.Z)({},n),{},{deliveryDate:z()(n.deliveryDate).format(),items:C.map((function(n){var e;return{productId:n._id,amount:n.amount,attributes:null===n||void 0===n||null===(e=n.variants)||void 0===e?void 0:e.map((function(n){return{attributeId:n.attributeId,attributeItem:n.attributeItem}}))}})),addressLocation:{latitude:null===O||void 0===O?void 0:O.latitude,longitude:null===O||void 0===O?void 0:O.longitude}});Sn(i)}else gn.Am.error("Manzil noto'g'ri kiritilgan yoki xaritada topilmadi!")})),children:[(0,j.jsxs)(c.ZP,{container:!0,spacing:2,children:[(0,j.jsx)(c.ZP,{item:!0,sm:12,children:(0,j.jsxs)("div",{onClick:function(){return F(!0)},children:[(0,j.jsx)(I.oi,{control:_?_.control:X,name:"addressName",label:H("order.deliveryAddress"),placeholder:"Yetkazib berish manzili",searchIcon:!0,onCustomChange:function(n){Q(n)},disabled:"completed"===(null===P||void 0===P||null===(t=P.state)||void 0===t?void 0:t.state)}),(0,j.jsx)("div",{className:"address-options",children:L&&(null===kn||void 0===kn||null===(i=kn.data)||void 0===i?void 0:i.map((function(n){return(0,j.jsx)("div",{className:"option",onClick:function(){J("addressName",n.name),J("addressLocation",{latitude:n.latitude,longitude:n.longitude,name:n.name}),W({latitude:n.latitude,longitude:n.longitude,name:n.name}),B(!1)},children:n.name})})))})]})}),(0,j.jsx)(c.ZP,{item:!0,md:6,children:(0,j.jsx)(I.oi,{control:_?null===_||void 0===_?void 0:_.control:X,name:"houseNumber",rules:{required:!1},label:H("order.home_number"),disabled:"completed"===(null===P||void 0===P||null===(o=P.state)||void 0===o?void 0:o.state)})}),(0,j.jsx)(c.ZP,{item:!0,md:6,children:(0,j.jsx)(I.oi,{control:_?null===_||void 0===_?void 0:_.control:X,name:"entrance",rules:{required:!1},label:H("order.entrance"),disabled:"completed"===(null===P||void 0===P||null===(r=P.state)||void 0===r?void 0:r.state)})}),(0,j.jsx)(c.ZP,{item:!0,md:6,children:(0,j.jsx)(I.oi,{control:_?null===_||void 0===_?void 0:_.control:X,name:"floor",rules:{required:!1},label:H("order.floor"),disabled:"completed"===(null===P||void 0===P||null===(a=P.state)||void 0===a?void 0:a.state)})}),(0,j.jsx)(c.ZP,{item:!0,md:6,children:(0,j.jsx)(I.oi,{control:_?null===_||void 0===_?void 0:_.control:X,name:"apartmentNumber",rules:{required:!1},label:H("order.apartment_number"),disabled:"completed"===(null===P||void 0===P||null===(u=P.state)||void 0===u?void 0:u.state)})}),(0,j.jsx)(c.ZP,{item:!0,sm:12,children:(0,j.jsx)(I.oi,{control:_?null===_||void 0===_?void 0:_.control:X,name:"receiverFirstName",label:H("order.receiver"),disabled:"completed"===(null===P||void 0===P||null===(p=P.state)||void 0===p?void 0:p.state)})}),(0,j.jsx)(c.ZP,{item:!0,sm:12,children:(0,j.jsx)(I.sb,{control:_?null===_||void 0===_?void 0:_.control:X,name:"phoneNumber",label:H("common.phoneNumber"),disabled:"completed"===(null===P||void 0===P||null===(v=P.state)||void 0===v?void 0:v.state),onChange:Mn})}),(0,j.jsx)(c.ZP,{item:!0,sm:12,children:(0,j.jsx)(I.sp,{label:H("common.date"),control:_?null===_||void 0===_?void 0:_.control:X,name:"deliveryDate",minDate:z()(new Date),defaultValue:z()(new Date),disabled:"completed"===(null===P||void 0===P||null===(f=P.state)||void 0===f?void 0:f.state)})}),(0,j.jsx)(c.ZP,{item:!0,sm:12,className:"w-full",children:(0,j.jsx)(I.p7,{control:_?null===_||void 0===_?void 0:_.control:X,name:"paymentType",options:hn.G4,defaultValue:"cash",label:H("common.paymentType"),disabled:"completed"===(null===P||void 0===P||null===(h=P.state)||void 0===h?void 0:h.state),onChange:Mn})}),sn&&(0,j.jsx)(c.ZP,{item:!0,sm:12,children:(0,j.jsx)(zn,{control:_?null===_||void 0===_?void 0:_.control:X,name:"setCourier",label:H("common.courier"),optionsUrl:"courier/paging",value:pn,defaultValue:Pn,onChange:function(n){bn(n),Tn({courierId:n,_id:sn})},rules:{required:!1},disabled:"completed"===(null===P||void 0===P||null===(g=P.state)||void 0===g?void 0:g.state)})}),(0,j.jsxs)(c.ZP,{item:!0,sm:12,children:[(0,j.jsx)("label",{className:"custom-label",children:H("common.description")}),(0,j.jsx)(fn.Z,{minRows:3,value:null===_||void 0===_?void 0:_.watch("comment"),onChange:function(n){var e=n.target.value;_?null===_||void 0===_||_.setValue("comment",e):J("comment",e)},style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #ccc",fontSize:"1rem"}})]})]}),!sn&&(0,j.jsxs)("div",{className:"info",children:[(0,j.jsxs)("div",{className:"item",children:[(0,j.jsxs)("span",{className:"key",children:[H("order.allProducts"),":"]}),(0,j.jsxs)("span",{className:"value",children:[(0,A.Y)((null===Dn||void 0===Dn||null===(b=Dn.data)||void 0===b?void 0:b.itemPrice)||0)," ",(0,ln.get)(yn,"currency","uzs")]})]}),(0,j.jsxs)("div",{className:"item",children:[(0,j.jsxs)("span",{className:"key",children:[H("settings.discounts"),":"]}),(0,j.jsxs)("span",{className:"value",children:[(0,A.Y)((null===Dn||void 0===Dn||null===(y=Dn.data)||void 0===y?void 0:y.discount)||0)," ",(0,ln.get)(yn,"currency","uzs")]})]}),(0,j.jsxs)("div",{className:"item",children:[(0,j.jsxs)("span",{className:"key",children:[H("order.deliveryPrice"),":"]}),(0,j.jsxs)("span",{className:"value",children:[(0,A.Y)((null===Dn||void 0===Dn||null===(k=Dn.data)||void 0===k?void 0:k.deliveryPrice)||0)," ",(0,ln.get)(yn,"currency","uzs")]})]}),(0,j.jsxs)("div",{className:"item",children:[(0,j.jsxs)("span",{className:"key",children:[H("order.totalPrice"),":"]}),(0,j.jsxs)("span",{className:"value",children:[(0,A.Y)((null===Dn||void 0===Dn||null===(w=Dn.data)||void 0===w?void 0:w.totalPrice)||0)," ",(0,ln.get)(yn,"currency","uzs")]})]})]}),!sn&&(0,j.jsx)(I.c7,{variant:"contained",title:H("order.formalization"),className:"submit-btn",type:"submit",disabled:"loading"===In})]}),(0,j.jsx)(I.u_,{setOpen:F,open:Y,children:(0,j.jsx)(xn,{children:(0,j.jsxs)(c.ZP,{container:!0,height:"100%",children:[(0,j.jsx)(c.ZP,{item:!0,md:6,children:(0,j.jsxs)("div",{className:"modal-form",children:[(0,j.jsxs)("div",{className:"title",children:[(0,j.jsx)("span",{onClick:function(){return F(!1)},children:(0,j.jsx)(x.qg,{})}),(0,j.jsx)("h2",{children:H("order.add_new_address")})]}),(0,j.jsxs)(c.ZP,{container:!0,spacing:2,children:[(0,j.jsxs)(c.ZP,{item:!0,md:12,position:"relative",children:[(0,j.jsx)(I.oi,{control:_?_.control:X,name:"addressName",placeholder:H("order.shipping_address"),searchIcon:!0,onCustomChange:function(n){Q(n)}}),(0,j.jsx)("div",{className:"address-options",children:L&&(null===kn||void 0===kn||null===(S=kn.data)||void 0===S?void 0:S.map((function(n){return(0,j.jsx)("div",{className:"option",onClick:function(){J("addressName",n.name),J("addressLocation",{latitude:n.latitude,longitude:n.longitude,name:n.name}),W({latitude:n.latitude,longitude:n.longitude,name:n.name}),B(!1)},children:n.name})})))})]}),(0,j.jsx)(c.ZP,{item:!0,md:6,children:(0,j.jsx)(I.oi,{control:_?null===_||void 0===_?void 0:_.control:X,name:"houseNumber",rules:{required:!1},label:H("order.home_number")})}),(0,j.jsx)(c.ZP,{item:!0,md:6,children:(0,j.jsx)(I.oi,{control:_?null===_||void 0===_?void 0:_.control:X,name:"entrance",rules:{required:!1},label:H("order.entrance")})}),(0,j.jsx)(c.ZP,{item:!0,md:6,children:(0,j.jsx)(I.oi,{control:_?null===_||void 0===_?void 0:_.control:X,name:"floor",rules:{required:!1},label:H("order.floor")})}),(0,j.jsx)(c.ZP,{item:!0,md:6,children:(0,j.jsx)(I.oi,{control:_?null===_||void 0===_?void 0:_.control:X,name:"apartmentNumber",label:H("order.apartment_number"),rules:{required:!1}})})]}),(0,j.jsx)(I.c7,{title:H("FORMDRAWER.SAVE"),variant:"contained",color:"success",className:"save-btn",onClick:function(){var n=nn("addressLocation");n&&n.latitude&&n.longitude?F(!1):gn.Am.error("Manzil noto'g'ri kiritilgan yoki xaritada topilmadi!")}})]})}),(0,j.jsx)(c.ZP,{item:!0,md:6,children:(0,j.jsx)("div",{className:"map",children:(0,j.jsx)(jn,{getCoordinate:W,center:nn("addressLocation"),order:P})})})]})})})]})},_n=function(){var n=(0,N.useState)([]),e=(0,s.Z)(n,2),t=e[0],i=e[1];return(0,j.jsx)(nn,{children:(0,j.jsxs)(c.ZP,{container:!0,spacing:3,children:[(0,j.jsx)(c.ZP,{item:!0,md:8,children:(0,j.jsx)(pn,{basketItems:t,setBasketItems:i})}),(0,j.jsx)(c.ZP,{item:!0,md:4,children:(0,j.jsx)(An,{basketItems:t})})]})})},Pn=g.default.div(wn||(wn=(0,h.Z)(["\n  padding: 10px 0;\n  .top {\n    display: flex;\n    align-items: center;\n    width: 100%;\n    .state-select {\n      min-width: 180px;\n      margin-top: -3px;\n      div {\n        width: 100% !important;\n      }\n      margin-right: 15px;\n    }\n    .payment-type {\n      display: flex;\n      align-items: center;\n      padding: 4px 12px;\n      border-radius: 12px;\n      background: #fff;\n      width: 100%;\n      .type {\n        margin-left: 11px;\n        span {\n          color: #999;\n          font-size: 12px;\n          font-weight: 500;\n        }\n        h4 {\n          font-weight: 500;\n          font-size: 15px;\n        }\n      }\n      .state {\n        margin-left: auto;\n        color: #eb5757;\n        font-size: 15px;\n      }\n    }\n  }\n"]))),En=g.default.div(Sn||(Sn=(0,h.Z)(["\n  border-radius: 12px;\n  background: #fff;\n  padding: 20px;\n  margin-top: 24px;\n  .steps {\n    position: relative;\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    padding-bottom: 20px;\n    border-bottom: 1px dashed #e9e9e9;\n    .icon {\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      width: 56px;\n      height: 56px;\n      border-radius: 50%;\n      background-color: #e9e9e9;\n      &.active {\n        background-color: #f7e14b;\n        .line {\n          background: #f7e14b;\n        }\n        svg path {\n          fill: #000;\n        }\n      }\n      .line {\n        position: absolute;\n        width: 21.5%;\n        height: 4px;\n        background: #f5f5f5;\n        transform: translateX(-71%);\n      }\n    }\n  }\n  .products {\n    min-height: 450px;\n    display: flex;\n    flex-direction: column;\n    justify-content: space-between;\n\n    .product_info {\n      width: 100%;\n      display: flex;\n      flex-direction: column;\n      gap: 12px;\n\n      li {\n        list-style: none;\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n        font-size: 18px;\n\n        span {\n          color: #999;\n        }\n\n        .main {\n          color: #000;\n          font-weight: 600;\n        }\n      }\n    }\n  }\n  .product {\n    display: flex;\n    align-items: center;\n    padding: 16px 0;\n    border-bottom: 1px dashed #e9e9e9;\n    &:last-of-type {\n      border-bottom: none;\n    }\n    .default-image {\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      width: 48px;\n      height: 48px;\n      border-radius: 12px;\n      background: #f3f3f8;\n      margin-right: 12px;\n      overflow: hidden;\n      img {\n        width: 100%;\n        height: 100%;\n        object-fit: cover;\n      }\n      svg {\n        width: 20px;\n        height: 20px;\n      }\n    }\n    .info {\n      .name {\n        display: block;\n        color: #454545;\n        font-size: 14px;\n        font-weight: 500;\n        margin-bottom: 5px;\n      }\n      .amount-price {\n        font-size: 14px;\n        font-weight: 700;\n      }\n    }\n    .action {\n      display: flex;\n      margin-left: auto;\n      span {\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        width: 36px;\n        height: 36px;\n        border-radius: 50%;\n        background: #f3f3f8;\n        cursor: pointer;\n        &:first-of-type {\n          margin-right: 16px;\n          svg {\n            width: 22px;\n            height: 22px;\n          }\n        }\n      }\n    }\n  }\n"]))),Tn=t(86657),Ln=t(84544),Bn=function(n){var e,t=n.formStore,i=n.state,o=n.order,r=(0,N.useState)(0),a=(0,s.Z)(r,2),d=a[0],c=a[1],u=(0,N.useState)(),m=(0,s.Z)(u,2),p=m[0],v=m[1],f=(0,Z.$G)().t,h=(0,dn.Z)().state.data,g=(0,tn.Dq)({control:null===t||void 0===t?void 0:t.control,name:"items"}),b=g.fields,y=g.remove,k=g.update,w="created"===i?1:"inProcess"===i?2:"inDelivery"===i?3:"completed"===i?4:0,S="combined"===(null===o||void 0===o?void 0:o.orderStructureType)&&(null===o||void 0===o?void 0:o.stores)&&o.stores.length>1;return(0,j.jsxs)(En,{children:[(0,j.jsxs)("div",{className:"steps",style:{border:"none"},children:[(0,j.jsx)("span",{className:"icon ".concat(w&&"active"),children:(0,j.jsx)(x.Ye,{})}),(0,j.jsxs)("span",{className:"icon ".concat(w>1&&"active"),children:[(0,j.jsx)(x.T3,{}),(0,j.jsx)("div",{className:"line"})]}),(0,j.jsxs)("span",{className:"icon ".concat(w>2&&"active"),children:[(0,j.jsx)(x.Yw,{}),(0,j.jsx)("div",{className:"line"})]}),(0,j.jsxs)("span",{className:"icon ".concat(w>3&&"active"),children:[(0,j.jsx)(x.U6,{}),(0,j.jsx)("div",{className:"line"})]})]}),(0,j.jsxs)("div",{className:"steps",children:[(0,j.jsx)("span",{className:"".concat(w&&"active"),children:(0,ln.get)(o,"createdAt",0)?new Date(new Date(o.createdAt).getTime()+18e6).toISOString().slice(11,19):""}),(0,j.jsx)("span",{className:"".concat(w>1&&"active"),children:(0,ln.get)(o,"acceptedAt",0)?new Date(new Date(o.acceptedAt).getTime()+18e6).toISOString().slice(11,19):""}),(0,j.jsx)("span",{className:"".concat(w>2&&"active"),children:(0,ln.get)(o,"inDeliveryAt",0)?new Date(new Date(o.inDeliveryAt).getTime()+18e6).toISOString().slice(11,19):""}),(0,j.jsx)("span",{className:"".concat(w>3&&"active"),children:(0,ln.get)(o,"completedAt",0)?new Date(new Date(o.completedAt).getTime()+18e6).toISOString().slice(11,19):""})]}),(0,j.jsxs)("div",{className:"products",children:[S?(0,j.jsx)("div",{children:o.stores.map((function(n,e){var t,o,r;return(0,j.jsxs)("div",{style:{marginBottom:"24px",padding:"16px",border:"1px solid #e0e0e0",borderRadius:"8px"},children:[(0,j.jsxs)("div",{style:{marginBottom:"16px",paddingBottom:"12px",borderBottom:"2px solid #1976d2"},children:[(0,j.jsx)("h4",{style:{margin:0,fontSize:"18px",fontWeight:600,color:"#1976d2"},children:n.storeName}),(null===(t=n.store)||void 0===t?void 0:t.addressName)&&(0,j.jsxs)("p",{style:{margin:"4px 0 0 0",fontSize:"14px",color:"#666"},children:["\ud83d\udccd ",n.store.addressName]}),(null===(o=n.store)||void 0===o?void 0:o.phoneNumber)&&(0,j.jsxs)("p",{style:{margin:"4px 0 0 0",fontSize:"14px",color:"#666"},children:["\ud83d\udcde ",n.store.phoneNumber]})]}),(0,j.jsx)("div",{children:null===(r=n.items)||void 0===r?void 0:r.map((function(n,e){var t,o,r,a,d=null===b||void 0===b?void 0:b.find((function(e){return e.productId===n.productId}));return d?(0,j.jsxs)("div",{className:"product",children:[(0,j.jsx)("span",{className:"default-image",children:null!==(t=d.product)&&void 0!==t&&t.mainImage?(0,j.jsx)("img",{src:"http://localhost:3003/v1/"+d.product.mainImage.url,alt:"product"}):(0,j.jsx)(x.Q_,{})}),(0,j.jsxs)("div",{className:"info",children:[(0,j.jsxs)("div",{className:"flex",children:[(0,j.jsx)("span",{className:"name",children:null===d||void 0===d||null===(o=d.product)||void 0===o?void 0:o.name}),(null===d||void 0===d||null===(r=d.attributes)||void 0===r?void 0:r.length)>0&&(0,j.jsx)("div",{className:"variant-info flex",children:null===d||void 0===d||null===(a=d.attributes)||void 0===a?void 0:a.map((function(n,e){return(0,j.jsx)("div",{className:"variant-item flex",children:(0,j.jsx)("span",{className:"name ml-1",children:n.attributeItem})},e)}))})]}),(0,j.jsxs)("div",{className:"amount-price",children:[d.amount," x ",(0,A.Y)(d.price)," ",(0,ln.get)(h,"currency","uzs")]})]}),"completed"!==i&&"cancelled"!==i&&(0,j.jsx)("div",{className:"action",children:"inDelivery"!==i&&(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)("span",{onClick:function(){var e=b.findIndex((function(e){return e.productId===n.productId}));-1!==e&&c(e+1)},children:(0,j.jsx)(x.pJ,{})}),(0,j.jsx)("span",{onClick:function(){var e=b.findIndex((function(e){return e.productId===n.productId}));-1!==e&&v((0,l.Z)((0,l.Z)({},d),{},{index:e}))},children:(0,j.jsx)(Tn.Z,{})})]})})]},e):null}))}),(0,j.jsx)("div",{style:{marginTop:"12px",paddingTop:"12px",borderTop:"1px solid #e0e0e0"},children:(0,j.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[(0,j.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"14px"},children:[(0,j.jsx)("span",{style:{fontWeight:500},children:"Subtotal:"}),(0,j.jsxs)("span",{style:{fontWeight:500},children:[(0,A.Y)(n.subtotal)," ",(0,ln.get)(h,"currency","uzs")]})]}),n.promocodePrice>0&&(0,j.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"14px",color:"#28a745"},children:[(0,j.jsx)("span",{children:"Promokod:"}),(0,j.jsxs)("span",{children:["-",(0,A.Y)(n.promocodePrice)," ",(0,ln.get)(h,"currency","uzs")]})]}),n.usedBalance>0&&(0,j.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"14px",color:"#dc3545"},children:[(0,j.jsx)("span",{children:"Balance:"}),(0,j.jsxs)("span",{children:["-",(0,A.Y)(n.usedBalance)," ",(0,ln.get)(h,"currency","uzs")]})]}),(0,j.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"14px",fontWeight:600,marginTop:"4px",paddingTop:"4px",borderTop:"1px solid #e0e0e0"},children:[(0,j.jsx)("span",{children:"Do'kon jami:"}),(0,j.jsxs)("span",{style:{color:"#1976d2"},children:[(0,A.Y)((n.subtotal||0)-(n.promocodePrice||0)-(n.usedBalance||0))," ",(0,ln.get)(h,"currency","uzs")]})]})]})})]},e)}))}):(0,j.jsx)("div",{children:null===b||void 0===b?void 0:b.map((function(n,e){var t,o,r;return(0,j.jsxs)("div",{className:"product",children:[(0,j.jsx)("span",{className:"default-image",children:n.product.mainImage?(0,j.jsx)("img",{src:"http://localhost:3003/v1/"+n.product.mainImage.url,alt:"product"}):(0,j.jsx)(x.Q_,{})}),(0,j.jsxs)("div",{className:"info",children:[(0,j.jsxs)("div",{className:"flex",children:[(0,j.jsx)("span",{className:"name",children:null===n||void 0===n||null===(t=n.product)||void 0===t?void 0:t.name}),(null===n||void 0===n||null===(o=n.attributes)||void 0===o?void 0:o.length)>0&&(0,j.jsx)("div",{className:"variant-info flex",children:null===n||void 0===n||null===(r=n.attributes)||void 0===r?void 0:r.map((function(n,e){return(0,j.jsx)("div",{className:"variant-item flex",children:(0,j.jsx)("span",{className:"name ml-1",children:n.attributeItem})},e)}))})]}),(0,j.jsxs)("div",{className:"amount-price",children:[n.amount," x ",(0,A.Y)(n.price)," ",(0,ln.get)(h,"currency","uzs")]})]}),"completed"!==i&&"cancelled"!==i&&(0,j.jsx)("div",{className:"action",children:"inDelivery"!==i&&(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)("span",{onClick:function(){return c(e+1)},children:(0,j.jsx)(x.pJ,{})}),(0,j.jsx)("span",{onClick:function(){return v((0,l.Z)((0,l.Z)({},n),{},{index:e}))},children:(0,j.jsx)(Tn.Z,{})})]})})]})}))}),(0,j.jsxs)("ul",{className:"product_info",children:[(0,j.jsxs)("li",{children:[(0,j.jsx)("span",{children:"Barcha mahsulotlar:"})," ",(0,j.jsxs)("b",{children:[(0,A.Y)((0,ln.get)(o,"itemPrice",0))," ",(0,ln.get)(h,"currency","uzs")]})]}),(0,j.jsxs)("li",{children:[(0,j.jsx)("span",{children:"Yetkazib berish:"}),(0,j.jsxs)("b",{children:[(0,A.Y)((0,ln.get)(o,"deliveryPrice",0))," ",(0,ln.get)(h,"currency","uzs")]})]}),(0,j.jsxs)("li",{children:[(0,j.jsx)("span",{children:"Foydalanilgan balans:"}),(0,j.jsxs)("b",{children:["-",(0,A.Y)((0,ln.get)(o,"usedBalance",0))," ",(0,ln.get)(h,"currency","uzs")]})]}),0!==(0,ln.get)(o,"discount")?(0,j.jsxs)("li",{children:[(0,j.jsxs)("span",{children:[f("common.discount"),":"]}),(0,j.jsxs)("b",{children:["-",(0,A.Y)((0,ln.get)(o,"discount",""))," ",(0,ln.get)(h,"currency","uzs")]})]}):"",(0,ln.get)(o,"promocode.amount","")&&(0,j.jsxs)("li",{children:[(0,j.jsx)("span",{children:"Promokod:"}),(0,j.jsxs)("b",{children:["-",(0,A.Y)((0,ln.get)(o,"promocode.amount",0))," ",(0,ln.get)(h,"currency","uzs")]})]}),(0,j.jsxs)("li",{children:[(0,j.jsx)("span",{className:"main",children:"Umumiy:"})," ",(0,j.jsxs)("b",{children:[(0,A.Y)((0,ln.get)(o,"totalPrice",0))," ",(0,ln.get)(h,"currency","uzs")]})]})]})]}),(0,j.jsx)(Ln.Z,{open:d,setOpen:c,confirmFn:function(){y(d-1),c(0)}}),(0,j.jsx)(I.u_,{setOpen:v,open:!!p,children:(0,j.jsxs)("div",{className:"custom-modal",children:[(0,j.jsxs)("span",{className:"d-block mb-2",children:[null===p||void 0===p?void 0:p.product.name," (",f("common.residue"),":"," ",(null===p||void 0===p||null===(e=p.product)||void 0===e?void 0:e.inStock)||0,")"]}),(0,j.jsx)(I.oi,{control:null===t||void 0===t?void 0:t.control,name:"items.".concat(null===p||void 0===p?void 0:p.index,".amount"),type:"number",onCustomChange:function(n){n.floatValue<=p.product.inStock&&k(null===p||void 0===p?void 0:p.index,(0,l.Z)((0,l.Z)({},p),{},{amount:(null===n||void 0===n?void 0:n.floatValue)||0}))}}),(0,j.jsx)(I.c7,{title:f("general.save"),fullWidth:!0,variant:"contained",className:"mt-3",onClick:function(){t.watch("items.".concat(null===p||void 0===p?void 0:p.index,".amount"))<=p.product.inStock?v(null):gn.Am.warn("Max: ".concat(p.product.inStock))}})]})})]})},Dn=g.default.div(In||(In=(0,h.Z)(["\n  max-height: calc(100vh - 110px);\n  overflow: auto;\n  .card {\n    padding: 16px 20px;\n    border-radius: 12px;\n    background: #fff;\n    box-shadow: 0px 0px 4px 0px rgba(0, 0, 0, 0.07);\n    margin-bottom: 16px;\n    &:last-of-type {\n      margin-bottom: 0;\n    }\n    .title {\n      font-size: 18px;\n      border-bottom: 1px dashed #e9e9e9;\n      padding-bottom: 10px;\n      margin-bottom: 16px;\n    }\n    .info {\n      display: flex;\n      align-items: center;\n      .image {\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        background-color: #f3f3f8;\n        width: 56px;\n        height: 56px;\n        border-radius: 50%;\n        margin-right: 12px;\n        overflow: hidden;\n        img {\n          width: 100%;\n          height: 100%;\n          object-fit: cover;\n        }\n        svg {\n          width: 25px;\n          height: 25px;\n        }\n      }\n      .phone {\n        color: #999;\n        font-size: 14px;\n      }\n    }\n    .car {\n      display: flex;\n      align-items: center;\n      justify-content: space-between;\n      border-top: 1px dashed #e9e9e9;\n      margin-top: 16px;\n      padding-top: 16px;\n      .number {\n        padding: 3px 7px;\n        font-weight: 600;\n        font-size: 15px;\n        border-radius: 4px;\n        background: #f5f5f5;\n      }\n    }\n  }\n\n  .comment_boxes {\n    display: flex;\n    align-items: flex-start;\n    flex-wrap: wrap;\n    gap: 10px;\n\n    .comment_box {\n      width: 76px;\n      background-color: inherit;\n\n      .comment_img {\n        display: flex;\n        justify-content: center;\n        align-items: center;\n        box-shadow: 0px 0px 12px -2px rgba(0, 0, 0, 0.12);\n        border-radius: 6px;\n        width: 100%;\n        height: 62px;\n\n        img {\n          width: 80%;\n          object-fit: cover;\n        }\n      }\n\n      p {\n        display: inline-block;\n        font-size: 10px !important;\n        font-weight: 600;\n        color: #000;\n        width: 100%;\n        white-space: nowrap;\n        overflow: hidden !important;\n        text-overflow: ellipsis;\n      }\n    }\n  }\n"]))),Mn=t(4729),Yn=function(n){var e,t,i,o,r,a,d,l,s=n.formStore,c=n.order;return(0,j.jsxs)(Dn,{children:[(0,j.jsx)(An,{order:c,basketItems:[],formStore:s}),(0,j.jsxs)("div",{className:"card mt-3",children:[(0,j.jsx)("h4",{className:"title",children:"Mijoz"}),(0,j.jsxs)("div",{className:"info border-bottom mb-3 pb-3",children:[(0,j.jsx)("div",{className:"image",children:null!==c&&void 0!==c&&null!==(e=c.customer)&&void 0!==e&&e.image?(0,j.jsx)("img",{src:"https://picsum.photos/100",alt:""}):(0,j.jsx)(x.Q_,{})}),(0,j.jsxs)("div",{children:[(0,j.jsx)("h4",{className:"name",children:(0,ln.get)(c,"customer.firstName","")+" "+(0,ln.get)(c,"customer.lastName","")}),(0,j.jsx)("span",{className:"phone",children:null===c||void 0===c||null===(t=c.customer)||void 0===t?void 0:t.phoneNumber})]})]}),"completed"===(0,ln.get)(c,"state.state","")&&(0,j.jsxs)("div",{children:[(0,j.jsx)("h3",{className:"mb-2",children:"Reyting va izoh"}),(0,ln.get)(c,"rateComment","")&&(0,j.jsx)("p",{className:"border-bottom pb-3",children:(0,ln.get)(c,"rateComment","")}),(0,j.jsx)("div",{className:"py-3 border-bottom",children:(0,j.jsx)(Mn.Z,{name:"read-only",value:(0,ln.get)(c,"rate",5),readOnly:!0})}),(0,j.jsx)("div",{className:"comment_boxes pt-3",children:(0,ln.get)(c,"rateComments",[]).map((function(n){return(0,j.jsxs)("div",{className:"comment_box",children:[(0,j.jsx)("div",{className:"comment_img",children:(0,j.jsx)("img",{src:"http://localhost:3003/v1"+(0,ln.get)(n,"image.url",""),alt:"rate"})}),(0,j.jsx)("p",{children:(0,ln.get)(n,"title","")})]})}))})]})]}),c.courier&&(0,j.jsxs)("div",{className:"card",children:[(0,j.jsx)("h4",{className:"title",children:"Kuryer"}),(0,j.jsxs)("div",{className:"info",children:[(0,j.jsx)("div",{className:"image",children:null!==c&&void 0!==c&&null!==(i=c.courier)&&void 0!==i&&i.image?(0,j.jsx)("img",{src:"http://localhost:3003/v1/"+(null===c||void 0===c||null===(o=c.courier)||void 0===o||null===(r=o.image)||void 0===r?void 0:r.url),alt:""}):(0,j.jsx)("span",{children:(0,j.jsx)(x.Q_,{})})}),(0,j.jsxs)("div",{children:[(0,j.jsxs)("h4",{className:"name",children:[(0,ln.get)(c,"courier.firstName","")," ",(0,ln.get)(c,"courier.lastName","")]}),(0,j.jsx)("span",{className:"phone",children:(0,ln.get)(c,"courier.phoneNumber","")})]})]}),(0,j.jsxs)("div",{className:"car",children:[(0,j.jsx)("span",{className:"name",children:(0,ln.get)(c,"courier.carBrand","")}),(0,j.jsx)("span",{className:"number",children:(0,ln.get)(c,"courier.carNumber","")})]})]}),(null===c||void 0===c?void 0:c.employee)&&(0,j.jsxs)("div",{className:"card",children:[(0,j.jsx)("h4",{className:"title",children:"Xodim"}),(0,j.jsxs)("div",{className:"info",children:[(0,j.jsx)("div",{className:"image",children:null!==c&&void 0!==c&&null!==(a=c.employee)&&void 0!==a&&a.image?(0,j.jsx)("img",{src:"http://localhost:3003/v1/"+(null===c||void 0===c||null===(d=c.employee)||void 0===d||null===(l=d.image)||void 0===l?void 0:l.url),alt:""}):(0,j.jsx)("span",{children:(0,j.jsx)(x.Q_,{})})}),(0,j.jsxs)("div",{children:[(0,j.jsxs)("h4",{className:"name",children:[(0,ln.get)(c,"employee.firstName","")," ",(0,ln.get)(c,"employee.lastName","")]}),(0,j.jsx)("span",{className:"phone",children:(0,ln.get)(c,"employee.phoneNumber","")})]})]})]}),"combined"===(null===c||void 0===c?void 0:c.orderStructureType)&&null!==c&&void 0!==c&&c.stores&&c.stores.length>1?c.stores.map((function(n,e){var t,i,o,r,a;return(0,j.jsxs)("div",{className:"card",style:{marginTop:e>0?"16px":"0"},children:[(0,j.jsxs)("h4",{className:"title",children:["Do'kon ",e+1,": ",n.storeName]}),(0,j.jsx)("div",{className:"info",children:(0,j.jsxs)("div",{children:[(0,j.jsx)("h4",{className:"name",children:(0,ln.get)(n,"store.name",n.storeName)}),(0,ln.get)(n,"store.phoneNumber","")&&(0,j.jsxs)("span",{className:"phone",children:["\ud83d\udcde ",(0,ln.get)(n,"store.phoneNumber","")]}),(0,ln.get)(n,"store.addressName","")&&(0,j.jsxs)("span",{className:"phone",style:{display:"block",marginTop:"4px"},children:["\ud83d\udccd ",(0,ln.get)(n,"store.addressName","")]}),(0,j.jsxs)("div",{style:{marginTop:"8px",paddingTop:"8px",borderTop:"1px solid #e0e0e0"},children:[(0,j.jsxs)("span",{style:{fontSize:"14px",fontWeight:500},children:["Mahsulotlar: ",(null===(t=n.items)||void 0===t?void 0:t.length)||0," ta"]}),(0,j.jsx)("br",{}),(0,j.jsxs)("span",{style:{fontSize:"14px",fontWeight:500},children:["Subtotal: ",(null===(i=n.subtotal)||void 0===i?void 0:i.toLocaleString())||0," ",(0,ln.get)(c,"currency","uzs")]}),n.promocodePrice>0&&(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)("br",{}),(0,j.jsxs)("span",{style:{fontSize:"14px",fontWeight:500,color:"#28a745"},children:["Promokod: -",(null===(o=n.promocodePrice)||void 0===o?void 0:o.toLocaleString())||0," ",(0,ln.get)(c,"currency","uzs")]})]}),n.usedBalance>0&&(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)("br",{}),(0,j.jsxs)("span",{style:{fontSize:"14px",fontWeight:500,color:"#dc3545"},children:["Balance: -",(null===(r=n.usedBalance)||void 0===r?void 0:r.toLocaleString())||0," ",(0,ln.get)(c,"currency","uzs")]})]}),(0,j.jsx)("br",{}),(0,j.jsxs)("span",{style:{fontSize:"14px",fontWeight:500,color:"#1976d2"},children:["Jami: ",(null===(a=(n.subtotal||0)-(n.promocodePrice||0)-(n.usedBalance||0))||void 0===a?void 0:a.toLocaleString())||0," ",(0,ln.get)(c,"currency","uzs")]})]})]})})]},e)})):(null===c||void 0===c?void 0:c.store)&&(0,j.jsxs)("div",{className:"card",children:[(0,j.jsx)("h4",{className:"title",children:"Do'kon"}),(0,j.jsx)("div",{className:"info",children:(0,j.jsxs)("div",{children:[(0,j.jsx)("h4",{className:"name",children:(0,ln.get)(c,"store.name","")}),(0,ln.get)(c,"store.phoneNumber","")&&(0,j.jsx)("span",{className:"phone",children:(0,ln.get)(c,"store.phoneNumber","")}),(0,ln.get)(c,"store.addressName","")&&(0,j.jsx)("span",{className:"phone",children:(0,ln.get)(c,"store.addressName","")})]})})]})]})},Fn=t(59434),Vn=function(){var n,e,t,i,o,r,a=(0,d.UO)().id,u=(0,Z.$G)().t,p=(0,tn.cI)(),v=p.setValue,x=p.reset,f=p.handleSubmit,h=(p.control,(0,w.C)((function(n){return n.SocketState.render}))),g=(0,Fn.I0)(),b=localStorage.getItem("i18nextLng")||"uz",y=(0,N.useState)(""),k=(0,s.Z)(y,2),S=(k[0],k[1],(0,m.h_)("order/get-by-id/".concat(a),{},{enabled:!!a})),C=S.data,z=S.status,A=S.refetch,_=null===C||void 0===C?void 0:C.data,P="completed"===(null===_||void 0===_||null===(n=_.state)||void 0===n?void 0:n.state),T="cancelled"===(null===_||void 0===_||null===(e=_.state)||void 0===e?void 0:e.state),L=(0,m.h_)("order-state/get-all",{},{suspense:!1}),B=L.data,D=(L.refetch,(0,m.uC)("order/state/".concat(null===_||void 0===_?void 0:_._id),"put",{onSuccess:function(){A(),gn.Am.success(u("general.success"))}}).mutate),M=(0,m.uC)("order/update","put").mutate;(0,N.useEffect)((function(){var n;"success"===z&&(v("items",null===_||void 0===_?void 0:_.items),x({items:null===_||void 0===_?void 0:_.items,addressName:null===_||void 0===_?void 0:_.addressName,addressLocation:null===_||void 0===_?void 0:_.addressLocation,customer:(0,ln.get)(_,"customer.firstName","")+" "+(0,ln.get)(_,"customer.lastName",""),receiverFirstName:(0,ln.get)(_,"receiverCustomer.firstName",""),phoneNumber:null===_||void 0===_||null===(n=_.customer)||void 0===n?void 0:n.phoneNumber,paymentType:null===_||void 0===_?void 0:_.paymentType,houseNumber:null===_||void 0===_?void 0:_.houseNumber,entrance:null===_||void 0===_?void 0:_.entrance,floor:null===_||void 0===_?void 0:_.floor,deliveryDate:(0,ln.get)(_,"deliveryDate",""),apartmentNumber:null===_||void 0===_?void 0:_.apartmentNumber}),setTimeout((function(){return v("comment",null===_||void 0===_?void 0:_.comment)}),0))}),[z]);var Y=f((function(n){var e,t=(0,l.Z)((0,l.Z)({},n),{},{items:null===n||void 0===n||null===(e=n.items)||void 0===e?void 0:e.map((function(n){var e;return{productId:n.productId,amount:n.amount,attributes:null===n||void 0===n||null===(e=n.attributes)||void 0===e?void 0:e.map((function(n){return{attributeId:null===n||void 0===n?void 0:n.attributeId,attributeItem:null===n||void 0===n?void 0:n.attributeItem}}))}})),_id:null===_||void 0===_?void 0:_._id,cardId:null===_||void 0===_?void 0:_._id});M(t)})),F=null===B||void 0===B||null===(t=B.data)||void 0===t?void 0:t.findIndex((function(n){return n._id===(null===_||void 0===_?void 0:_.state._id)}));return(0,N.useEffect)((function(){h&&(A(),g((0,E.zm)(!1)))}),[h]),(0,j.jsx)(Pn,{children:(0,j.jsxs)(c.ZP,{container:!0,columnSpacing:3,children:[(0,j.jsxs)(c.ZP,{item:!0,md:8,children:[(0,j.jsxs)("div",{className:"top",children:[!T&&!P&&(0,j.jsxs)("div",{className:"d-flex",children:[(0,j.jsx)(I.c7,{title:null===B||void 0===B||null===(i=B.data[F+1])||void 0===i||null===(o=i.name)||void 0===o?void 0:o[b],variant:"contained",className:"me-3",onClick:function(){var n;return D({stateId:null===B||void 0===B||null===(n=B.data[F+1])||void 0===n?void 0:n._id,_id:null===_||void 0===_?void 0:_._id,position:1})}}),(0,j.jsx)(I.c7,{title:"Bekor qilish",variant:"outlined",color:"error",className:"me-3",onClick:function(){return D({stateId:null===B||void 0===B?void 0:B.data[(null===B||void 0===B?void 0:B.data.length)-1]._id,_id:null===_||void 0===_?void 0:_._id,position:1})}})]}),(0,j.jsxs)("div",{className:"payment-type",children:[(0,j.jsx)("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAG6SURBVHgB7ZPLTsJAFIb/Di0gpVgRr5h4i9G4VOPCxJ2P4cYn8Cl8DXc+h4kP4MoYDQnRECOIhUJLbaEXT4dQSCyyYMvfTDqXM9+cM+cMMNO0Ei7vrm9ZwCRMqQA+s+pmXWQQriAEYw2L6jyKCyps18RHswXNdGPtBPrAAoijk3nFhCT1N6RFGUfFE2wQzHH7c8KOi5JWwmu1AtfvkVsefrou2p2ViBEBF+fbWC/o0cLx2jmUpEobfdy/luB5Pi4O97Gb3wZLtFEzy9zOdgz+H0DZAFBQzQimplcJluf9t28NaUnEztIiGQvkeZavpyiCUMlkBopci/YyxEhNLUf95WyWoA20bRuSmOhfR0Lm4DjFAkeVy8zhdHsTpu3g+bM6yTweqDvDEAzyLLxHOZ0K88jV9SxKVOd/YKM1DEG3a7yFCqiiKloTXcr0weoKHILpTp2XEYf3LBhxWa7rOfiBADHh8fGD8YSzzQwKioLzvV2kKDGOb+GlVkZZ0+B6OTrNRceZg2kt/QWG0lrK6BDvX4+8DtepuG0K8UPXoRlhTcoYJ5EeyY0vYGucQaWp8zZJxGH0/izMNLV+ASXZrtTxzAUrAAAAAElFTkSuQmCC",alt:"money"}),(0,j.jsxs)("div",{className:"type",children:[(0,j.jsx)("span",{children:"To'lov turi"}),(0,j.jsx)("h4",{children:u("enum.".concat(null===_||void 0===_?void 0:_.paymentType))})]}),(0,j.jsx)("span",{className:"state",children:"cash"===(null===_||void 0===_?void 0:_.paymentType)&&"completed"===_.state.state||null!==_&&void 0!==_&&_.isPaid?"To'langan":"To'lanmagan"})]}),!P&&!T&&(0,j.jsx)(I.c7,{title:"Saqlash",variant:"contained",className:"ms-3",onClick:Y})]}),(0,j.jsx)(Bn,{formStore:p,state:null===_||void 0===_||null===(r=_.state)||void 0===r?void 0:r.state,order:_})]}),(0,j.jsx)(c.ZP,{item:!0,md:4,children:(0,j.jsx)(Yn,{formStore:p,order:_})})]})})},qn=function(){return(0,j.jsxs)(d.Z5,{children:[(0,j.jsx)(d.AW,{path:"table",element:(0,j.jsx)(L,{})}),(0,j.jsx)(d.AW,{path:"board",element:(0,j.jsx)($,{})}),(0,j.jsx)(d.AW,{path:"add",element:(0,j.jsx)(_n,{})}),(0,j.jsx)(d.AW,{path:":id",element:(0,j.jsx)(Vn,{})}),(0,j.jsx)(d.AW,{path:"*",element:(0,j.jsx)(d.Fg,{to:"/order/table",replace:!0})})]})}},30709:function(n,e,t){t.d(e,{Fv:function(){return a},G4:function(){return i},od:function(){return r},v5:function(){return o}});var i=[{_id:"cash",name:"Naqd",trans_key:"cash"}],o=[{_id:"percent",name:"Foiz",trans_key:"percent"},{_id:"amount",name:"Miqdor",trans_key:"amount"}],r=[{name:"functionality",key:"functionality",role:"role"},{name:"discounts",key:"discountOrder",role:"role"},{name:"bonus",key:"bonusOrder",role:"role"},{name:"premium_discounts",key:"premiumDiscountOrder",role:"role"},{name:"main_address",key:"mainAddress",role:"role"},{name:"website_conditions",key:"websiteConditions",role:"role"}],a=[{rate:5},{rate:4},{rate:3},{rate:2},{rate:1}]},90816:function(n,e,t){t.d(e,{Y:function(){return i}});var i=function(n){return n||0===n?(Math.round(100*(n+Number.EPSILON))/100).toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0}).replaceAll(","," "):""}}}]);
//# sourceMappingURL=30.fbd9f4f0.chunk.js.map