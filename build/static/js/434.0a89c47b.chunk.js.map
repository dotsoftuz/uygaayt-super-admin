{"version":3,"file":"static/js/434.0a89c47b.chunk.js","mappings":"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","sources":["pages/category/info/CategoryChildForm.tsx","pages/category/info/CategoryChild.tsx","pages/category/info/categoryChild.columns.tsx","utils/numberFormat.ts"],"sourcesContent":["import React, { useEffect } from \"react\";\nimport { Grid } from \"@mui/material\";\nimport { AutoCompleteForm, ImageInput, TextInput } from \"components\";\nimport { UseFormReturn } from \"react-hook-form\";\nimport { useApi, useApiMutation } from \"hooks/useApi/useApiHooks\";\nimport { useTranslation } from \"react-i18next\";\nimport useAllQueryParams from \"hooks/useGetAllQueryParams/useAllQueryParams\";\n\ninterface IBranchForm {\n  formStore: UseFormReturn<any>;\n  resetForm: () => void;\n  editingCategoryId?: any;\n  setRender?: React.Dispatch<React.SetStateAction<boolean>>;\n\n}\n\nconst CategoryChildForm: React.FC<IBranchForm> = ({\n  formStore,\n  resetForm,\n  editingCategoryId,\n  setRender,\n}) => {\n  const { t } = useTranslation();\n  const { control, handleSubmit, reset, setValue } = formStore;\n  const allParams = useAllQueryParams();\n\n\n  const { mutate, status } = useApiMutation<any>(\n    editingCategoryId\n      ? `category/update`\n      : \"category/create\",\n    editingCategoryId ? \"put\" : \"post\"\n  );\n\n  const { data: getByIdData, status: getByIdStatus } = useApi(`category/get-by-id/${editingCategoryId}`, {}, {\n    enabled: !!editingCategoryId,\n    suspense: false\n  })\n\n  const sumbit = (data: any) => {\n    mutate({\n      ...data,\n      imageId: data.imageId?._id,\n      _id: editingCategoryId,\n      parentId: allParams.parentId,\n      ...(editingCategoryId ? {} : { storeId: \"uygaayt\" }),\n    });\n  };\n\n  useEffect(() => {\n    if (status === \"success\") {\n      resetForm();\n      setRender?.(prev => !prev);\n    }\n  }, [status]);\n\n  useEffect(() => {\n    if (getByIdStatus === 'success') {\n      reset({\n        name: getByIdData.data.name,\n        imageId: getByIdData.data.image,\n      });\n    }\n  }, [getByIdStatus, getByIdData]);\n\n  return (\n    <div className=\"custom-drawer\">\n      <form id=\"category\" onSubmit={handleSubmit(sumbit)}>\n        <Grid container spacing={2}>\n          <Grid item md={12}>\n            <TextInput name=\"name.uz\" control={control} label={t(\"common.name\") + ' (Uz)'} />\n          </Grid>\n          <Grid item md={12}>\n            <TextInput name=\"name.ru\" control={control} label={t(\"common.name\") + ' (Ru)'} />\n          </Grid>\n          <Grid item md={12}>\n            <TextInput name=\"name.en\" control={control} label={t(\"common.name\") + ' (En)'} />\n          </Grid>\n          <Grid item md={12}>\n            <ImageInput\n              control={control}\n              setValue={setValue}\n              name=\"imageId\"\n              rules={{ required: false }}\n              accept=\".png, .jpg, .jpeg\"\n            />\n          </Grid>\n        </Grid>\n      </form>\n    </div>\n  );\n};\n\nexport default CategoryChildForm;\n","import { DragTable, FormDrawer, Table } from \"components\";\nimport { useCategoryCol, useCategoryColumns } from \"./categoryChild.columns\"\nimport { useAppDispatch } from \"store/storeHooks\";\nimport { setOpenDrawer } from \"components/elements/FormDrawer/formdrawer.slice\";\nimport { useTranslation } from \"react-i18next\";\nimport { useState } from \"react\";\nimport CategoryForm from \"../components/CategoryForm\";\nimport { useForm } from \"react-hook-form\";\nimport WarningModal from \"components/common/WarningModal/WarningModal\";\nimport { useRoleManager } from \"services/useRoleManager\";\nimport useAllQueryParams from \"hooks/useGetAllQueryParams/useAllQueryParams\";\nimport CategoryChildForm from \"./CategoryChildForm\";\n\nconst CategoryChild = () => {\n  const [render, setRender] = useState<boolean>(false);\n  // const columns = useCategoryColumns();\n  const [editingCategoryId, setEditingCategoryId] = useState<any>();\n  const [categoryId, setCategoryId] = useState<any>();\n  const columnsDrag = useCategoryCol({ setEditingCategoryId, setCategoryId });\n  const dis = useAppDispatch();\n  const { t } = useTranslation();\n  const formStore = useForm<any>();\n  const hasAccess = useRoleManager();\n\n  const resetForm = () => {\n    setEditingCategoryId(undefined);\n    formStore.reset({\n      name: \"\",\n      imageId: \"\",\n    });\n  };\n\n  const allParams = useAllQueryParams();\n\n  return (\n    <>\n      {/* <Table\n        columns={columns}\n        dataUrl=\"category/product\"\n        searchable\n        onAddButton={() => dis(setOpenDrawer(true))}\n        onEditColumn={(row) => {\n          setEditingCategoryId(row._id);\n          dis(setOpenDrawer(true));\n        }}\n        onDeleteColumn={(row) => setCategoryId(row._id)}\n      /> */}\n\n      <DragTable\n        columns={columnsDrag}\n        dataUrl={`/category/paging`}\n        dragUrl=\"/category/positions\"\n        dragKey=\"categoryIds\"\n        render={render}\n        setRender={setRender}\n        onAddButton={() => dis(setOpenDrawer(true))}\n        exQueryParams={{\n          parentId: allParams.parentId,\n        }}\n      />\n      <WarningModal\n        open={categoryId}\n        setOpen={setCategoryId}\n        setRender={setRender}\n        url=\"category/delete\"\n      />\n      <FormDrawer\n        FORM_ID=\"category\"\n        isEditing={!!editingCategoryId}\n        customTitle={t(\"general.addCategory\")}\n        onClose={resetForm}\n      >\n        <CategoryChildForm\n          formStore={formStore}\n          setRender={setRender}\n          resetForm={resetForm}\n          editingCategoryId={editingCategoryId}\n        />\n      </FormDrawer>\n    </>\n  );\n};\n\nexport default CategoryChild;\n","import { IconButton } from \"@mui/material\";\nimport { GridColumns } from \"@mui/x-data-grid\";\nimport { DeleteIcon } from \"assets/svgs\";\nimport { setOpenDrawer } from \"components/elements/FormDrawer/formdrawer.slice\";\nimport EditIcon from \"components/elements/Table/assets/EditIcon\";\nimport { get } from \"lodash\";\nimport { useTranslation } from \"react-i18next\";\nimport { useRoleManager } from \"services/useRoleManager\";\nimport { useAppDispatch } from \"store/storeHooks\";\nimport { numberFormat } from \"utils/numberFormat\";\n\nexport const useCategoryColumns = (): GridColumns => {\n  const { t } = useTranslation();\n\n  return [\n    {\n      field: t(\"common.categoryName\"),\n      renderCell({ row }) {\n        return get(row, \"name\", \"\");\n      },\n    },\n  ];\n};\n\ninterface IUseStoreCol {\n  setCategoryId?: React.Dispatch<React.SetStateAction<string>>;\n  setEditingCategoryId?: React.Dispatch<React.SetStateAction<string>>;\n}\n\nexport const useCategoryCol = ({\n  setCategoryId,\n  setEditingCategoryId,\n}: IUseStoreCol) => {\n  const dis = useAppDispatch();\n  const { t } = useTranslation();\n  const hasAccess = useRoleManager();\n  const currentLang = localStorage.getItem(\"i18nextLng\") || \"uz\";\n\n  return [\n    {\n      key: \"sort\",\n      width: \"5%\",\n    },\n    {\n      title: \"â„–\",\n      dataIndex: \"id\",\n      key: \"id\",\n      width: \"5%\",\n      render: (item: any, record: any, index: number) => <>{index + 1}</>,\n    },\n    {\n      title: t(\"common.categoryName\"),\n      dataIndex: \"name\",\n      key: \"name\",\n      render: (text: string, record: any) => (\n          // @ts-ignore\n          text?.[currentLang]\n      ),\n    },\n    {\n      title: t(\"common.product\") + \" soni\",\n      dataIndex: \"productCount\",\n      key: \"productCount\",\n      render: (text: string, record: any) => {\n        return numberFormat(text);\n      },\n    },\n    {\n      title: \"\",\n      render: (_: any, record: any) => {\n        return (\n          <div className=\"d-flex gap-2 justify-content-end\">\n            {hasAccess(\"categoryCreate\") && (\n              <IconButton\n                onClick={() => {\n                  setEditingCategoryId?.(record?._id);\n                  dis(setOpenDrawer(true));\n                }}\n              >\n                <EditIcon />\n              </IconButton>\n            )}\n            {hasAccess(\"categoryDelete\") && (\n              <IconButton onClick={() => setCategoryId?.(record?._id)}>\n                <DeleteIcon />\n              </IconButton>\n            )}\n          </div>\n        );\n      },\n    },\n  ];\n};\n","export const numberFormat = (number: any) => {\n  if (number || number === 0) {\n    // Floating-point xatoliklarni oldini olish\n    const rounded = Math.round((number + Number.EPSILON) * 100) / 100;\n\n    return rounded\n      .toLocaleString(\"en-US\", {\n        minimumFractionDigits: 0, // Har doim 2 kasr\n        maximumFractionDigits: 0, // Kasr 2 dan oshmaydi\n      })\n      .replaceAll(\",\", \" \"); // Minglik ajratgich\n  }\n  return \"\";\n};\n"],"names":["formStore","resetForm","editingCategoryId","setRender","t","useTranslation","control","handleSubmit","reset","setValue","allParams","useAllQueryParams","useApiMutation","mutate","status","useApi","enabled","suspense","getByIdData","data","getByIdStatus","useEffect","prev","name","imageId","image","className","id","onSubmit","_id","parentId","storeId","Grid","container","spacing","item","md","label","rules","required","accept","useState","render","setEditingCategoryId","categoryId","setCategoryId","columnsDrag","dis","useAppDispatch","hasAccess","useRoleManager","currentLang","localStorage","getItem","key","width","title","dataIndex","record","index","text","numberFormat","_","IconButton","onClick","setOpenDrawer","EditIcon","useCategoryCol","useForm","undefined","columns","dataUrl","dragUrl","dragKey","onAddButton","exQueryParams","WarningModal","open","setOpen","url","FORM_ID","isEditing","customTitle","onClose","number","Math","round","Number","EPSILON","toLocaleString","minimumFractionDigits","maximumFractionDigits","replaceAll"],"sourceRoot":""}