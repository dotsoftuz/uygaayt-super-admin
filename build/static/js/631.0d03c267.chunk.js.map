{"version":3,"file":"static/js/631.0d03c267.chunk.js","mappings":"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","sources":["pages/promo_code/components/PromoCodeForm.tsx","pages/promo_code/index.tsx","pages/promo_code/container/PromoCode.tsx","pages/promo_code/container/promo-code.columns.tsx","utils/numberFormat.ts"],"sourcesContent":["import { FC, useEffect } from \"react\";\nimport { Grid, TextField } from \"@mui/material\";\nimport { AutoCompleteForm, DatePickerForm, ImageInput, TextInput } from \"components\";\nimport { Controller, UseFormReturn } from \"react-hook-form\";\nimport { useApi, useApiMutation } from \"hooks/useApi/useApiHooks\";\nimport { useTranslation } from \"react-i18next\";\nimport TextEditor from \"components/form/TextEditor/TextEditor\";\nimport { debounce } from \"lodash\";\n\ninterface IEmployeesForm {\n  formStore: UseFormReturn<any>;\n  editingBannerId: string;\n  resetForm: () => void;\n}\nconst PromoCodeForm: FC<IEmployeesForm> = ({\n  formStore,\n  editingBannerId,\n  resetForm,\n}) => {\n  const { t } = useTranslation();\n  const { control, handleSubmit, reset, watch, setValue } = formStore;\n\n  const { mutate, status } = useApiMutation(\n    editingBannerId ? `/promocode/update` : \"/promocode/create\",\n    editingBannerId ? \"put\" : \"post\"\n  );\n\n  const { data: getByIdData, status: getByIdStatus } = useApi(\n    `promocode/get-by-id/${editingBannerId}`,\n    {},\n    {\n      enabled: !!editingBannerId,\n      suspense: false,\n    }\n  );\n\n  useEffect(() => {\n    if (status === \"success\") {\n      resetForm();\n    }\n  }, [status]);\n\n  const submit = (data: any) => {\n    mutate({\n      _id: editingBannerId,\n      ...data,\n      maxUsageForUser: +data.maxUsageForUser,\n    });\n  };\n\n  useEffect(() => {\n    if (getByIdStatus === \"success\") {\n      reset({\n        name: getByIdData.data.name,\n        code: getByIdData.data.code,\n        amount: getByIdData.data.amount,\n        minOrderPrice: getByIdData.data.minOrderPrice,\n        fromDate: getByIdData.data.fromDate,\n        toDate: getByIdData.data.toDate,\n        maxUsage: getByIdData.data.maxUsage,\n        maxUsageForUser: getByIdData.data.maxUsageForUser,\n      });\n    }\n  }, [getByIdStatus, getByIdData]);\n\n\n  return (\n    <div className=\"custom-drawer\">\n      <form id=\"promo-code\" onSubmit={handleSubmit(submit)}>\n        <Grid container spacing={2}>\n          <Grid item md={12}>\n            <TextInput\n              control={control}\n              name=\"name\"\n              label={t(\"promo_code.name\")}\n            />\n          </Grid>\n          <Grid item md={12}>\n            <TextInput\n              control={control}\n              name=\"code\"\n              label={t(\"promo_code.code\")}\n            />\n          </Grid>\n          <Grid item md={12}>\n            <TextInput\n              name=\"maxUsage\"\n              control={control}\n              label={t(\"promo_code.usage\")}\n              type=\"number\"\n            />\n          </Grid>\n          <Grid item md={12}>\n            <TextInput\n              name=\"amount\"\n              control={control}\n              label={t(\"promo_code.value\")}\n              type=\"number\"\n            />\n          </Grid>\n          <Grid item md={12}>\n            <TextInput\n              name=\"minOrderPrice\"\n              control={control}\n              label={t(\"promo_code.min_order_price\")}\n              type=\"number\"\n            />\n          </Grid>\n          <Grid item md={12}>\n            <label className=\"text-[15px]\" htmlFor=\"\">{t(\"promo_code.max_usage_for_user\")}</label>\n            <Controller\n              name=\"maxUsageForUser\"\n              control={control}\n              render={({ field }) => (\n                <TextField\n                  {...field}\n                  className=\"mt-1\"\n                  type=\"number\"\n                  fullWidth\n                  variant=\"outlined\"\n                  defaultValue={1}\n                />\n              )}\n            />\n          </Grid>\n          <Grid item md={12}>\n            <DatePickerForm\n              control={control}\n              name=\"fromDate\"\n              disableTime={true}\n              // rules={{ required: { value: false, message: \"Majburiy\" } }}\n              label={t(\"promo_code.start_date\")}\n              minDate={new Date()}\n              readOnly\n              maxDate={\n                watch(\"dateTo\")\n                  // @ts-ignore\n                  ? new Date(watch(\"dateTo\"))\n                  : undefined\n              }\n            />\n          </Grid>\n          <Grid item md={12}>\n            <DatePickerForm\n              control={control}\n              name=\"toDate\"\n              // rules={{ required: { value: false, message: \"Majburiy\" } }}\n              disableTime={true}\n              label={t(\"promo_code.end_date\")}\n              readOnly\n            // minDate={discountEndMinDate}\n            />\n          </Grid>\n        </Grid>\n      </form>\n    </div>\n  );\n};\n\nexport default PromoCodeForm;\n","import PromoCode from \"./container/PromoCode\";\n\nexport default PromoCode;\n","import { FormDrawer, Table } from \"components\";\nimport { useMemo, useState } from \"react\";\nimport { useBannerColumns } from \"./promo-code.columns\";\nimport { useAppDispatch } from \"../../../store/storeHooks\";\nimport { setOpenDrawer } from \"components/elements/FormDrawer/formdrawer.slice\";\nimport { useForm } from \"react-hook-form\";\nimport BannerForm from \"../components/PromoCodeForm\";\nimport { useTranslation } from \"react-i18next\";\nimport { useRoleManager } from \"services/useRoleManager\";\nimport WarningModal from \"components/common/WarningModal/WarningModal\";\nimport { useApi, useApiMutation } from \"hooks/useApi/useApiHooks\";\n\nconst PromoCode = () => {\n  const [editingBannerId, setEditingBannerId] = useState<any>();\n  const [bannerId, setBannerId] = useState<any>();\n  const columns = useBannerColumns();\n  const hasAccess = useRoleManager();\n  const { t } = useTranslation();\n  const dis = useAppDispatch();\n  const formStore = useForm<any>();\n\n  const resetForm = () => {\n    setEditingBannerId(undefined);\n    formStore.reset({\n      name: \"\",\n      code: \"\",\n      amount: \"\",\n      minOrderPrice: \"\",\n      fromDate: null,\n      toDate: null,\n      maxUsage: \"\",\n      maxUsageForUser: 1,\n    });\n  };\n\n  const queryParams = useMemo(() => ({}), []);\n\n  return (\n    <>\n      <Table\n        dataUrl=\"promocode/paging\"\n        columns={columns}\n        searchable\n        onAddButton={hasAccess(\"bannerCreate\")\n          ? () => dis(setOpenDrawer(true))\n          : undefined}\n        onEditColumn={hasAccess(\"bannerUpdate\") ? (row) => {\n          setEditingBannerId(row._id);\n          dis(setOpenDrawer(true));\n        } : undefined}\n        onDeleteColumn={hasAccess(\"bannerDelete\") ? (row) => setBannerId(row._id) : undefined}\n        exQueryParams={queryParams}\n      />\n      <WarningModal open={bannerId} setOpen={setBannerId} url=\"promocode/delete\" />\n      <FormDrawer\n        FORM_ID=\"promo-code\"\n        isEditing={!!editingBannerId}\n        customTitle={editingBannerId ? t(\"promo_code.edit_promo_code\") : t(\"promo_code.new_promo_code\")}\n        onClose={resetForm}\n      >\n        <BannerForm\n          formStore={formStore}\n          resetForm={resetForm}\n          editingBannerId={editingBannerId}\n        />\n      </FormDrawer>\n\n    </>\n  );\n};\n\nexport default PromoCode;\n","import { GridColumns } from \"@mui/x-data-grid\";\nimport { Tooltip } from \"antd\";\nimport dayjs from \"dayjs\";\nimport { get } from \"lodash\";\nimport { useTranslation } from \"react-i18next\";\nimport { numberFormat } from \"utils/numberFormat\";\n\nexport const useBannerColumns = (): GridColumns => {\n  const { t } = useTranslation();\n\n  return [\n \n    {\n      field: t(\"promo_code.name\"),\n      renderCell({ row }) {\n        const title = row?.name;\n        const truncatedTitle = title?.length > 50 ? `${title.substring(0, 50)}...` : title;\n    \n        return (\n          <Tooltip title={title} arrow>\n            <span>{truncatedTitle}</span>\n          </Tooltip>\n        );\n      },\n    },\n    {\n      field: t(\"ID\"),\n      renderCell({ row }) {\n        return get(row, \"code\", \"-\");\n      },\n    },\n    {\n      field: t(\"promo_code.value\"),\n      renderCell({ row }) {\n        return numberFormat(get(row, \"amount\", \"-\"));\n      },\n    },\n    {\n      field: t(\"promo_code.usage\"),\n      renderCell({ row }) {\n        return get(row, \"maxUsage\", \"-\");\n      },\n    },\n    {\n      field: t(\"promo_code.used_count\"),\n      renderCell({ row }) {\n        return get(row, \"usedCount\", \"-\");\n      }\n    },\n    {\n      field: t(\"promo_code.start_date\"),\n      renderCell({ row }) {\n        return dayjs(get(row, \"fromDate\", \"-\")).format('DD.MM.YYYY HH:mm')\n      },\n    },\n    {\n      field: t(\"promo_code.end_date\"),\n      renderCell({ row }) {\n        return dayjs(get(row, \"toDate\", \"-\")).format('DD.MM.YYYY HH:mm')\n      },\n    },\n    {\n      field: t(\"promo_code.status\"),\n      renderCell({ row }) {\n        return get(row, \"state\", \"-\");\n      },\n    }\n  ];\n};\n","export const numberFormat = (number: any) => {\n  if (number || number === 0) {\n    // Floating-point xatoliklarni oldini olish\n    const rounded = Math.round((number + Number.EPSILON) * 100) / 100;\n\n    return rounded\n      .toLocaleString(\"en-US\", {\n        minimumFractionDigits: 0, // Har doim 2 kasr\n        maximumFractionDigits: 0, // Kasr 2 dan oshmaydi\n      })\n      .replaceAll(\",\", \" \"); // Minglik ajratgich\n  }\n  return \"\";\n};\n"],"names":["formStore","editingBannerId","resetForm","t","useTranslation","control","handleSubmit","reset","watch","setValue","useApiMutation","mutate","status","useApi","enabled","suspense","getByIdData","data","getByIdStatus","useEffect","name","code","amount","minOrderPrice","fromDate","toDate","maxUsage","maxUsageForUser","className","id","onSubmit","_id","Grid","container","spacing","item","md","label","type","htmlFor","render","field","TextField","fullWidth","variant","defaultValue","disableTime","minDate","Date","readOnly","maxDate","undefined","useState","setEditingBannerId","bannerId","setBannerId","columns","renderCell","row","title","truncatedTitle","length","substring","arrow","get","numberFormat","dayjs","format","useBannerColumns","hasAccess","useRoleManager","dis","useAppDispatch","useForm","queryParams","useMemo","dataUrl","searchable","onAddButton","setOpenDrawer","onEditColumn","onDeleteColumn","exQueryParams","WarningModal","open","setOpen","url","FORM_ID","isEditing","customTitle","onClose","number","Math","round","Number","EPSILON","toLocaleString","minimumFractionDigits","maximumFractionDigits","replaceAll"],"sourceRoot":""}