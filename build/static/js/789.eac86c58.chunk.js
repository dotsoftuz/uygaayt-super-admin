"use strict";(self.webpackChunkbestune_admin=self.webpackChunkbestune_admin||[]).push([[789],{45789:function(e,n,r){r.r(n),r.d(n,{default:function(){return I}});var i,t=r(29439),o=r(35980),a=r(72791),l=r(763),d=r(39230),s=r(79405),c=r(36978),u=r(61134),m=r(29001),f=r(93433),p=r(1413),v=r(36459),x=r(61889),g=r(62750),h=r(59460),j=r(80184),b=function(e){var n,r=e.formStore,i=e.editingCourierId,l=e.resetForm,c=e.productProps,u=(0,d.$G)().t,m=r.control,b=r.handleSubmit,C=r.reset,N=r.watch,_=r.setValue,I=(0,a.useState)(),Z=(0,t.Z)(I,2),w=Z[0],y=Z[1],k=c.courierImages,E=c.setCourierImages,P=c.mainImageId,S=c.setMainImageId;(0,s.T)();(0,v.Z)((0,g.h_)("employee/check?phoneNumber=".concat(N("phoneNumber")),{},{enabled:(null===(n=N("phoneNumber"))||void 0===n?void 0:n.length)>12&&!i,suspense:!1,onSuccess:function(e){var n=e.data;y(n)}}));var R=(0,g.uC)(i?"courier/update":"courier/create","post"),O=R.mutate,U=R.status,F=(0,g.h_)("courier/get-by-id/".concat(i),{},{enabled:!!i,suspense:!1}),M=F.data,G=F.status;(0,a.useEffect)((function(){"success"===U&&l()}),[U]);return(0,a.useEffect)((function(){var e,n,r,i,t,o,a,l,d;"success"===G&&(C((0,p.Z)({},M.data)),E((null===(e=M.data)||void 0===e?void 0:e.images)||[]),(null===(n=M.data)||void 0===n||null===(r=n.images)||void 0===r?void 0:r.find((function(e){var n;return(null===e||void 0===e?void 0:e._id)===(null===(n=M.data.mainImage)||void 0===n?void 0:n._id)})))&&null!==(i=M.data)&&void 0!==i&&null!==(t=i.images)&&void 0!==t&&t.length?S(null===(d=M.data.mainImage)||void 0===d?void 0:d._id):S(null===(o=M.data)||void 0===o||null===(a=o.images)||void 0===a||null===(l=a[0])||void 0===l?void 0:l._id))}),[M,G]),(0,a.useEffect)((function(){var e=k.find((function(e){return e._id===P}));e?S(e._id):k.length&&S(k[0]._id)}),[k]),(0,j.jsx)("div",{className:"custom-drawer",children:(0,j.jsx)("form",{id:"courier",onSubmit:b((function(e){var n;O((0,p.Z)((0,p.Z)({},e),{},{imageId:k.map((function(e){return e._id})),mainImageId:k.length?P||(null===k||void 0===k||null===(n=k[0])||void 0===n?void 0:n._id):null,_id:i}))})),children:(0,j.jsxs)(x.ZP,{container:!0,spacing:2,children:[(0,j.jsxs)(x.ZP,{item:!0,md:12,children:[(0,j.jsx)(o.sb,{control:m,name:"phoneNumber",label:u("common.phoneNumber")}),(null===w||void 0===w?void 0:w._id)&&!i&&(0,j.jsxs)("div",{className:"d-flex justify-content-between",children:[(0,j.jsx)("span",{className:"text-error mt-2",children:u("common.alreadyExistEmployee")}),(0,j.jsx)(o.c7,{title:u("general.add"),onClick:function(){C((0,p.Z)((0,p.Z)({},w),{},{_id:void 0})),y(null)}})]})]}),(0,j.jsx)(x.ZP,{item:!0,md:12,children:(0,j.jsx)(o.oi,{control:m,name:"firstName",label:u("common.firstName")})}),(0,j.jsx)(x.ZP,{item:!0,md:12,children:(0,j.jsx)(o.oi,{control:m,name:"lastName",label:u("common.lastName")})}),(0,j.jsx)(x.ZP,{item:!0,md:12,children:(0,j.jsx)(o.oi,{control:m,name:"password",label:u("common.password"),type:"password",rules:{required:!1}})}),(0,j.jsx)(x.ZP,{item:!0,md:12,children:(0,j.jsx)(o.oi,{control:m,name:"carBrand",label:u("COURIER.carBrand")})}),(0,j.jsx)(x.ZP,{item:!0,md:12,children:(0,j.jsx)(o.oi,{control:m,name:"carModel",label:u("COURIER.carModel")})}),(0,j.jsx)(x.ZP,{item:!0,md:12,children:(0,j.jsx)(o.oi,{control:m,name:"carNumber",label:u("COURIER.carNumber")})}),(0,j.jsx)(x.ZP,{item:!0,md:12,children:(0,j.jsx)(o.oi,{control:m,name:"carColor",label:u("COURIER.carColor")})}),(0,j.jsx)(x.ZP,{item:!0,md:12,children:(0,j.jsxs)("div",{className:"product-images",children:[(0,j.jsx)(o.aG,{control:m,setValue:_,name:"image",rules:{required:!1},multiple:!0,getImage:function(e){return E((function(n){return[].concat((0,f.Z)(n),[e])}))},accept:".png, .jpg, .jpeg"}),null===k||void 0===k?void 0:k.map((function(e){return(0,j.jsxs)("div",{className:"product-image",children:[(0,j.jsx)("img",{src:"https://backend.uygaayt.kahero.uz/employee-api/v1/"+e.url,alt:"product"}),(0,j.jsxs)("div",{className:"on-hover",children:[(0,j.jsx)("span",{className:"delete",onClick:function(){return E((function(n){return n.filter((function(n){return n._id!==e._id}))}))},children:(0,j.jsx)(h.pJ,{})}),(0,j.jsx)("span",{className:"main-image ".concat(e._id===P&&"active"),onClick:function(){return E(e._id)}})]})]},e._id)}))]})})]})})})},C=r(30168),N=r(17939).default.div(i||(i=(0,C.Z)(["\n  background-color: #fff;\n  border-radius: 20px;\n  padding: 32px 42px 24px 42px;\n  h2 {\n    font-weight: 500;\n    font-size: 26px;\n  }\n  button {\n    width: 100px;\n  }\n"]))),_=function(e){var n=e.open,r=e.setOpen,i=e.title,t=e.url,l=e.confirmFn,s=(0,d.$G)().t,c=(0,g.uC)("".concat(t,"/").concat(n),"post"),u=c.mutate,m=c.status;return(0,a.useEffect)((function(){"success"===m&&r(null)}),[m,u,n]),(0,j.jsx)(o.u_,{setOpen:r,open:!!n,children:(0,j.jsxs)(N,{children:[(0,j.jsx)("h2",{children:i||s("general.reallyDelete")}),(0,j.jsx)(o.xq,{isCancelFromRoute:!1,SubmitTitle:s("general.yes"),cancelTitle:s("general.no"),onClick:function(){return t?u({_id:n}):l()},onCancel:function(){return r(!1)}})]})})},I=function(){var e=(0,a.useState)(),n=(0,t.Z)(e,2),r=n[0],i=n[1],f=(0,a.useState)(),p=(0,t.Z)(f,2),v=p[0],x=p[1],g=function(){var e=(0,d.$G)().t;return[{field:e("common.fullName"),renderCell:function(e){return(0,l.get)(e,"row.firstName","")+" "+(0,l.get)(e,"row.lastName","")},flex:1.5},{field:e("common.phoneNumber"),renderCell:function(e){return e.row.phoneNumber}},{field:e("common.rating"),renderCell:function(e){var n;return null===(n=e.row.role)||void 0===n?void 0:n.name}}]}(),h=(0,m.w)(),C=(0,d.$G)().t,N=(0,s.T)(),I=(0,u.cI)(),Z=(0,a.useState)([]),w=(0,t.Z)(Z,2),y=w[0],k=w[1],E=(0,a.useState)(),P=(0,t.Z)(E,2),S=P[0],R=P[1],O=function(){i(void 0),I.reset({firstName:"",lastName:"",phoneNumber:"",password:"",carBrand:"",carColor:"",carModel:"",carNumber:"",imageUrl:""})};return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(o.iA,{dataUrl:"courier/paging",columns:g,searchable:!0,onAddButton:h("employeeCreate")?function(){return N((0,c.dl)(!0))}:void 0,onEditColumn:h("employeeUpdate")?function(e){i(e._id),N((0,c.dl)(!0))}:void 0,onDeleteColumn:h("employeeDelete")?function(e){return x(e._id)}:void 0}),(0,j.jsx)(_,{open:v,setOpen:x,url:"courier/delete"}),(0,j.jsx)(o._8,{FORM_ID:"courier",isEditing:!!r,customTitle:C("general.addCourier"),onClose:O,children:(0,j.jsx)(b,{formStore:I,resetForm:O,editingCourierId:r,productProps:{courierImages:y,setCourierImages:k,mainImageId:S,setMainImageId:R}})})]})}}}]);
//# sourceMappingURL=789.eac86c58.chunk.js.map