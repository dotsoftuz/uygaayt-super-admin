{"version":3,"file":"static/js/902.def15f68.chunk.js","mappings":"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","sources":["pages/abc_analytics/index.tsx","pages/abc_analytics/container/AbcAnalytics.tsx","pages/abc_analytics/container/abc_analytics.columns.tsx","utils/numberFormat.ts"],"sourcesContent":["import Product from \"./container/AbcAnalytics\";\n\nexport default Product;\n","import React, { useEffect } from 'react';\nimport { Grid, FormControl, InputLabel, Select, MenuItem, Alert } from \"@mui/material\";\nimport { Controller, useForm } from \"react-hook-form\";\nimport { useTranslation } from \"react-i18next\";\nimport { Table, TextInput } from \"components\";\nimport { useProductColumns } from \"./abc_analytics.columns\";\nimport { useRoleManager } from \"services/useRoleManager\";\nimport { useAppDispatch } from \"store/storeHooks\";\nimport { RangeDatePicker } from \"components\";\nimport useAllQueryParams from \"hooks/useGetAllQueryParams/useAllQueryParams\";\nimport { useState } from \"react\";\n\nconst Client = () => {\n  const allParams = useAllQueryParams();\n  const columns = useProductColumns();\n  const hasAccess = useRoleManager();\n  const dis = useAppDispatch();\n  const { t } = useTranslation();\n  const [sortBy, setSortBy] = useState(\"total_price\");\n  const [error, setError] = useState(\"\");\n\n  const formStore = useForm({\n    defaultValues: {\n      a: 20,\n      b: 40,\n      c: 40,\n      sortBy: {\n        _id: \"total_price\",\n        name: \"Umumiy narx\",\n        trans_key: \"total_price\",\n      },\n    },\n  });\n  \n  const { control, handleSubmit, reset, setValue, watch } = formStore;\n  const watchedValues = {\n    a: Number(watch('a')) || 0,\n    b: Number(watch('b')) || 0,\n    c: Number(watch('c')) || 0\n  };\n\n  // Validate total equals 100\n  useEffect(() => {\n    const total = watchedValues.a + watchedValues.b + watchedValues.c;\n    if (total !== 100) {\n      setError(`A, B, va C qiymatlarining yig'indisi 100 bo'lishi kerak. Hozirgi yig'indi: ${total}`);\n    } else {\n      setError(\"\");\n    }\n  }, [watchedValues.a, watchedValues.b, watchedValues.c]);\n\n  const renderHeader = (\n    <>\n      <Grid className='pb-2' container display={\"flex\"} alignItems={'center'} spacing={2} >\n        <Grid lg={3} md={6} xs={12} paddingBlockStart={5} paddingInlineStart={2}>\n          <RangeDatePicker />\n        </Grid>\n        <Grid lg={3} md={6} xs={12} paddingBlockStart={5} paddingInlineStart={2}>\n          <Controller\n            name=\"sortBy\"\n            control={control}\n            render={({ field }) => (\n              <FormControl fullWidth>\n                <InputLabel id=\"sort-by-label\">{t(\"Filter\")}</InputLabel>\n                <Select\n                  labelId=\"sort-by-label\"\n                  label={t(\"Filter\")}\n                  size=\"small\"\n                  onChange={(e: any) => {\n                    setSortBy(e.target.value);\n                  }}\n                  style={{ width: '150px', paddingBlock: 3, marginTop: 2, borderRadius: 10 }}\n                  defaultValue={'total_price'}\n                >\n                  <MenuItem value=\"total_price\">Umumiy narx</MenuItem>\n                  <MenuItem value=\"total_amount\">Sotilgan</MenuItem>\n                </Select>\n              </FormControl>\n            )}\n          />\n        </Grid>\n        <Grid item lg={2} md={4} xs={12}>\n          <TextInput\n            name=\"a\"\n            control={control}\n            type=\"number\"\n            label={t(\"A\")}\n            rules={{ \n              required: true,\n              min: 0,\n              max: 100\n            }}\n          />\n        </Grid>\n        <Grid item lg={2} md={4} xs={12}>\n          <TextInput\n            name=\"b\"\n            control={control}\n            type=\"number\"\n            label={t(\"B\")}\n            rules={{ \n              required: true,\n              min: 0,\n              max: 100\n            }}\n          />\n        </Grid>\n        <Grid item lg={2} md={4} xs={12}>\n          <TextInput\n            name=\"c\"\n            control={control}\n            type=\"number\"\n            label={t(\"C\")}\n            rules={{ \n              required: true,\n              min: 0,\n              max: 100\n            }}\n          />\n        </Grid>\n      </Grid>\n    </>\n  );\n\n  return (\n    <>\n      <Table\n        columns={columns}\n        dataUrl=\"report/abc\"\n        headerChildren={renderHeader}\n        isGetAll\n        // @ts-ignore\n        exQueryParams={!error ? {\n          a: watchedValues.a,\n          b: watchedValues.b,\n          c: watchedValues.c,\n          sortBy: sortBy,\n          dateFrom: allParams.dateFrom,\n          dateTo: allParams.dateTo,\n        } : null}\n      />\n    </>\n  );\n};\n\nexport default Client;","import { GridColumns } from \"@mui/x-data-grid\";\nimport { Tooltip } from \"antd\";\nimport { get } from \"lodash\";\nimport { useTranslation } from \"react-i18next\";\nimport { numberFormat } from \"utils/numberFormat\";\n\nexport const useProductColumns = (): GridColumns => {\n  const { t } = useTranslation();\n  const currentLang = localStorage.getItem(\"i18nextLng\") || \"uz\";\n\n\n  return [\n    {\n      field: t(\"common.productName\"),\n      renderCell({ row }) {\n        const title = row?.product?.name?.[currentLang];\n        const truncatedTitle = title?.length > 30 ? `${title.substring(0, 30)}...` : title;\n    \n        return (\n          <Tooltip title={title} arrow>\n            <span>{truncatedTitle}</span>\n          </Tooltip>\n        );\n      },\n    },\n    {\n      field: \"total_amount\",\n      headerName: t(\"common.sold\")!,\n      renderCell({ row }) {\n        return numberFormat(get(row, \"total_amount\", \"\"));\n      },\n    },\n    {\n      field: \"total_price\",\n      headerName: t(\"order.totalPrice\")!,\n      renderCell({ row }) {\n        return numberFormat(get(row, \"total_price\", \"\"));\n      },\n    },\n    {\n      field: \"share\",\n      headerName: t(\"general.share\") + \" (%)\"!,\n      renderCell({ row }) {\n        return numberFormat(get(row, \"share\", \"\"));\n      },\n    },\n    {\n      field: \"group\",\n      headerName: t(\"common.type\")!,\n      renderCell({ row }) {\n        return numberFormat(get(row, \"group\", \"\"));\n      },\n    },\n    // {\n    //   field: t(\"common.status\"),\n    //   renderCell({ row }) {\n    //     return get(row, \"status\", \"\");\n    //   },\n    // },\n  ];\n};\n","export const numberFormat = (number: any) => {\n  if (number || number === 0) {\n    // Floating-point xatoliklarni oldini olish\n    const rounded = Math.round((number + Number.EPSILON) * 100) / 100;\n\n    return rounded\n      .toLocaleString(\"en-US\", {\n        minimumFractionDigits: 0, // Har doim 2 kasr\n        maximumFractionDigits: 0, // Kasr 2 dan oshmaydi\n      })\n      .replaceAll(\",\", \" \"); // Minglik ajratgich\n  }\n  return \"\";\n};\n"],"names":["allParams","useAllQueryParams","columns","t","useTranslation","currentLang","localStorage","getItem","field","renderCell","row","title","product","name","truncatedTitle","length","substring","arrow","headerName","numberFormat","get","useProductColumns","useRoleManager","useAppDispatch","useState","sortBy","setSortBy","error","setError","formStore","useForm","defaultValues","a","b","c","_id","trans_key","control","watch","handleSubmit","reset","setValue","watchedValues","Number","useEffect","total","renderHeader","Grid","className","container","display","alignItems","spacing","lg","md","xs","paddingBlockStart","paddingInlineStart","render","FormControl","fullWidth","InputLabel","id","Select","labelId","label","size","onChange","e","target","value","style","width","paddingBlock","marginTop","borderRadius","defaultValue","MenuItem","item","type","rules","required","min","max","dataUrl","headerChildren","isGetAll","exQueryParams","dateFrom","dateTo","number","Math","round","EPSILON","toLocaleString","minimumFractionDigits","maximumFractionDigits","replaceAll"],"sourceRoot":""}