"use strict";(self.webpackChunkbestune_admin=self.webpackChunkbestune_admin||[]).push([[923],{6790:(e,n,t)=>{t.d(n,{J1:()=>i,br:()=>a,eM:()=>o,lq:()=>l});const i=[{_id:"cash",name:"Naqd",trans_key:"cash"}],o=[{_id:"percent",name:"Foiz",trans_key:"percent"},{_id:"amount",name:"Miqdor",trans_key:"amount"}],a=[{name:"functionality",key:"functionality",role:"role"},{name:"discounts",key:"discountOrder",role:"role"},{name:"bonus",key:"bonusOrder",role:"role"},{name:"premium_discounts",key:"premiumDiscountOrder",role:"role"},{name:"main_address",key:"mainAddress",role:"role"},{name:"website_conditions",key:"websiteConditions",role:"role"}],l=[{rate:5},{rate:4},{rate:3},{rate:2},{rate:1}]},72824:(e,n,t)=>{t.d(n,{j:()=>i});const i=e=>{if(e||0===e){return(Math.round(100*(e+Number.EPSILON))/100).toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0}).replaceAll(","," ")}return""}},94923:(e,n,t)=>{t.r(n),t.d(n,{default:()=>Ve});var i,o=t(73216),a=t(68903),l=t(57397),r=t(61698),d=t(71828),s=t(84511),c=t(58885),u=t(8192),m=t(57528),p=t(66253);const v=p.default.div(i||(i=(0,m.A)(["\n  .MuiToggleButton-root {\n    border-radius: 12px;\n    background-color: #f5f5f5 !important;\n    z-index: 2;\n    transition: all 0.3s ease;\n    &.active {\n      background-color: #EB5B00 !important;\n    }\n  }\n"])));var x=t(70579);const h=()=>{const e=(0,o.Zp)(),{pathname:n}=(0,o.zy)();return(0,x.jsx)(v,{path:(0,u.kP)(n),children:(0,x.jsxs)(d.A,{color:"primary",value:(0,u.kP)(n),exclusive:!0,onChange:(n,t)=>{t&&e("/order/".concat(t))},"aria-label":"Platform",children:[(0,x.jsx)(s.A,{value:"table",className:"table"===(0,u.kP)(n)?"active":"",children:(0,x.jsx)(c.ak,{})}),(0,x.jsx)(s.A,{value:"board",className:"board"===(0,u.kP)(n)?"active":"",children:(0,x.jsx)(c.gC,{})})]})})};var g,f=t(65043),b=t(74117),j=t(83501),y=t(72473),A=t(49752),N=t(19303),k=t(60446),w=t.n(k),S=t(72824);const I=p.default.div(g||(g=(0,m.A)(["\n  margin-bottom: 5px;\n  .MuiInputBase-root {\n    background-color: ",";\n    color: "," !important;\n  }\n  & .MuiSelect-select.Mui-disabled {\n    color: "," !important;\n    -webkit-text-fill-color: "," !important;\n  }\n\n  & svg {\n    path {\n      fill: "," !important;\n    }\n  }\n"])),e=>{let{stateColor:n}=e;return n},e=>{let{luma:n}=e;return n>60?"#232323":"#ffffff"},e=>{let{luma:n}=e;return n>60?"#232323":"#ffffff"},e=>{let{luma:n}=e;return n>60?"#232323":"#ffffff"},e=>{let{luma:n}=e;return n>60?"#232323":"#ffffff"});var C=t(89379),z=t(28572),_=t(15795),L=t(90860),E=t(35472),P=t(43686),B=t(19504),D=t(53536),M=t(35475);const T=function(e){let{options:n=[],optionsUrl:t="",returnOnlyId:i=!0,label:o,disabled:a,placeholder:l,filterName:d,nameProp:s="name",exQueryParams:c={},dataProp:u="data.data",mapData:m,onChange:p}=e;const[v,h]=(0,f.useState)(),[g,j]=(0,f.useState)(),{debouncedValue:y,isDebouncing:A}=(0,P.A)(g,600),[N,k]=(0,f.useState)(null),w=localStorage.getItem("i18nextLng")||"uz";(0,f.useEffect)(()=>{h({search:g})},[y]);const{data:S,isFetching:I}=(0,r.gf)(t,(0,C.A)((0,C.A)({},v),c),{enabled:!!t,suspense:!1}),T=e=>null!==e&&void 0!==e&&e.firstName?"".concat(null===e||void 0===e?void 0:e.firstName," ").concat(null===e||void 0===e?void 0:e.lastName):null===e||void 0===e?void 0:e[s],R=((0,D.get)(S,u)||n).map(e=>(0,C.A)((0,C.A)({},e),{},{name:T(e)})),[O,q]=(0,M.ok)(),F=(0,B.A)(),{t:V}=(0,b.Bd)();return(0,x.jsxs)(L.w,{children:[o&&(0,x.jsx)("label",{children:o}),(0,x.jsx)(z.A,{options:m?m(R):R,getOptionLabel:e=>{var n;return(null===e||void 0===e||null===(n=e.name)||void 0===n?void 0:n[w])||""},onChange:(e,n)=>{null===p||void 0===p||p(n),k(i?null===n||void 0===n?void 0:n._id:n),d&&(n?q((0,C.A)((0,C.A)({},F),{},{[d]:null===n||void 0===n?void 0:n._id})):(delete F[d],q((0,C.A)({},F))))},loading:I||A,disabled:a,sx:{"& fieldset":{border:"none"}},loadingText:"izlamoqda...",noOptionsText:!A&&"malumot topilmadi",value:i?(0,E.K)(R,N):N,renderInput:e=>(0,x.jsx)(x.Fragment,{children:(0,x.jsx)(_.A,(0,C.A)((0,C.A)({},e),{},{inputProps:(0,C.A)((0,C.A)({},e.inputProps),{},{onChange:n=>{var t,i;null===e||void 0===e||null===(t=e.inputProps)||void 0===t||null===(i=t.onChange)||void 0===i||i.call(t,n),j(n.target.value||"")}}),onBlur:()=>j(void 0),variant:"outlined",fullWidth:!0,placeholder:l||V("LABELS.ROLE_ALL.TITLE")}))})})]})};var R=t(77837);const O=()=>{const[e,n]=(0,f.useState)(),t=(0,y.j)(),i=((0,j.L)(),(0,y.G)(e=>e.SocketState.render)),d=(0,B.A)(),[s,c]=(0,f.useState)([]),{mutate:u,reset:m}=(0,r.L2)("order/state/".concat(null===e||void 0===e?void 0:e.orderId),"put",{onSuccess(){n(void 0),t((0,l.UL)(!0))}});(0,f.useEffect)(()=>{e&&u({stateId:e.stateId,_id:e.orderId,position:1})},[e]);const p=((e,n)=>{const{t:t}=(0,b.Bd)();return[{field:t("common.number"),renderCell(e){let{row:n}=e;return n.number},flex:.6},{field:t("common.price"),renderCell(e){let{row:n}=e;return(0,S.j)(n.totalPrice)},flex:.6},{field:t("order.receiver"),renderCell(e){var n,t;let{row:i}=e;const o=null===i||void 0===i||null===(n=i.customer)||void 0===n?void 0:n.firstName,a=(null===o||void 0===o?void 0:o.length)>10?"".concat(o.substring(0,10),"..."):o,l=null===i||void 0===i||null===(t=i.customer)||void 0===t?void 0:t.lastName,r=(null===l||void 0===l?void 0:l.length)>10?"".concat(l.substring(0,10),"..."):l,d="".concat(a).concat(l?" ".concat(r):""),s="".concat(o).concat(l?" ".concat(l):"");return(0,x.jsx)(A.A,{title:s,arrow:!0,children:(0,x.jsx)("span",{children:d})})}},{field:t("common.phoneNumber"),renderCell(e){var n;let{row:t}=e;return null===(n=t.customer)||void 0===n?void 0:n.phoneNumber}},{field:t("common.receiverPhoneNumber"),renderCell(e){var n;let{row:t}=e;return null===(n=t.receiverCustomer)||void 0===n?void 0:n.phoneNumber}},{field:t("common.paymentType"),renderCell(e){let{row:n}=e;return t("enum.".concat(n.paymentType))},flex:.6},{field:t("common.time"),renderCell(e){let{row:n}=e;return w()(n.createdAt).format("DD.MM.YYYY HH:mm")}},{field:t("common.status"),renderCell(t){var i,o,a,l,r;let{row:d}=t;const s=null===d||void 0===d||null===(i=d.state)||void 0===i||null===(o=i.color)||void 0===o?void 0:o.substring(1),c=parseInt(s,16),u=.2126*(c>>16&255)+.7152*(c>>8&255)+.0722*(255&c);return(0,x.jsx)(I,{stateColor:null===d||void 0===d||null===(a=d.state)||void 0===a?void 0:a.color,luma:u,onClick:e=>e.stopPropagation(),children:(0,x.jsx)(N.l6,{onChange:n=>e({stateId:n,orderId:d._id}),customValue:d.stateId,options:n,disabled:"completed"===(null===(l=d.state)||void 0===l?void 0:l.state)||"cancelled"===(null===(r=d.state)||void 0===r?void 0:r.state)})})}}]})(n,s),v=(0,o.Zp)(),{t:g}=(0,b.Bd)();(0,f.useEffect)(()=>{i&&(m(),t((0,R.N8)(!1)))},[i]);const k=(0,x.jsx)(x.Fragment,{children:(0,x.jsxs)(a.Ay,{className:"lg:w-[60%] w-full gap-y-2 sm:gap-y-0 grid sm:grid-cols-3 items-center gap-x-2",children:[(0,x.jsx)(a.Ay,{item:!0,className:"",children:(0,x.jsx)(T,{optionsUrl:"order-state/get-all",filterName:"stateId",placeholder:g("common.status"),dataProp:"data"})}),(0,x.jsx)(a.Ay,{item:!0,className:"",children:(0,x.jsx)(N.wT,{})}),(0,x.jsx)(a.Ay,{item:!0,className:" flex justify-end",children:(0,x.jsx)(h,{})})]})}),{data:C,status:z,refetch:_}=(0,r.gf)("order-state/get-all",{},{onSuccess(e){let{data:n}=e;console.log(n),c(n||[])}});return(0,x.jsx)(x.Fragment,{children:(0,x.jsx)(N.XI,{dataUrl:"/order/paging",columns:p,headerChildren:k,searchable:!0,onAddButton:()=>v("/order/add"),onRowClick:e=>v("/order/".concat(e._id)),exQueryParams:{stateId:(null===d||void 0===d?void 0:d.stateId)||void 0}})})};var q=t(25029),F=t(45424),V=t(32143),U=t(17392);const G=(e,n)=>{var t;const[i,o]=f.useState(null),a=()=>{o(null)};return(0,x.jsxs)("div",{className:"d-flex justify-content-between align-items-center lane_title",children:[(0,x.jsx)("h3",{children:e.title}),(0,x.jsx)("div",{children:0===(null===(t=e.cards)||void 0===t?void 0:t.length)?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(U.A,{"aria-owns":i?"simple-menu":void 0,"aria-haspopup":"true",onClick:e=>{o(e.currentTarget)}}),(0,x.jsx)(F.A,{id:"simple-menu",anchorEl:i,open:Boolean(i),onClose:a,children:(0,x.jsx)(V.A,{onClick:()=>{n({ids:[null===e||void 0===e?void 0:e.id]}),e.onDelete(null===e||void 0===e?void 0:e.id),a()},children:"Statusni o'chirish"})})]}):" "})]})};var Y,Q;const W=p.default.div(Y||(Y=(0,m.A)(["\n  position: relative;\n  overflow-y: hidden !important;\n  background-color: #fff;\n  padding: 20px;\n  border-radius: 12px;\n  box-shadow: 0px 0px 4px 0px rgba(0, 0, 0, 0.07);\n  .header {\n    display: flex;\n    align-items: center;\n    justify-content: end;\n    margin-bottom: 10px;\n  }\n  .react-trello-board {\n    background-color: transparent;\n    height: 75vh !important;\n    padding: 0;\n    .react-trello-lane {\n      position: relative;\n      border-radius: 12px;\n      border: 1px solid #d9d9d9;\n      background-color: #ffffff;\n      width: 260px;\n      max-height: 70vh;\n      & {\n        width: 200px;\n      }\n      div:nth-child(2):not(div.smooth-dnd-draggable-wrapper) {\n        margin-top: 45px;\n        &::-webkit-scrollbar {\n          width: 10px;\n        }\n        &::-webkit-scrollbar-track {\n          background-color: #f6f6f6;\n          border-radius: 3px;\n        }\n        &::-webkit-scrollbar-thumb {\n          background-color: #d9d9d9;\n          border-radius: 3px;\n\n          &:hover {\n            background-color: #999;\n          }\n        }\n      }\n      width: 12px;\n      header {\n        padding-bottom: 3px;\n        margin-bottom: 5px;\n        button {\n          display: none;\n        }\n      }\n      .lane_title {\n        position: absolute;\n        top: 0;\n        left: 0;\n        height: 48px;\n        width: 100%;\n        border-radius: 8px 8px 0 0;\n        display: flex;\n        align-items: center;\n        justify-content: space-between;\n        padding: 0 12px;\n        border-bottom: 1px solid #d9d9d9;\n      }\n    }\n    .react-trello-card {\n      border-radius: 8px;\n      border: 1px solid #d9d9d9;\n      background-color: #f8f8f8;\n      min-height: 70px;\n      textarea {\n        pointer-events: none !important;\n        font-size: 14px;\n        font-weight: 600;\n        color: #006ffd;\n      }\n      span:nth-child(2) textarea {\n        color: #000;\n        text-align: left;\n      }\n      div {\n        textarea {\n          color: #888888;\n          font-size: 14px;\n          font-weight: 500;\n        }\n      }\n    }\n    .smooth-dnd-draggable-wrapper,\n    .smooth-dnd-container {\n      article {\n        header {\n          display: flex;\n          flex-direction: column;\n          span {\n            width: 100%;\n          }\n          textarea {\n          }\n        }\n        div {\n          margin: 0 !important ;\n          padding: 0 !important;\n        }\n      }\n    }\n  }\n  .add-lane-form {\n    border-radius: 12px;\n    padding: 10px;\n    width: 300px;\n    background-color: #d9d9d9;\n    .MuiInputBase-input {\n      border: 1px solid #999;\n      background-color: white;\n    }\n  }\n  .filters {\n    .MuiAutocomplete-root {\n      position: relative;\n    }\n    margin-bottom: 1rem;\n    label {\n      position: absolute;\n      top: -15px;\n    }\n  }\n  .load-more {\n    width: 100%;\n    background-color: transparent !important;\n    height: 30px;\n  }\n"])));p.default.div(Q||(Q=(0,m.A)(["\n  background-color: #f5f5f5;\n  border: 1px solid #f5f5f5;\n  border-radius: 12px;\n  margin-right: 18px;\n  .MuiToggleButton-root {\n    border-radius: 12px;\n    &:last-child {\n      background-color: #0f6fdf;\n      border-radius: 12px !important;\n      z-index: 2;\n      transition: all 0.3s ease !important;\n\n      &:hover {\n        background-color: #0f6fdf;\n      }\n    }\n    &:first-child {\n      border: none;\n      border-radius: 12px !important;\n      transition: all 0.3s ease !important;\n\n      &:hover {\n        background-color: #0f6fdf;\n      }\n    }\n  }\n"])));var X=t(87988),Z=t(71219);const K=(0,q.jL)({"Add another lane":"+Status qo'shish","Click to add card":"Buyurtma qo'shish","Delete lane":"Statusni o'chirish","Lane actions":"Status ustidagi amallar",button:{"Add card":"Buyurtma qo'shing","Add lane":"Status qo'shish",Cancel:"Bekor qilish"},placeholder:{title:"Nomi",description:"Tavsif",label:"Yorliq"}}),H=()=>{const e=(0,B.A)(),{t:n}=(0,b.Bd)(),t=(0,o.Zp)(),[i,a]=(0,f.useState)(),[d,s]=(0,f.useState)(!1),[c,u]=(0,f.useState)(""),[m,p]=(0,f.useState)({}),[v,g]=(0,f.useState)({}),A=((0,j.L)(),(0,y.G)(e=>e.SocketState.render)),k=(0,y.j)(),[w,S]=(0,f.useState)(),{data:I,status:z,refetch:_}=(0,r.gf)("order-state/get-all",(0,C.A)({},e),{suspense:!1}),{mutate:L,reset:E}=(0,r.L2)("order/state/".concat(null===w||void 0===w?void 0:w.orderId),"put",{onSuccess(){S(void 0),k((0,l.UL)(!0))}});(0,f.useEffect)(()=>{w&&L({stateId:w.stateId,_id:w.orderId,position:1})},[w]);const{mutate:P,reset:D}=(0,r.L2)("order/paging","post",{onSuccess(e,n){let{data:t}=e;const{stateId:i}=n;a(e=>e?e.map(e=>{if(e._id===i){var n,o;const a=1===v[i]?[]:e.orders||[],l=new Set(a.map(e=>e._id)),r=null===t||void 0===t||null===(n=t.data)||void 0===n||null===(o=n.filter(e=>!l.has(e._id)))||void 0===o?void 0:o.map(e=>{var n;return{number:e.number,totalPrice:e.totalPrice,addressName:e.addressName,createdAt:e.createdAt,state:null===(n=e.state)||void 0===n?void 0:n.state,_id:e._id,uniqueId:"".concat(e._id,"-").concat(e.createdAt)}});return(0,C.A)((0,C.A)({},e),{},{orders:[...a,...r||[]]})}return e}):e),p(e=>(0,C.A)((0,C.A)({},e),{},{[i]:!1}))},onError(e,n){const{stateId:t}=n;p(e=>(0,C.A)((0,C.A)({},e),{},{[t]:!1}))}});(0,f.useEffect)(()=>{A&&(E(),D(),_(),k((0,R.N8)(!1)))},[A]);(0,f.useEffect)(()=>{const e=e=>{var n;null!==(n=e.data.state)&&void 0!==n&&n.isSoundable&&(()=>{try{new Audio(Z).play()}catch(e){}})(),a(n=>n?n.map(n=>{if(n._id===e.data.stateId){var t;const i={number:e.data.number,totalPrice:e.data.totalPrice,addressName:e.data.addressName,createdAt:e.data.createdAt,state:null===(t=e.data.state)||void 0===t?void 0:t.state,_id:e.data._id,uniqueId:"".concat(e.data._id,"-").concat(e.data.createdAt)},o=new Set((n.orders||[]).map(e=>e._id));return o.has(i._id)?n:(0,C.A)((0,C.A)({},n),{},{orders:[...n.orders||[],i]})}return n}):n)};return X.s.on("orderCreated",e),()=>{X.s.off("orderCreated",e)}},[]),(0,f.useEffect)(()=>{if("success"===z&&null!==I&&void 0!==I&&I.data){a(I.data);const e=I.data.reduce((e,n)=>(0,C.A)((0,C.A)({},e),{},{[n._id]:1}),{});g(e),I.data.forEach(e=>{p(n=>(0,C.A)((0,C.A)({},n),{},{[e._id]:!0})),P({page:1,limit:10,stateId:e._id})})}},[z,null===I||void 0===I?void 0:I.data]),(0,f.useEffect)(()=>{i&&Object.values(m).every(e=>!e)&&s(!0)},[i,m]);const{mutate:M}=(0,r.L2)("order/state/".concat(c),"put",{onSuccess(){u("")}}),{mutate:T}=(0,r.L2)("status","put"),{mutate:O}=(0,r.L2)("status","delete"),F=(0,f.useMemo)(()=>d?function(e){const n=localStorage.getItem("i18nextLng")||"uz";return{lanes:null===e||void 0===e?void 0:e.map(e=>{var t,i;return{cards:(null===(t=e.orders)||void 0===t?void 0:t.map((e,n)=>({id:e.uniqueId||e._id,label:"".concat(e.totalPrice," UZS"),title:"#".concat(e.number),description:e.addressName,draggable:!["completed","cancelled"].includes(e.state),metadata:{originalId:e._id}})))||[],id:null===e||void 0===e?void 0:e._id,title:null===(i=e.name)||void 0===i?void 0:i[n],statusColor:e.color,style:{width:280,borderTop:"".concat("#ffffff"!==e.color?e.color:"#364880"," 5px solid")}}})}}(i||[]):{lanes:[]},[i,d]);return(0,x.jsxs)(W,{children:[(0,x.jsx)("div",{className:"header",children:(0,x.jsx)(h,{})}),d?(0,x.jsx)(q.Ay,{data:F,editable:!0,handleDragEnd:(e,n,t,i,o)=>{var a;u((null===(a=o.metadata)||void 0===a?void 0:a.originalId)||o.id),setTimeout(()=>{var e;return M({position:i,stateId:t,_id:null===o||void 0===o||null===(e=o.metadata)||void 0===e?void 0:e.originalId})},0)},handleLaneDragEnd:(e,n,t)=>{T({_id:t.id,position:+n+1})},editLaneTitle:!1,canAddLanes:!1,hideCardDeleteIcon:!0,onCardClick:(e,n)=>{const i=null===n||void 0===n?void 0:n.originalId;i&&t("/order/".concat(i))},components:{LaneHeader:e=>G(e,O),AddCardLink:e=>{let{laneId:t}=e;return(0,x.jsx)(N.O6,{title:m[t]?n("general.loading"):n("general.loadMore"),className:"load-more",disabled:m[t],onClick:()=>(e=>{if(m[e])return;p(n=>(0,C.A)((0,C.A)({},n),{},{[e]:!0}));const n=(v[e]||1)+1;g(t=>(0,C.A)((0,C.A)({},t),{},{[e]:n})),P({page:n,limit:10,stateId:e})})(t)})}},lang:"ru",t:K}):(0,x.jsx)(N.Rh,{})]})};var J;const $=p.default.div(J||(J=(0,m.A)(["\n  margin-top: 12px;\n"])));var ee;const ne=p.default.div(ee||(ee=(0,m.A)(["\n  border-radius: 12px;\n  background: #fff;\n  box-shadow: 0px 0px 4px 0px rgba(0, 0, 0, 0.07);\n  padding: 16px;\n  height: calc(100vh - 110px);\n  overflow: auto;\n  .tab {\n    margin-bottom: 16px;\n    .tab-btn {\n      color: #999;\n      font-size: 14px;\n      font-weight: 600;\n      padding: 12px;\n      width: 50%;\n      border: none;\n      border-bottom: 2px solid #e9e9e9;\n      background: none;\n      cursor: pointer;\n      &.active {\n        color: #000;\n        border-bottom: 2px solid #006ffd;\n      }\n    }\n  }\n  .search {\n    display: flex;\n    align-items: center;\n    justify-content: end;\n    > div {\n      width: 100%;\n    }\n    .clear-basket {\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      max-width: 42px;\n      min-width: 42px;\n      height: 42px;\n      border-radius: 10px;\n      background: #f5f5f5;\n      margin-left: 30px;\n      cursor: pointer;\n      svg path {\n        fill: #999;\n      }\n    }\n  }\n  .product-card {\n    position: relative;\n    padding: 10px;\n    border-radius: 16px;\n    background: #f5f5f5;\n    cursor: pointer;\n    .amount {\n      position: absolute;\n      top: -10px;\n      left: -10px;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      font-size: 12px;\n      font-weight: 600;\n      min-width: 25px;\n      padding: 5px;\n      height: 25px;\n      border-radius: 50%;\n      background-color: #006ffd;\n      color: #fff;\n    }\n    .name {\n      display: -webkit-box;\n      -webkit-line-clamp: 1;\n      -webkit-box-orient: vertical;\n      color: #454545;\n      font-size: 14px;\n      line-height: 20px;\n      overflow: hidden;\n    }\n    .price {\n      display: block;\n      font-size: 14px;\n      margin-top: 10px;\n      font-weight: 600;\n    }\n    .in-stock {\n      font-size: 12px;\n      color: #999;\n    }\n  }\n  .basket-item {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    padding: 8px 0;\n    border-bottom: 1px solid #e9e9e9;\n    .name {\n      font-size: 14px;\n      color: #454545;\n      padding-left: 10px;\n      width: 75%;\n      word-wrap: break-word;\n    }\n    .action {\n      display: flex;\n      align-items: center;\n      span {\n        border-radius: 8px;\n        background: #f5f5f5;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n      }\n      .icon {\n        width: 34px;\n        height: 34px;\n        cursor: pointer;\n      }\n      .amount-input {\n        display: block;\n        height: 34px;\n        padding: 0 10px;\n        width: 64px;\n        margin: 0 8px;\n        border-radius: 8px;\n        background: #f5f5f5;\n        border: none;\n        font-size: 16px;\n        font-weight: 600;\n        text-align: center;\n      }\n    }\n  }\n"])));var te=t(24858),ie=t(71245),oe=t(96446),ae=t(95720),le=t(42497),re=t(68641);const de=e=>{let{totalItems:n,itemsPerPage:t,allParams:i,setSearchParams:o}=e;const[a,l]=(0,f.useState)(parseInt(i.page||"1")),r=Math.ceil(n/t),d=e=>{e<1||e>r||(l(e),o((0,C.A)((0,C.A)({},i),{},{page:e.toString(),limit:t.toString()})))};return(0,f.useEffect)(()=>{o((0,C.A)((0,C.A)({},i),{},{page:a.toString(),limit:t.toString()}))},[a]),(0,x.jsxs)("div",{className:"pagination flex items-center justify-center space-x-3 mt-4",children:[(0,x.jsx)("button",{onClick:()=>d(a-1),disabled:a<=1,className:"pagination-btn p-1 bg-gray-300 rounded-lg text-gray-700 disabled:opacity-50",children:(0,x.jsx)(re.A,{})}),(0,x.jsxs)("span",{className:"text-lg",children:["Page ",a," of ",r]}),(0,x.jsx)("button",{onClick:()=>d(a+1),disabled:a>=r,className:"pagination-btn p-1 bg-gray-300 rounded-lg text-gray-700 disabled:opacity-50",children:(0,x.jsx)(le.A,{})})]})},se=e=>{var n,t,i,o,l,d,s;let{basketItems:u,setBasketItems:m}=e;const[p,v]=(0,f.useState)("product"),[h,g]=(0,f.useState)(!1),[j,A]=(0,f.useState)(null),[k,w]=(0,f.useState)([]),I=(0,B.A)(),{control:z,watch:_}=(0,te.mN)(),[L,E]=(0,f.useState)(I.search||""),{debouncedValue:T}=(0,P.A)(L,500),{t:R}=(0,b.Bd)(),[O,q]=(0,M.ok)(),F=(0,y.G)(e=>e.tableState.render),V=localStorage.getItem("i18nextLng")||"uz",[U,G]=(0,f.useState)({page:O.get("page")||1,limit:O.get("limit")||10,search:O.get("search")||""});(0,f.useEffect)(()=>{q((0,C.A)((0,C.A)({},I),{},{search:L||"",page:L?"1":I.page||"1",limit:I.limit||"10"}))},[T]);const{state:{data:Y}}=(0,ae.A)(),{data:Q,mutate:W}=(0,r.L2)("product/paging","post",{onSuccess:e=>{G((0,C.A)((0,C.A)({},I),{},{search:T||"",page:L?"1":I.page||"1",limit:I.limit||"10"}))},onError:e=>{console.error("Error creating product:",e)}});(0,f.useEffect)(()=>{W((0,C.A)((0,C.A)({},U),I))},[F,T,O]);const X=(e,n,t)=>{const i=null===u||void 0===u?void 0:u.find(n=>n._id===(null===e||void 0===e?void 0:e._id));if(i)return"minus"===n&&1===i.amount?m(e=>e.filter(e=>e._id!==i._id)):m(o=>o.map(o=>{if(o._id===(null===e||void 0===e?void 0:e._id)){const a=o.amount;return(0,C.A)((0,C.A)({},o),{},{amount:t?"noValue"===t?"":Number(t)<=e.inStock?Number(t):a:n?"minus"===n&&a>1?a-1:"plus"===n&&i.amount<e.inStock?a+1:a:i.amount<e.inStock?a+1:a})}return o}));e&&m(n=>[...n,(0,C.A)((0,C.A)({},e),{},{amount:1,salom:"hello"})])},Z=()=>{g(!1),A(null),w([])};return(0,x.jsxs)(ne,{children:[(0,x.jsxs)("div",{className:"tab",children:[(0,x.jsx)("button",{className:"tab-btn ".concat("product"===p&&"active"),onClick:()=>v("product"),children:R("order.products")}),(0,x.jsx)("button",{className:"tab-btn ".concat("basket"===p&&"active"),onClick:()=>v("basket"),children:R("order.basket")})]}),(0,x.jsxs)("div",{className:"mb-3 search",children:["product"===p&&(0,x.jsx)(N.DO,{value:L,onChange:e=>{var n;E(null===e||void 0===e||null===(n=e.target)||void 0===n?void 0:n.value)}}),"basket"===p&&(0,x.jsx)("div",{className:"clear-basket",onClick:()=>m([]),children:(0,x.jsx)(c.d7,{})})]}),"product"===p&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(a.Ay,{container:!0,spacing:2,children:null===Q||void 0===Q||null===(n=Q.data)||void 0===n||null===(t=n.data)||void 0===t?void 0:t.map(e=>{const n=u.find(n=>n._id===e._id);return(0,x.jsx)(a.Ay,{item:!0,md:4,children:(0,x.jsxs)("div",{className:"product-card",style:{border:"1px solid #e0e0e0",borderRadius:"8px",padding:"16px",backgroundColor:"#F5F5F5",display:"flex",flexDirection:"column",alignItems:"center",gap:"12px",height:"170px",justifyContent:"space-between",transition:"transform 0.2s ease"},onClick:()=>{var n;(null===(n=e.attributes)||void 0===n?void 0:n.length)>0?(e=>{A(e),g(!0)})(e):X(e)},onMouseEnter:e=>e.currentTarget.style.transform="scale(1.02)",onMouseLeave:e=>e.currentTarget.style.transform="scale(1)",children:[n&&(0,x.jsxs)("div",{style:{background:"#f44336",color:"#fff",padding:"4px 8px",borderRadius:"12px",fontSize:"12px",position:"absolute",top:"12px",right:"12px"},children:[n.amount," dona"]}),(0,x.jsx)("div",{style:{fontWeight:"600",fontSize:"16px",color:"#333",textAlign:"center"},children:e.name}),(0,x.jsxs)("div",{style:{width:"100%",display:"block",justifyContent:"space-between",fontSize:"14px",textAlign:"center"},children:[!1===(null===e||void 0===e?void 0:e.discountEnabled)?"":(0,x.jsxs)("div",{style:{color:"#ed0e0e"},children:[R("order.original_price"),":",(0,x.jsxs)("s",{style:{marginLeft:"4px"},children:[(0,S.j)(e.price)," ",(0,D.get)(Y,"currency","uzs")]})]}),(null===e||void 0===e?void 0:e.discountEnabled)&&(0,x.jsxs)("div",{style:{color:"#4caf50",fontWeight:"bold"},children:[R("common.discount"),": ",(0,S.j)(null===e||void 0===e?void 0:e.discountValue)," ","percent"===(null===e||void 0===e?void 0:e.discountType)?"%":(0,D.get)(Y,"currency","uzs")]})]}),(0,x.jsxs)("div",{style:{fontSize:"18px",fontWeight:"700",color:"#000"},children:[(0,S.j)(e.salePrice)," ",(0,D.get)(Y,"currency","uzs")]}),(0,x.jsxs)("div",{style:{fontSize:"12px",color:"#757575",marginTop:"8px"},children:[R("order.in_warehouse"),": ",(0,S.j)(e.inStock)]})]})},e._id)})}),(0,x.jsx)(a.Ay,{children:(0,x.jsx)(de,{totalItems:null===Q||void 0===Q||null===(i=Q.data)||void 0===i?void 0:i.total,itemsPerPage:+I.limit||10,allParams:I,setSearchParams:q})})]}),(0,x.jsx)(ie.A,{open:h,onClose:Z,"aria-labelledby":"modal-title","aria-describedby":"modal-description",children:(0,x.jsxs)(oe.A,{sx:{padding:"20px",background:"#fff",borderRadius:"8px",maxWidth:"500px",margin:"auto",boxShadow:"0 4px 10px rgba(0, 0, 0, 0.1)"},children:[(0,x.jsx)("h2",{id:"modal-title",style:{textAlign:"center",marginBottom:"20px",fontSize:"20px",color:"#333"},children:R("general.again_choose")}),null===j||void 0===j||null===(o=j.attributes)||void 0===o?void 0:o.map((e,n)=>{var t,i;return(0,x.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,x.jsx)("h3",{style:{fontSize:"16px",fontWeight:"600",color:"#333",marginBottom:"10px",borderBottom:"1px solid #eee",paddingBottom:"5px"},children:(null===e||void 0===e||null===(t=e.attribute)||void 0===t||null===(i=t.name)||void 0===i?void 0:i[V])||""}),(0,x.jsx)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px",marginTop:"10px"},children:e.items.map((n,t)=>(0,x.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",padding:"10px",border:k.some(t=>{var i;return t.attributeId===(null===e||void 0===e||null===(i=e.attribute)||void 0===i?void 0:i._id)&&t.attributeItem===n.attributeItem})?"2px solid #2196f3":"1px solid #ddd",borderRadius:"8px",backgroundColor:k.some(t=>{var i;return t.attributeId===(null===e||void 0===e||null===(i=e.attribute)||void 0===i?void 0:i._id)&&t.attributeItem===n.attributeItem})?"#f1f9ff":"#fff",cursor:"pointer",transition:"all 0.3s ease"},onClick:()=>{var t,i,o;return i=n,o=null===e||void 0===e||null===(t=e.attribute)||void 0===t?void 0:t._id,void w(e=>{const n=[...e.filter(e=>e.attributeId!==o),(0,C.A)((0,C.A)({},i),{},{attributeId:o})];return console.log("Updated Variants:",n),n})},children:[(0,x.jsx)("div",{style:{fontWeight:"500",fontSize:"14px",color:"#333"},children:n.attributeItem}),(0,x.jsxs)("div",{style:{fontSize:"12px",color:"#888",marginTop:"5px"},children:["+ ",(0,S.j)(n.amount)," ",(0,D.get)(Y,"currency","uzs")]})]},t))})]},n)}),(0,x.jsx)("div",{style:{marginTop:"30px",display:"flex",justifyContent:"center",alignItems:"center"},children:(0,x.jsx)("button",{onClick:()=>{if(j&&k){const e=(0,C.A)((0,C.A)({},j),{},{variants:k.map(e=>({attributeId:e.attributeId,attributeItem:e.attributeItem}))});X(e),Z()}},style:{padding:"10px 20px",background:k.length===(null===j||void 0===j||null===(l=j.attributes)||void 0===l?void 0:l.length)?"#4caf50":"#ddd",color:"#fff",border:"none",borderRadius:"4px",cursor:k.length===(null===j||void 0===j||null===(d=j.attributes)||void 0===d?void 0:d.length)?"pointer":"not-allowed",fontSize:"16px",fontWeight:"600",transition:"background-color 0.3s ease"},disabled:k.length!==(null===j||void 0===j||null===(s=j.attributes)||void 0===s?void 0:s.length),children:R("general.add_basket")})})]})}),"basket"===p&&(0,x.jsx)("div",{children:null===u||void 0===u?void 0:u.map(e=>{var n,t;return(0,x.jsxs)("div",{className:"basket-item",children:[(0,x.jsxs)("div",{className:"flex gap-2",children:[(0,x.jsx)("span",{className:"",children:e.name}),(null===e||void 0===e||null===(n=e.variants)||void 0===n?void 0:n.length)>0&&(0,x.jsx)("div",{className:"variant-info flex",children:null===e||void 0===e||null===(t=e.variants)||void 0===t?void 0:t.map((e,n)=>(0,x.jsx)("div",{className:"variant-item flex",children:(0,x.jsxs)("span",{className:"variant-name ml-1",children:["-",e.attributeItem]})},n))})]}),(0,x.jsxs)("div",{className:"action",children:[(0,x.jsx)("span",{className:"icon",onClick:()=>X(e,"minus"),children:(0,x.jsx)(c.QG,{})}),(0,x.jsx)("input",{type:"text",className:"amount-input",value:e.amount,onChange:n=>X(e,"",n.target.value||"noValue")}),(0,x.jsx)("span",{className:"icon",onClick:()=>X(e,"plus"),children:(0,x.jsx)(c.c1,{})})]})]},e._id)})})]})};var ce,ue;const me=p.default.div(ce||(ce=(0,m.A)(["\n  border-radius: 12px;\n  background: #fff;\n  box-shadow: 0px 0px 4px 0px rgba(0, 0, 0, 0.07);\n  padding: 16px;\n  max-height: calc(100vh - 110px);\n  overflow: auto;\n  .item {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    margin-bottom: 12px;\n    .key {\n      font-size: 14px;\n    }\n    .value {\n      font-size: 14px;\n      font-weight: 600;\n    }\n    &:last-of-type {\n      .key {\n        font-weight: 600;\n      }\n    }\n  }\n  .submit-btn {\n    width: 100%;\n  }\n"]))),pe=p.default.div(ue||(ue=(0,m.A)(["\n  width: 860px;\n  height: 500px;\n  background-color: #fff;\n  border-radius: 24px;\n  overflow: hidden;\n  .modal-form {\n    display: flex;\n    flex-direction: column;\n    height: 100%;\n    padding: 24px;\n    .title {\n      display: flex;\n      align-items: center;\n      margin-bottom: 24px;\n      h2 {\n        font-size: 20px;\n        font-weight: 600;\n        margin-left: 23px;\n      }\n    }\n    .address-options {\n      position: absolute;\n      box-shadow: 0px 2px 10px rgba(0, 0, 0, 0.1);\n      padding: 10px 0;\n      border-radius: 10px;\n      background-color: #fff;\n      max-height: 300px;\n      overflow: auto;\n      z-index: 1;\n      .option {\n        padding: 8px 15px;\n        cursor: pointer;\n        &:hover {\n          background-color: #f5f5f5;\n        }\n      }\n    }\n    .save-btn {\n      width: 100%;\n      margin-top: auto;\n    }\n  }\n"])));var ve=t(30802),xe=t(6790),he=t(47503),ge=t(37216);const fe=e=>{var n,t,i,o,a,l,d,s,c,u;let{getCoordinate:m,center:p,height:v,order:h}=e;const[g,b]=(0,f.useState)(p),j=(0,f.useRef)(null),{reset:y}=(0,te.mN)(),{data:A,status:N,refetch:k}=(0,r.gf)("settings-general",{},{onSuccess(e){let{data:n}=e;localStorage.setItem("settings",JSON.stringify(n))}}),{data:w,status:S}=(0,r.gf)("store/get",{},{suspense:!1});(0,f.useEffect)(()=>{"success"===N&&y()},[N]),(0,f.useEffect)(()=>{"success"===S&&y()},[S]);const I={latitude:null===w||void 0===w||null===(n=w.data)||void 0===n||null===(t=n.addressLocation)||void 0===t?void 0:t.latitude,longitude:null===w||void 0===w||null===(i=w.data)||void 0===i||null===(o=i.addressLocation)||void 0===o?void 0:o.longitude},C=1e3*(null===A||void 0===A||null===(a=A.data)||void 0===a?void 0:a.storeRadius);(0,f.useEffect)(()=>{p&&(b(p),j.current&&j.current.setCenter([p.latitude,p.longitude]))},[p]);const z=(e,n)=>{const t=e.latitude*Math.PI/180,i=n.latitude*Math.PI/180,o=(n.latitude-e.latitude)*Math.PI/180,a=(n.longitude-e.longitude)*Math.PI/180,l=Math.sin(o/2)*Math.sin(o/2)+Math.cos(t)*Math.cos(i)*Math.sin(a/2)*Math.sin(a/2);return 6371e3*(2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l)))};return(0,x.jsx)(ge.Xi,{children:(0,x.jsxs)(ge.T5,{width:"100%",height:v||"500px",defaultState:{center:null!==p&&void 0!==p&&p.latitude?[p.latitude,p.longitude]:null!==h&&void 0!==h&&null!==(l=h.addressLocation)&&void 0!==l&&l.latitude?[null===h||void 0===h||null===(d=h.addressLocation)||void 0===d?void 0:d.latitude,null===h||void 0===h||null===(s=h.addressLocation)||void 0===s?void 0:s.longitude]:[I.latitude,I.longitude],zoom:14,behaviors:["default","scrollZoom"]},instanceRef:e=>{j.current=e},onClick:e=>{const n={latitude:e.get("coords")[0],longitude:e.get("coords")[1]};var t;z(n,I)<=C?(b(n),m(n)):he.oR.error("Kechirasiz, siz faqat do'kondan ".concat(null===A||void 0===A||null===(t=A.data)||void 0===t?void 0:t.storeRadius," km radius ichida joy tanlay olasiz."))},children:[(0,x.jsx)(ge.Ro,{geometry:null!=(null===g||void 0===g?void 0:g.latitude)&&null!=(null===g||void 0===g?void 0:g.longitude)?[g.latitude,g.longitude]:[null===h||void 0===h||null===(c=h.addressLocation)||void 0===c?void 0:c.latitude,null===h||void 0===h||null===(u=h.addressLocation)||void 0===u?void 0:u.longitude]}),(0,x.jsx)(ge.T3,{}),(0,x.jsx)(ge._3,{options:{float:"left"},onClick:()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(e=>{const n={latitude:e.coords.latitude,longitude:e.coords.longitude};var t;z(n,I)<=C?(b(n),m(n),j.current&&j.current.setCenter([n.latitude,n.longitude],14)):he.oR.error("Kechirasiz, siz faqat do'kondan ".concat(null===A||void 0===A||null===(t=A.data)||void 0===t?void 0:t.storeRadius," km radius ichida joy tanlay olasiz."))},e=>{console.error("Geolocation error:",e)}):console.error("Geolocation is not supported by this browser.")}}),(0,x.jsx)(ge.c3,{options:{float:"right"}}),(0,x.jsx)(ge.pj,{options:{float:"right"}})]})})};var be,je,ye=t(53193),Ae=t(72221);const Ne=(0,p.default)(Ae.A)(be||(be=(0,m.A)(["\n  height: 45px;\n  .MuiSelect-select {\n    background-color: #fff;\n    padding: 0px 12px;\n    height: 45px !important;\n    border-radius: 10px !important;\n    border: 1px solid #d9d9d9;\n    line-height: 48px;\n  }\n  & ~ .text-error {\n    position: absolute;\n    bottom: -20px;\n  }\n"]))),ke=p.default.div(je||(je=(0,m.A)(["\n  padding: 6px 0;\n  label {\n    color: #232323;\n    font-weight: 500;\n    font-size: 14px;\n  }\n"])));const we=e=>({style:{color:e?"initial":"white"}}),Se=function(e){let{control:n,options:t=[],name:i,label:o,disabled:a=!1,optionsUrl:l,className:d,placeholder:s,setValue:c,defaultValue:u="",filterOptions:m,setAdditionalItem:p,rules:v={required:{value:!0,message:"Majburiy"}},onChange:h}=e;const{t:g}=(0,b.Bd)(),{mutate:j,data:y,reset:A,status:N}=(0,r.L2)(l||"","post",{onSuccess(){console.log("success")}});let k;(0,f.useEffect)(()=>{j({optionsFromUrl:y})},[j]),(0,f.useEffect)(()=>{y?console.log("Fetched optionsFromUrl:"):console.warn("optionsFromUrl is undefined")},[y]),y&&(k=y.data);const w=(null!==y&&void 0!==y&&y.data.data&&Array.isArray(y.data.data)?y.data.data:t).map(e=>(0,C.A)((0,C.A)({},e),{},{name:e.firstName?"".concat(e.firstName," ").concat(e.lastName):e.carBrand?"Brand: ".concat(e.carBrand,", Model: ").concat(e.carModel):"Number: ".concat(e.carNumber)}));return(0,x.jsxs)(x.Fragment,{children:[o&&(0,x.jsxs)(ke,{className:"select-label",children:[(0,x.jsx)("label",{children:o}),(0,x.jsx)("span",{children:o&&null!==v&&void 0!==v&&v.required?(0,x.jsx)("span",{className:"text-error mt-1",children:"*"}):null})]}),(0,x.jsx)(ye.A,{fullWidth:!0,variant:"outlined",children:(0,x.jsx)(te.xI,{name:i,control:n,rules:v,render:e=>{var n;let{field:{onChange:t,value:o,ref:l,onBlur:r},fieldState:d}=e;const s=!!d.error;return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(Ne,{onChange:e=>{t(e),null===h||void 0===h||h(e.target.value,null===w||void 0===w?void 0:w.find(n=>{var t;return(null===n||void 0===n?void 0:n._id)===(null===e||void 0===e||null===(t=e.target)||void 0===t?void 0:t.value)}))},value:o,labelId:i,id:i,ref:l,onBlur:r,color:d.error?"error":void 0,SelectDisplayProps:we(o),disabled:a,sx:{"& fieldset":{border:"none"}},children:(null===w||void 0===w?void 0:w.length)>0?null===(n=m?m(w):w)||void 0===n?void 0:n.map(e=>(0,x.jsxs)(V.A,{value:e._id,children:[e.fullName,null===p||void 0===p?void 0:p(e.fullName)]},e._id)):(0,x.jsx)(V.A,{disabled:!0,value:void 0,children:"Hech narsa topilmadi\u26d4"})}),s&&(0,x.jsx)("h6",{className:"text-error mt-1",children:g("general.required")})]})},defaultValue:u})})]})},Ie=e=>{var n,t,i,l,d,s,u,m,p,v,h,g,j,y,A,k,I;let{basketItems:z,formStore:_,order:L}=e;const[E,B]=(0,f.useState)(!1),[M,T]=(0,f.useState)(!1),[R,O]=(0,f.useState)(),[q,F]=(0,f.useState)(""),{t:V}=(0,b.Bd)(),{control:U,setValue:G,handleSubmit:Y,watch:Q,setError:W,reset:X,getValues:Z}=(0,te.mN)(),{debouncedValue:K}=(0,P.A)(q,1e3),H=(0,o.Zp)(),{id:J}=(0,o.g)(),$=z.reduce((e,n)=>e+n.salePrice*n.amount,0),[ee,ne]=(0,f.useState)(""),{state:{data:ie}}=(0,ae.A)(),{mutate:oe,data:le}=(0,r.L2)("address/by-name","post",{onSuccess(){B(!0)},onError(e){console.error("Error fetching address:",e)}});(0,f.useEffect)(()=>{"string"===typeof q&&q.trim()&&oe({name:q})},[q]);const{mutate:re,status:de}=(0,r.L2)("order/create","post",{onSuccess(){H("/order")}}),{mutate:se}=(0,r.L2)("address/by-point","post",{onSuccess(e){let{data:n}=e;_?(null===_||void 0===_||_.setValue("addressName",null===n||void 0===n?void 0:n.name),null===_||void 0===_||_.setValue("addressLocation",R),null===_||void 0===_||_.setError("addressName",{})):(G("addressName",null===n||void 0===n?void 0:n.name),G("addressLocation",R),W("addressName",{}))},onError(e){console.error("Error fetching address:",e)}});(0,f.useEffect)(()=>{null!==R&&void 0!==R&&R.latitude&&null!==R&&void 0!==R&&R.longitude?se({latitude:R.latitude,longitude:R.longitude}):console.error("Coordinates are missing")},[se,R]),console.log(z);const{data:ce}=(0,r.gf)("order/get-by-id/".concat(J),{},{enabled:!!J}),ue=null===ce||void 0===ce||null===(n=ce.data)||void 0===n?void 0:n.courierId,{mutate:ge,data:be,status:je,isLoading:ye}=(0,r.L2)("order/set-courier","post",{onSuccess(e){ne(e.data.courierId)},onError(e){console.error("API Error:",e)}}),{mutate:Ae,data:Ne,status:ke,isLoading:we}=(0,r.L2)("order/calculate","post",{onSuccess(e){},onError(e){console.error("API Error:",e)}}),Ie=()=>{const e=(null===_||void 0===_?void 0:_.getValues("phoneNumber"))||Z("phoneNumber");Ae({paymentType:"cash",addressLocation:{latitude:null===R||void 0===R?void 0:R.latitude,longitude:null===R||void 0===R?void 0:R.longitude},items:z.map(e=>{var n;return{productId:e._id,amount:e.amount,attributes:null===e||void 0===e||null===(n=e.variants)||void 0===n?void 0:n.map(e=>({attributeId:e.attributeId,attributeItem:e.attributeItem}))}}),phoneNumber:e})};return(0,f.useEffect)(()=>{z.length>0&&Ie()},[z,_,R]),(0,x.jsxs)(me,{children:[!J&&(0,x.jsx)("h3",{className:"mb-3",children:V("order.formalization")}),(0,x.jsxs)("form",{onSubmit:Y(e=>{const n=Q("addressLocation");if(!n||!n.latitude||!n.longitude)return void he.oR.error("Manzil noto'g'ri kiritilgan yoki xaritada topilmadi!");if(!z.length)return he.oR.warning(V("order.chooseProduct"));if(z.find(e=>!(e.amount>0)))return he.oR.warning(V("order.validAmount"));const t=(0,D.get)(ie,"orderMinimumPrice",0);if($<t)return he.oR.warning("".concat(V("order.minimum_order_amount")," ").concat((0,S.j)(t)," ").concat((0,D.get)(ie,"currency","uzs")));const i=(0,C.A)((0,C.A)({},e),{},{deliveryDate:w()(e.deliveryDate).format(),items:z.map(e=>{var n;return{productId:e._id,amount:e.amount,attributes:null===e||void 0===e||null===(n=e.variants)||void 0===n?void 0:n.map(e=>({attributeId:e.attributeId,attributeItem:e.attributeItem}))}}),addressLocation:{latitude:null===R||void 0===R?void 0:R.latitude,longitude:null===R||void 0===R?void 0:R.longitude}});re(i)}),children:[(0,x.jsxs)(a.Ay,{container:!0,spacing:2,children:[(0,x.jsx)(a.Ay,{item:!0,sm:12,children:(0,x.jsxs)("div",{onClick:()=>T(!0),children:[(0,x.jsx)(N.ks,{control:_?_.control:U,name:"addressName",label:V("order.deliveryAddress"),placeholder:"Yetkazib berish manzili",searchIcon:!0,onCustomChange:e=>{F(e)},disabled:"completed"===(null===L||void 0===L||null===(t=L.state)||void 0===t?void 0:t.state)}),(0,x.jsx)("div",{className:"address-options",children:E&&(null===le||void 0===le||null===(i=le.data)||void 0===i?void 0:i.map(e=>(0,x.jsx)("div",{className:"option",onClick:()=>{G("addressName",e.name),G("addressLocation",{latitude:e.latitude,longitude:e.longitude,name:e.name}),O({latitude:e.latitude,longitude:e.longitude,name:e.name}),B(!1)},children:e.name})))})]})}),(0,x.jsx)(a.Ay,{item:!0,md:6,children:(0,x.jsx)(N.ks,{control:_?null===_||void 0===_?void 0:_.control:U,name:"houseNumber",rules:{required:!1},label:V("order.home_number"),disabled:"completed"===(null===L||void 0===L||null===(l=L.state)||void 0===l?void 0:l.state)})}),(0,x.jsx)(a.Ay,{item:!0,md:6,children:(0,x.jsx)(N.ks,{control:_?null===_||void 0===_?void 0:_.control:U,name:"entrance",rules:{required:!1},label:V("order.entrance"),disabled:"completed"===(null===L||void 0===L||null===(d=L.state)||void 0===d?void 0:d.state)})}),(0,x.jsx)(a.Ay,{item:!0,md:6,children:(0,x.jsx)(N.ks,{control:_?null===_||void 0===_?void 0:_.control:U,name:"floor",rules:{required:!1},label:V("order.floor"),disabled:"completed"===(null===L||void 0===L||null===(s=L.state)||void 0===s?void 0:s.state)})}),(0,x.jsx)(a.Ay,{item:!0,md:6,children:(0,x.jsx)(N.ks,{control:_?null===_||void 0===_?void 0:_.control:U,name:"apartmentNumber",rules:{required:!1},label:V("order.apartment_number"),disabled:"completed"===(null===L||void 0===L||null===(u=L.state)||void 0===u?void 0:u.state)})}),(0,x.jsx)(a.Ay,{item:!0,sm:12,children:(0,x.jsx)(N.ks,{control:_?null===_||void 0===_?void 0:_.control:U,name:"receiverFirstName",label:V("order.receiver"),disabled:"completed"===(null===L||void 0===L||null===(m=L.state)||void 0===m?void 0:m.state)})}),(0,x.jsx)(a.Ay,{item:!0,sm:12,children:(0,x.jsx)(N.LR,{control:_?null===_||void 0===_?void 0:_.control:U,name:"phoneNumber",label:V("common.phoneNumber"),disabled:"completed"===(null===L||void 0===L||null===(p=L.state)||void 0===p?void 0:p.state),onChange:Ie})}),(0,x.jsx)(a.Ay,{item:!0,sm:12,children:(0,x.jsx)(N.eB,{label:V("common.date"),control:_?null===_||void 0===_?void 0:_.control:U,name:"deliveryDate",minDate:w()(new Date),defaultValue:w()(new Date),disabled:"completed"===(null===L||void 0===L||null===(v=L.state)||void 0===v?void 0:v.state)})}),(0,x.jsx)(a.Ay,{item:!0,sm:12,className:"w-full",children:(0,x.jsx)(N.RZ,{control:_?null===_||void 0===_?void 0:_.control:U,name:"paymentType",options:xe.J1,defaultValue:"cash",label:V("common.paymentType"),disabled:"completed"===(null===L||void 0===L||null===(h=L.state)||void 0===h?void 0:h.state),onChange:Ie})}),J&&(0,x.jsx)(a.Ay,{item:!0,sm:12,children:(0,x.jsx)(Se,{control:_?null===_||void 0===_?void 0:_.control:U,name:"setCourier",label:V("common.courier"),optionsUrl:"courier/paging",value:ee,defaultValue:ue,onChange:e=>{ne(e),ge({courierId:e,_id:J})},rules:{required:!1},disabled:"completed"===(null===L||void 0===L||null===(g=L.state)||void 0===g?void 0:g.state)})}),(0,x.jsxs)(a.Ay,{item:!0,sm:12,children:[(0,x.jsx)("label",{className:"custom-label",children:V("common.description")}),(0,x.jsx)(ve.A,{minRows:3,value:null===_||void 0===_?void 0:_.watch("comment"),onChange:e=>{const n=e.target.value;_?null===_||void 0===_||_.setValue("comment",n):G("comment",n)},style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #ccc",fontSize:"1rem"}})]})]}),!J&&(0,x.jsxs)("div",{className:"info",children:[(0,x.jsxs)("div",{className:"item",children:[(0,x.jsxs)("span",{className:"key",children:[V("order.allProducts"),":"]}),(0,x.jsxs)("span",{className:"value",children:[(0,S.j)((null===Ne||void 0===Ne||null===(j=Ne.data)||void 0===j?void 0:j.itemPrice)||0)," ",(0,D.get)(ie,"currency","uzs")]})]}),(0,x.jsxs)("div",{className:"item",children:[(0,x.jsxs)("span",{className:"key",children:[V("settings.discounts"),":"]}),(0,x.jsxs)("span",{className:"value",children:[(0,S.j)((null===Ne||void 0===Ne||null===(y=Ne.data)||void 0===y?void 0:y.discount)||0)," ",(0,D.get)(ie,"currency","uzs")]})]}),(0,x.jsxs)("div",{className:"item",children:[(0,x.jsxs)("span",{className:"key",children:[V("order.deliveryPrice"),":"]}),(0,x.jsxs)("span",{className:"value",children:[(0,S.j)((null===Ne||void 0===Ne||null===(A=Ne.data)||void 0===A?void 0:A.deliveryPrice)||0)," ",(0,D.get)(ie,"currency","uzs")]})]}),(0,x.jsxs)("div",{className:"item",children:[(0,x.jsxs)("span",{className:"key",children:[V("order.totalPrice"),":"]}),(0,x.jsxs)("span",{className:"value",children:[(0,S.j)((null===Ne||void 0===Ne||null===(k=Ne.data)||void 0===k?void 0:k.totalPrice)||0)," ",(0,D.get)(ie,"currency","uzs")]})]})]}),!J&&(0,x.jsx)(N.O6,{variant:"contained",title:V("order.formalization"),className:"submit-btn",type:"submit",disabled:"loading"===de})]}),(0,x.jsx)(N.aF,{setOpen:T,open:M,children:(0,x.jsx)(pe,{children:(0,x.jsxs)(a.Ay,{container:!0,height:"100%",children:[(0,x.jsx)(a.Ay,{item:!0,md:6,children:(0,x.jsxs)("div",{className:"modal-form",children:[(0,x.jsxs)("div",{className:"title",children:[(0,x.jsx)("span",{onClick:()=>T(!1),children:(0,x.jsx)(c.IN,{})}),(0,x.jsx)("h2",{children:V("order.add_new_address")})]}),(0,x.jsxs)(a.Ay,{container:!0,spacing:2,children:[(0,x.jsxs)(a.Ay,{item:!0,md:12,position:"relative",children:[(0,x.jsx)(N.ks,{control:_?_.control:U,name:"addressName",placeholder:V("order.shipping_address"),searchIcon:!0,onCustomChange:e=>{F(e)}}),(0,x.jsx)("div",{className:"address-options",children:E&&(null===le||void 0===le||null===(I=le.data)||void 0===I?void 0:I.map(e=>(0,x.jsx)("div",{className:"option",onClick:()=>{G("addressName",e.name),G("addressLocation",{latitude:e.latitude,longitude:e.longitude,name:e.name}),O({latitude:e.latitude,longitude:e.longitude,name:e.name}),B(!1)},children:e.name})))})]}),(0,x.jsx)(a.Ay,{item:!0,md:6,children:(0,x.jsx)(N.ks,{control:_?null===_||void 0===_?void 0:_.control:U,name:"houseNumber",rules:{required:!1},label:V("order.home_number")})}),(0,x.jsx)(a.Ay,{item:!0,md:6,children:(0,x.jsx)(N.ks,{control:_?null===_||void 0===_?void 0:_.control:U,name:"entrance",rules:{required:!1},label:V("order.entrance")})}),(0,x.jsx)(a.Ay,{item:!0,md:6,children:(0,x.jsx)(N.ks,{control:_?null===_||void 0===_?void 0:_.control:U,name:"floor",rules:{required:!1},label:V("order.floor")})}),(0,x.jsx)(a.Ay,{item:!0,md:6,children:(0,x.jsx)(N.ks,{control:_?null===_||void 0===_?void 0:_.control:U,name:"apartmentNumber",label:V("order.apartment_number"),rules:{required:!1}})})]}),(0,x.jsx)(N.O6,{title:V("FORMDRAWER.SAVE"),variant:"contained",color:"success",className:"save-btn",onClick:()=>{const e=Q("addressLocation");e&&e.latitude&&e.longitude?T(!1):he.oR.error("Manzil noto'g'ri kiritilgan yoki xaritada topilmadi!")}})]})}),(0,x.jsx)(a.Ay,{item:!0,md:6,children:(0,x.jsx)("div",{className:"map",children:(0,x.jsx)(fe,{getCoordinate:O,center:Q("addressLocation"),order:L})})})]})})})]})},Ce=()=>{const[e,n]=(0,f.useState)([]);return(0,x.jsx)($,{children:(0,x.jsxs)(a.Ay,{container:!0,spacing:3,children:[(0,x.jsx)(a.Ay,{item:!0,md:8,children:(0,x.jsx)(se,{basketItems:e,setBasketItems:n})}),(0,x.jsx)(a.Ay,{item:!0,md:4,children:(0,x.jsx)(Ie,{basketItems:e})})]})})};var ze;const _e=p.default.div(ze||(ze=(0,m.A)(["\n  padding: 10px 0;\n  .top {\n    display: flex;\n    align-items: center;\n    width: 100%;\n    .state-select {\n      min-width: 180px;\n      margin-top: -3px;\n      div {\n        width: 100% !important;\n      }\n      margin-right: 15px;\n    }\n    .payment-type {\n      display: flex;\n      align-items: center;\n      padding: 4px 12px;\n      border-radius: 12px;\n      background: #fff;\n      width: 100%;\n      .type {\n        margin-left: 11px;\n        span {\n          color: #999;\n          font-size: 12px;\n          font-weight: 500;\n        }\n        h4 {\n          font-weight: 500;\n          font-size: 15px;\n        }\n      }\n      .state {\n        margin-left: auto;\n        color: #eb5757;\n        font-size: 15px;\n      }\n    }\n  }\n"])));var Le;const Ee=p.default.div(Le||(Le=(0,m.A)(["\n  border-radius: 12px;\n  background: #fff;\n  padding: 20px;\n  margin-top: 24px;\n  .steps {\n    position: relative;\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    padding-bottom: 20px;\n    border-bottom: 1px dashed #e9e9e9;\n    .icon {\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      width: 56px;\n      height: 56px;\n      border-radius: 50%;\n      background-color: #e9e9e9;\n      &.active {\n        background-color: #f7e14b;\n        .line {\n          background: #f7e14b;\n        }\n        svg path {\n          fill: #000;\n        }\n      }\n      .line {\n        position: absolute;\n        width: 21.5%;\n        height: 4px;\n        background: #f5f5f5;\n        transform: translateX(-71%);\n      }\n    }\n  }\n  .products {\n    min-height: 450px;\n    display: flex;\n    flex-direction: column;\n    justify-content: space-between;\n\n    .product_info {\n      width: 100%;\n      display: flex;\n      flex-direction: column;\n      gap: 12px;\n\n      li {\n        list-style: none;\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n        font-size: 18px;\n\n        span {\n          color: #999;\n        }\n\n        .main {\n          color: #000;\n          font-weight: 600;\n        }\n      }\n    }\n  }\n  .product {\n    display: flex;\n    align-items: center;\n    padding: 16px 0;\n    border-bottom: 1px dashed #e9e9e9;\n    &:last-of-type {\n      border-bottom: none;\n    }\n    .default-image {\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      width: 48px;\n      height: 48px;\n      border-radius: 12px;\n      background: #f3f3f8;\n      margin-right: 12px;\n      overflow: hidden;\n      img {\n        width: 100%;\n        height: 100%;\n        object-fit: cover;\n      }\n      svg {\n        width: 20px;\n        height: 20px;\n      }\n    }\n    .info {\n      .name {\n        display: block;\n        color: #454545;\n        font-size: 14px;\n        font-weight: 500;\n        margin-bottom: 5px;\n      }\n      .amount-price {\n        font-size: 14px;\n        font-weight: 700;\n      }\n    }\n    .action {\n      display: flex;\n      margin-left: auto;\n      span {\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        width: 36px;\n        height: 36px;\n        border-radius: 50%;\n        background: #f3f3f8;\n        cursor: pointer;\n        &:first-of-type {\n          margin-right: 16px;\n          svg {\n            width: 22px;\n            height: 22px;\n          }\n        }\n      }\n    }\n  }\n"])));var Pe=t(14695),Be=t(477);const De=e=>{var n;let{formStore:t,state:i,order:o}=e;const[a,l]=(0,f.useState)(0),[r,d]=(0,f.useState)(),{t:s}=(0,b.Bd)(),{state:{data:u}}=(0,ae.A)(),{fields:m,remove:p,update:v}=(0,te.jz)({control:null===t||void 0===t?void 0:t.control,name:"items"}),h="created"===i?1:"inProcess"===i?2:"inDelivery"===i?3:"completed"===i?4:0;return(0,x.jsxs)(Ee,{children:[(0,x.jsxs)("div",{className:"steps",style:{border:"none"},children:[(0,x.jsx)("span",{className:"icon ".concat(h&&"active"),children:(0,x.jsx)(c.Pz,{})}),(0,x.jsxs)("span",{className:"icon ".concat(h>1&&"active"),children:[(0,x.jsx)(c.O4,{}),(0,x.jsx)("div",{className:"line"})]}),(0,x.jsxs)("span",{className:"icon ".concat(h>2&&"active"),children:[(0,x.jsx)(c.X3,{}),(0,x.jsx)("div",{className:"line"})]}),(0,x.jsxs)("span",{className:"icon ".concat(h>3&&"active"),children:[(0,x.jsx)(c.iF,{}),(0,x.jsx)("div",{className:"line"})]})]}),(0,x.jsxs)("div",{className:"steps",children:[(0,x.jsx)("span",{className:"".concat(h&&"active"),children:(0,D.get)(o,"createdAt",0)?new Date(new Date(o.createdAt).getTime()+18e6).toISOString().slice(11,19):""}),(0,x.jsx)("span",{className:"".concat(h>1&&"active"),children:(0,D.get)(o,"acceptedAt",0)?new Date(new Date(o.acceptedAt).getTime()+18e6).toISOString().slice(11,19):""}),(0,x.jsx)("span",{className:"".concat(h>2&&"active"),children:(0,D.get)(o,"inDeliveryAt",0)?new Date(new Date(o.inDeliveryAt).getTime()+18e6).toISOString().slice(11,19):""}),(0,x.jsx)("span",{className:"".concat(h>3&&"active"),children:(0,D.get)(o,"completedAt",0)?new Date(new Date(o.completedAt).getTime()+18e6).toISOString().slice(11,19):""})]}),(0,x.jsxs)("div",{className:"products",children:[(0,x.jsx)("div",{children:null===m||void 0===m?void 0:m.map((e,n)=>{var t,o,a;return(0,x.jsxs)("div",{className:"product",children:[(0,x.jsx)("span",{className:"default-image",children:e.product.mainImage?(0,x.jsx)("img",{src:"http://165.227.153.9/"+e.product.mainImage.url,alt:"product"}):(0,x.jsx)(c.zG,{})}),(0,x.jsxs)("div",{className:"info",children:[(0,x.jsxs)("div",{className:"flex",children:[(0,x.jsx)("span",{className:"name",children:null===e||void 0===e||null===(t=e.product)||void 0===t?void 0:t.name}),(null===e||void 0===e||null===(o=e.attributes)||void 0===o?void 0:o.length)>0&&(0,x.jsx)("div",{className:"variant-info flex",children:null===e||void 0===e||null===(a=e.attributes)||void 0===a?void 0:a.map((e,n)=>(0,x.jsx)("div",{className:"variant-item flex",children:(0,x.jsx)("span",{className:"name ml-1",children:e.attributeItem})},n))})]}),(0,x.jsxs)("div",{className:"amount-price",children:[e.amount," x ",(0,S.j)(e.price)," ",(0,D.get)(u,"currency","uzs")]})]}),"completed"!==i&&"cancelled"!==i&&(0,x.jsx)("div",{className:"action",children:"inDelivery"!==i&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("span",{onClick:()=>l(n+1),children:(0,x.jsx)(c.d7,{})}),(0,x.jsx)("span",{onClick:()=>d((0,C.A)((0,C.A)({},e),{},{index:n})),children:(0,x.jsx)(Pe.A,{})})]})})]})})}),(0,x.jsxs)("ul",{className:"product_info",children:[(0,x.jsxs)("li",{children:[(0,x.jsx)("span",{children:"Barcha mahsulotlar:"})," ",(0,x.jsxs)("b",{children:[(0,S.j)((0,D.get)(o,"itemPrice",0))," ",(0,D.get)(u,"currency","uzs")]})]}),(0,x.jsxs)("li",{children:[(0,x.jsx)("span",{children:"Yetkazib berish:"}),(0,x.jsxs)("b",{children:[(0,S.j)((0,D.get)(o,"deliveryPrice",0))," ",(0,D.get)(u,"currency","uzs")]})]}),(0,x.jsxs)("li",{children:[(0,x.jsx)("span",{children:"Foydalanilgan balans:"}),(0,x.jsxs)("b",{children:["-",(0,S.j)((0,D.get)(o,"usedBalance",0))," ",(0,D.get)(u,"currency","uzs")]})]}),0!==(0,D.get)(o,"discount")?(0,x.jsxs)("li",{children:[(0,x.jsxs)("span",{children:[s("common.discount"),":"]}),(0,x.jsxs)("b",{children:["-",(0,S.j)((0,D.get)(o,"discount",""))," ",(0,D.get)(u,"currency","uzs")]})]}):"",(0,D.get)(o,"promocode.amount","")&&(0,x.jsxs)("li",{children:[(0,x.jsx)("span",{children:"Promokod:"}),(0,x.jsxs)("b",{children:["-",(0,S.j)((0,D.get)(o,"promocode.amount",0))," ",(0,D.get)(u,"currency","uzs")]})]}),(0,x.jsxs)("li",{children:[(0,x.jsx)("span",{className:"main",children:"Umumiy:"})," ",(0,x.jsxs)("b",{children:[(0,S.j)((0,D.get)(o,"totalPrice",0))," ",(0,D.get)(u,"currency","uzs")]})]})]})]}),(0,x.jsx)(Be.A,{open:a,setOpen:l,confirmFn:()=>{p(a-1),l(0)}}),(0,x.jsx)(N.aF,{setOpen:d,open:!!r,children:(0,x.jsxs)("div",{className:"custom-modal",children:[(0,x.jsxs)("span",{className:"d-block mb-2",children:[null===r||void 0===r?void 0:r.product.name," (",s("common.residue"),":"," ",(null===r||void 0===r||null===(n=r.product)||void 0===n?void 0:n.inStock)||0,")"]}),(0,x.jsx)(N.ks,{control:null===t||void 0===t?void 0:t.control,name:"items.".concat(null===r||void 0===r?void 0:r.index,".amount"),type:"number",onCustomChange:e=>{e.floatValue<=r.product.inStock&&v(null===r||void 0===r?void 0:r.index,(0,C.A)((0,C.A)({},r),{},{amount:(null===e||void 0===e?void 0:e.floatValue)||0}))}}),(0,x.jsx)(N.O6,{title:s("general.save"),fullWidth:!0,variant:"contained",className:"mt-3",onClick:()=>{t.watch("items.".concat(null===r||void 0===r?void 0:r.index,".amount"))<=r.product.inStock?d(null):he.oR.warn("Max: ".concat(r.product.inStock))}})]})})]})};var Me;const Te=p.default.div(Me||(Me=(0,m.A)(["\n  max-height: calc(100vh - 110px);\n  overflow: auto;\n  .card {\n    padding: 16px 20px;\n    border-radius: 12px;\n    background: #fff;\n    box-shadow: 0px 0px 4px 0px rgba(0, 0, 0, 0.07);\n    margin-bottom: 16px;\n    &:last-of-type {\n      margin-bottom: 0;\n    }\n    .title {\n      font-size: 18px;\n      border-bottom: 1px dashed #e9e9e9;\n      padding-bottom: 10px;\n      margin-bottom: 16px;\n    }\n    .info {\n      display: flex;\n      align-items: center;\n      .image {\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        background-color: #f3f3f8;\n        width: 56px;\n        height: 56px;\n        border-radius: 50%;\n        margin-right: 12px;\n        overflow: hidden;\n        img {\n          width: 100%;\n          height: 100%;\n          object-fit: cover;\n        }\n        svg {\n          width: 25px;\n          height: 25px;\n        }\n      }\n      .phone {\n        color: #999;\n        font-size: 14px;\n      }\n    }\n    .car {\n      display: flex;\n      align-items: center;\n      justify-content: space-between;\n      border-top: 1px dashed #e9e9e9;\n      margin-top: 16px;\n      padding-top: 16px;\n      .number {\n        padding: 3px 7px;\n        font-weight: 600;\n        font-size: 15px;\n        border-radius: 4px;\n        background: #f5f5f5;\n      }\n    }\n  }\n\n  .comment_boxes {\n    display: flex;\n    align-items: flex-start;\n    flex-wrap: wrap;\n    gap: 10px;\n\n    .comment_box {\n      width: 76px;\n      background-color: inherit;\n\n      .comment_img {\n        display: flex;\n        justify-content: center;\n        align-items: center;\n        box-shadow: 0px 0px 12px -2px rgba(0, 0, 0, 0.12);\n        border-radius: 6px;\n        width: 100%;\n        height: 62px;\n\n        img {\n          width: 80%;\n          object-fit: cover;\n        }\n      }\n\n      p {\n        display: inline-block;\n        font-size: 10px !important;\n        font-weight: 600;\n        color: #000;\n        width: 100%;\n        white-space: nowrap;\n        overflow: hidden !important;\n        text-overflow: ellipsis;\n      }\n    }\n  }\n"])));var Re=t(16682);const Oe=e=>{var n,t,i,o,a,l,r,d;let{formStore:s,order:u}=e;return(0,x.jsxs)(Te,{children:[(0,x.jsx)(Ie,{order:u,basketItems:[],formStore:s}),(0,x.jsxs)("div",{className:"card mt-3",children:[(0,x.jsx)("h4",{className:"title",children:"Mijoz"}),(0,x.jsxs)("div",{className:"info border-bottom mb-3 pb-3",children:[(0,x.jsx)("div",{className:"image",children:null!==u&&void 0!==u&&null!==(n=u.customer)&&void 0!==n&&n.image?(0,x.jsx)("img",{src:"https://picsum.photos/100",alt:""}):(0,x.jsx)(c.zG,{})}),(0,x.jsxs)("div",{children:[(0,x.jsx)("h4",{className:"name",children:(0,D.get)(u,"customer.firstName","")+" "+(0,D.get)(u,"customer.lastName","")}),(0,x.jsx)("span",{className:"phone",children:null===u||void 0===u||null===(t=u.customer)||void 0===t?void 0:t.phoneNumber})]})]}),"completed"===(0,D.get)(u,"state.state","")&&(0,x.jsxs)("div",{children:[(0,x.jsx)("h3",{className:"mb-2",children:"Reyting va izoh"}),(0,D.get)(u,"rateComment","")&&(0,x.jsx)("p",{className:"border-bottom pb-3",children:(0,D.get)(u,"rateComment","")}),(0,x.jsx)("div",{className:"py-3 border-bottom",children:(0,x.jsx)(Re.A,{name:"read-only",value:(0,D.get)(u,"rate",5),readOnly:!0})}),(0,x.jsx)("div",{className:"comment_boxes pt-3",children:(0,D.get)(u,"rateComments",[]).map(e=>(0,x.jsxs)("div",{className:"comment_box",children:[(0,x.jsx)("div",{className:"comment_img",children:(0,x.jsx)("img",{src:"http://165.227.153.9"+(0,D.get)(e,"image.url",""),alt:"rate"})}),(0,x.jsx)("p",{children:(0,D.get)(e,"title","")})]}))})]})]}),u.courier&&(0,x.jsxs)("div",{className:"card",children:[(0,x.jsx)("h4",{className:"title",children:"Kuryer"}),(0,x.jsxs)("div",{className:"info",children:[(0,x.jsx)("div",{className:"image",children:null!==u&&void 0!==u&&null!==(i=u.courier)&&void 0!==i&&i.image?(0,x.jsx)("img",{src:"http://165.227.153.9/"+(null===u||void 0===u||null===(o=u.courier)||void 0===o||null===(a=o.image)||void 0===a?void 0:a.url),alt:""}):(0,x.jsx)("span",{children:(0,x.jsx)(c.zG,{})})}),(0,x.jsxs)("div",{children:[(0,x.jsxs)("h4",{className:"name",children:[(0,D.get)(u,"courier.firstName","")," ",(0,D.get)(u,"courier.lastName","")]}),(0,x.jsx)("span",{className:"phone",children:(0,D.get)(u,"courier.phoneNumber","")})]})]}),(0,x.jsxs)("div",{className:"car",children:[(0,x.jsx)("span",{className:"name",children:(0,D.get)(u,"courier.carBrand","")}),(0,x.jsx)("span",{className:"number",children:(0,D.get)(u,"courier.carNumber","")})]})]}),(null===u||void 0===u?void 0:u.employee)&&(0,x.jsxs)("div",{className:"card",children:[(0,x.jsx)("h4",{className:"title",children:"Xodim"}),(0,x.jsxs)("div",{className:"info",children:[(0,x.jsx)("div",{className:"image",children:null!==u&&void 0!==u&&null!==(l=u.employee)&&void 0!==l&&l.image?(0,x.jsx)("img",{src:"http://165.227.153.9/"+(null===u||void 0===u||null===(r=u.employee)||void 0===r||null===(d=r.image)||void 0===d?void 0:d.url),alt:""}):(0,x.jsx)("span",{children:(0,x.jsx)(c.zG,{})})}),(0,x.jsxs)("div",{children:[(0,x.jsxs)("h4",{className:"name",children:[(0,D.get)(u,"employee.firstName","")," ",(0,D.get)(u,"employee.lastName","")]}),(0,x.jsx)("span",{className:"phone",children:(0,D.get)(u,"employee.phoneNumber","")})]})]})]})]})};var qe=t(22166);const Fe=()=>{var e,n,t,i,l,d;const{id:s}=(0,o.g)(),{t:c}=(0,b.Bd)(),u=(0,te.mN)(),{setValue:m,reset:p,handleSubmit:v,control:h}=u,g=(0,y.G)(e=>e.SocketState.render),j=(0,qe.useDispatch)(),A=localStorage.getItem("i18nextLng")||"uz",[k,w]=(0,f.useState)(""),{data:S,status:I,refetch:z}=(0,r.gf)("order/get-by-id/".concat(s),{},{enabled:!!s}),_=null===S||void 0===S?void 0:S.data,L="completed"===(null===_||void 0===_||null===(e=_.state)||void 0===e?void 0:e.state),E="cancelled"===(null===_||void 0===_||null===(n=_.state)||void 0===n?void 0:n.state),{data:P,refetch:B}=(0,r.gf)("order-state/get-all",{},{suspense:!1}),{mutate:M}=(0,r.L2)("order/state/".concat(null===_||void 0===_?void 0:_._id),"put",{onSuccess(){z(),he.oR.success(c("general.success"))}}),{mutate:T}=(0,r.L2)("order/update","put");(0,f.useEffect)(()=>{var e;"success"===I&&(m("items",null===_||void 0===_?void 0:_.items),p({items:null===_||void 0===_?void 0:_.items,addressName:null===_||void 0===_?void 0:_.addressName,addressLocation:null===_||void 0===_?void 0:_.addressLocation,customer:(0,D.get)(_,"customer.firstName","")+" "+(0,D.get)(_,"customer.lastName",""),receiverFirstName:(0,D.get)(_,"receiverCustomer.firstName",""),phoneNumber:null===_||void 0===_||null===(e=_.customer)||void 0===e?void 0:e.phoneNumber,paymentType:null===_||void 0===_?void 0:_.paymentType,houseNumber:null===_||void 0===_?void 0:_.houseNumber,entrance:null===_||void 0===_?void 0:_.entrance,floor:null===_||void 0===_?void 0:_.floor,deliveryDate:(0,D.get)(_,"deliveryDate",""),apartmentNumber:null===_||void 0===_?void 0:_.apartmentNumber}),setTimeout(()=>m("comment",null===_||void 0===_?void 0:_.comment),0))},[I]);const O=v(e=>{var n;const t=(0,C.A)((0,C.A)({},e),{},{items:null===e||void 0===e||null===(n=e.items)||void 0===n?void 0:n.map(e=>{var n;return{productId:e.productId,amount:e.amount,attributes:null===e||void 0===e||null===(n=e.attributes)||void 0===n?void 0:n.map(e=>({attributeId:null===e||void 0===e?void 0:e.attributeId,attributeItem:null===e||void 0===e?void 0:e.attributeItem}))}}),_id:null===_||void 0===_?void 0:_._id,cardId:null===_||void 0===_?void 0:_._id});T(t)}),q=null===P||void 0===P||null===(t=P.data)||void 0===t?void 0:t.findIndex(e=>e._id===(null===_||void 0===_?void 0:_.state._id));return(0,f.useEffect)(()=>{g&&(z(),j((0,R.N8)(!1)))},[g]),(0,x.jsx)(_e,{children:(0,x.jsxs)(a.Ay,{container:!0,columnSpacing:3,children:[(0,x.jsxs)(a.Ay,{item:!0,md:8,children:[(0,x.jsxs)("div",{className:"top",children:[!E&&!L&&(0,x.jsxs)("div",{className:"d-flex",children:[(0,x.jsx)(N.O6,{title:null===P||void 0===P||null===(i=P.data[q+1])||void 0===i||null===(l=i.name)||void 0===l?void 0:l[A],variant:"contained",className:"me-3",onClick:()=>{var e;return M({stateId:null===P||void 0===P||null===(e=P.data[q+1])||void 0===e?void 0:e._id,_id:null===_||void 0===_?void 0:_._id,position:1})}}),(0,x.jsx)(N.O6,{title:"Bekor qilish",variant:"outlined",color:"error",className:"me-3",onClick:()=>M({stateId:null===P||void 0===P?void 0:P.data[(null===P||void 0===P?void 0:P.data.length)-1]._id,_id:null===_||void 0===_?void 0:_._id,position:1})})]}),(0,x.jsxs)("div",{className:"payment-type",children:[(0,x.jsx)("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAG6SURBVHgB7ZPLTsJAFIb/Di0gpVgRr5h4i9G4VOPCxJ2P4cYn8Cl8DXc+h4kP4MoYDQnRECOIhUJLbaEXT4dQSCyyYMvfTDqXM9+cM+cMMNO0Ei7vrm9ZwCRMqQA+s+pmXWQQriAEYw2L6jyKCyps18RHswXNdGPtBPrAAoijk3nFhCT1N6RFGUfFE2wQzHH7c8KOi5JWwmu1AtfvkVsefrou2p2ViBEBF+fbWC/o0cLx2jmUpEobfdy/luB5Pi4O97Gb3wZLtFEzy9zOdgz+H0DZAFBQzQimplcJluf9t28NaUnEztIiGQvkeZavpyiCUMlkBopci/YyxEhNLUf95WyWoA20bRuSmOhfR0Lm4DjFAkeVy8zhdHsTpu3g+bM6yTweqDvDEAzyLLxHOZ0K88jV9SxKVOd/YKM1DEG3a7yFCqiiKloTXcr0weoKHILpTp2XEYf3LBhxWa7rOfiBADHh8fGD8YSzzQwKioLzvV2kKDGOb+GlVkZZ0+B6OTrNRceZg2kt/QWG0lrK6BDvX4+8DtepuG0K8UPXoRlhTcoYJ5EeyY0vYGucQaWp8zZJxGH0/izMNLV+ASXZrtTxzAUrAAAAAElFTkSuQmCC",alt:"money"}),(0,x.jsxs)("div",{className:"type",children:[(0,x.jsx)("span",{children:"To'lov turi"}),(0,x.jsx)("h4",{children:c("enum.".concat(null===_||void 0===_?void 0:_.paymentType))})]}),(0,x.jsx)("span",{className:"state",children:"cash"===(null===_||void 0===_?void 0:_.paymentType)&&"completed"===_.state.state||null!==_&&void 0!==_&&_.isPaid?"To'langan":"To'lanmagan"})]}),!L&&!E&&(0,x.jsx)(N.O6,{title:"Saqlash",variant:"contained",className:"ms-3",onClick:O})]}),(0,x.jsx)(De,{formStore:u,state:null===_||void 0===_||null===(d=_.state)||void 0===d?void 0:d.state,order:_})]}),(0,x.jsx)(a.Ay,{item:!0,md:4,children:(0,x.jsx)(Oe,{formStore:u,order:_})})]})})},Ve=()=>(0,x.jsxs)(o.BV,{children:[(0,x.jsx)(o.qh,{path:"table",element:(0,x.jsx)(O,{})}),(0,x.jsx)(o.qh,{path:"board",element:(0,x.jsx)(H,{})}),(0,x.jsx)(o.qh,{path:"add",element:(0,x.jsx)(Ce,{})}),(0,x.jsx)(o.qh,{path:":id",element:(0,x.jsx)(Fe,{})}),(0,x.jsx)(o.qh,{path:"*",element:(0,x.jsx)(o.C5,{to:"/order/table",replace:!0})})]})}}]);
//# sourceMappingURL=923.7b472c25.chunk.js.map