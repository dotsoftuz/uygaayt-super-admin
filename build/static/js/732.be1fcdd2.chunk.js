"use strict";(self.webpackChunkbestune_admin=self.webpackChunkbestune_admin||[]).push([[732],{34732:(e,r,o)=>{o.r(r),o.d(r,{default:()=>U});var t=o(5468),a=o(65043),n=o(49752),d=o(60446),m=o.n(d),s=o(53536),l=o(74117),c=o(72824),i=o(70579);var u=o(72473),p=o(13094),x=o(24858),_=o(89379),g=o(68903),f=o(15795),j=o(61698);const b=e=>{let{formStore:r,editingBannerId:o,resetForm:n}=e;const{t:d}=(0,l.Bd)(),{control:m,handleSubmit:s,reset:c,watch:u,setValue:p}=r,{mutate:b,status:h}=(0,j.L2)(o?"/promocode/update":"/promocode/create",o?"put":"post"),{data:D,status:U}=(0,j.gf)("promocode/get-by-id/".concat(o),{},{enabled:!!o,suspense:!1});(0,a.useEffect)(()=>{"success"===h&&n()},[h]);return(0,a.useEffect)(()=>{"success"===U&&c({name:D.data.name,code:D.data.code,amount:D.data.amount,minOrderPrice:D.data.minOrderPrice,fromDate:D.data.fromDate,toDate:D.data.toDate,maxUsage:D.data.maxUsage,maxUsageForUser:D.data.maxUsageForUser})},[U,D]),(0,i.jsx)("div",{className:"custom-drawer",children:(0,i.jsx)("form",{id:"promo-code",onSubmit:s(e=>{b((0,_.A)((0,_.A)({_id:o},e),{},{maxUsageForUser:+e.maxUsageForUser}))}),children:(0,i.jsxs)(g.Ay,{container:!0,spacing:2,children:[(0,i.jsx)(g.Ay,{item:!0,md:12,children:(0,i.jsx)(t.ks,{control:m,name:"name",label:d("promo_code.name")})}),(0,i.jsx)(g.Ay,{item:!0,md:12,children:(0,i.jsx)(t.ks,{control:m,name:"code",label:d("promo_code.code")})}),(0,i.jsx)(g.Ay,{item:!0,md:12,children:(0,i.jsx)(t.ks,{name:"maxUsage",control:m,label:d("promo_code.usage"),type:"number"})}),(0,i.jsx)(g.Ay,{item:!0,md:12,children:(0,i.jsx)(t.ks,{name:"amount",control:m,label:d("promo_code.value"),type:"number"})}),(0,i.jsx)(g.Ay,{item:!0,md:12,children:(0,i.jsx)(t.ks,{name:"minOrderPrice",control:m,label:d("promo_code.min_order_price"),type:"number"})}),(0,i.jsxs)(g.Ay,{item:!0,md:12,children:[(0,i.jsx)("label",{className:"text-[15px]",htmlFor:"",children:d("promo_code.max_usage_for_user")}),(0,i.jsx)(x.xI,{name:"maxUsageForUser",control:m,render:e=>{let{field:r}=e;return(0,i.jsx)(f.A,(0,_.A)((0,_.A)({},r),{},{className:"mt-1",type:"number",fullWidth:!0,variant:"outlined",defaultValue:1}))}})]}),(0,i.jsx)(g.Ay,{item:!0,md:12,children:(0,i.jsx)(t.T9,{control:m,name:"fromDate",disableTime:!0,label:d("promo_code.start_date"),minDate:new Date,readOnly:!0,maxDate:u("dateTo")?new Date(u("dateTo")):void 0})}),(0,i.jsx)(g.Ay,{item:!0,md:12,children:(0,i.jsx)(t.T9,{control:m,name:"toDate",disableTime:!0,label:d("promo_code.end_date"),readOnly:!0})})]})})})};var h=o(83501),D=o(477);const U=()=>{const[e,r]=(0,a.useState)(),[o,d]=(0,a.useState)(),_=(()=>{const{t:e}=(0,l.Bd)();return[{field:e("promo_code.name"),renderCell(e){let{row:r}=e;const o=null===r||void 0===r?void 0:r.name,t=(null===o||void 0===o?void 0:o.length)>50?"".concat(o.substring(0,50),"..."):o;return(0,i.jsx)(n.A,{title:o,arrow:!0,children:(0,i.jsx)("span",{children:t})})}},{field:e("ID"),renderCell(e){let{row:r}=e;return(0,s.get)(r,"code","-")}},{field:e("promo_code.value"),renderCell(e){let{row:r}=e;return(0,c.j)((0,s.get)(r,"amount","-"))}},{field:e("promo_code.usage"),renderCell(e){let{row:r}=e;return(0,s.get)(r,"maxUsage","-")}},{field:e("promo_code.used_count"),renderCell(e){let{row:r}=e;return(0,s.get)(r,"usedCount","-")}},{field:e("promo_code.start_date"),renderCell(e){let{row:r}=e;return m()((0,s.get)(r,"fromDate","-")).format("DD.MM.YYYY HH:mm")}},{field:e("promo_code.end_date"),renderCell(e){let{row:r}=e;return m()((0,s.get)(r,"toDate","-")).format("DD.MM.YYYY HH:mm")}},{field:e("promo_code.status"),renderCell(e){let{row:r}=e;return(0,s.get)(r,"state","-")}}]})(),g=(0,h.L)(),{t:f}=(0,l.Bd)(),j=(0,u.j)(),U=(0,x.mN)(),A=()=>{r(void 0),U.reset({name:"",code:"",amount:"",minOrderPrice:"",fromDate:null,toDate:null,maxUsage:"",maxUsageForUser:1})},w=(0,a.useMemo)(()=>({}),[]);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.XI,{dataUrl:"promocode/paging",columns:_,searchable:!0,onAddButton:g("bannerCreate")?()=>j((0,p.GF)(!0)):void 0,onEditColumn:g("bannerUpdate")?e=>{r(e._id),j((0,p.GF)(!0))}:void 0,onDeleteColumn:g("bannerDelete")?e=>d(e._id):void 0,exQueryParams:w}),(0,i.jsx)(D.A,{open:o,setOpen:d,url:"promocode/delete"}),(0,i.jsx)(t.wA,{FORM_ID:"promo-code",isEditing:!!e,customTitle:f(e?"promo_code.edit_promo_code":"promo_code.new_promo_code"),onClose:A,children:(0,i.jsx)(b,{formStore:U,resetForm:A,editingBannerId:e})})]})}},72824:(e,r,o)=>{o.d(r,{j:()=>t});const t=e=>{if(e||0===e){return(Math.round(100*(e+Number.EPSILON))/100).toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0}).replaceAll(","," ")}return""}}}]);
//# sourceMappingURL=732.be1fcdd2.chunk.js.map