{"version":3,"file":"static/js/680.69008474.chunk.js","mappings":"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","sources":["pages/product_analytics/index.tsx","pages/product_analytics/container/ProductAnalytics.tsx","pages/product_analytics/container/product_analytics.columns.tsx","utils/numberFormat.ts"],"sourcesContent":["import ProductAnalytics from \"./container/ProductAnalytics\";\n\nexport default ProductAnalytics;\n","import {\n  AutoCompleteFilter,\n  ExportButton,\n  RangeDatePicker,\n  Table,\n} from \"components\";\nimport { useProductColumns } from \"./product_analytics.columns\";\nimport { useTranslation } from \"react-i18next\";\nimport { Grid } from \"@mui/material\";\nimport { useState } from \"react\";\nimport { useForm, UseFormReturn } from \"react-hook-form\";\nimport WarningModal from \"components/common/WarningModal/WarningModal\";\nimport useAllQueryParams from \"hooks/useGetAllQueryParams/useAllQueryParams\";\n\ninterface FormValues {\n  isActiveQuery?: boolean;\n  // categoryId ni bu yerda qo'shish shart emas, chunki u URL dan olinadi\n}\n\nconst ProductAnalytics: React.FC = () => {\n  const columns = useProductColumns();\n  const { t } = useTranslation();\n  const formStore: UseFormReturn<FormValues> = useForm<FormValues>();\n  const [productId, setProductId] = useState<string>(\"\");\n  const allParams = useAllQueryParams();\n  const exportUrl: string = \"/report/product/export\";\n\n  const renderHeader = (\n    <Grid className=\"w-full lg:w-[60%] md:flex md:grid-cols-3 gap-3 justify-end items-center py-2\">\n      <Grid className=\"md:w-[30%] py-1\">\n        <AutoCompleteFilter\n          optionsUrl=\"category/paging\"\n          filterName=\"categoryId\"\n          placeholder={t(\"common.category\")}\n        />\n      </Grid>\n      <Grid className=\"md:w-[40%] py-1 flex justify-end\">\n        <RangeDatePicker />\n      </Grid>\n      <Grid className=\"md:w-[30%] py-1\">\n        <ExportButton url={exportUrl} />\n      </Grid>\n    </Grid>\n  );\n\n  return (\n    <>\n      <Table\n        columns={columns}\n        dataUrl=\"report/product\"\n        headerChildren={renderHeader}\n        exQueryParams={{\n          // isActiveQuery hech qachon set qilinmayapti, shuning uchun bu doim undefined\n          // Agar isActive filter kerak bo'lsa, uni formga qo'shish kerak\n          isActive: formStore.watch(\"isActiveQuery\") || undefined,\n          categoryId: allParams.categoryId || undefined, // âœ… Bu to'g'ri ishlaydi\n        }}\n      />\n      <WarningModal\n        open={Boolean(productId)}\n        setOpen={setProductId}\n        url=\"product/delete\"\n      />\n    </>\n  );\n};\n\nexport default ProductAnalytics;\n","import { GridColumns } from \"@mui/x-data-grid\";\nimport { Tooltip } from \"antd\";\nimport { get } from \"lodash\";\nimport { useTranslation } from \"react-i18next\";\nimport { numberFormat } from \"utils/numberFormat\";\n\nexport const useProductColumns = (): GridColumns => {\n  const { t } = useTranslation();\n  const currentLang = localStorage.getItem(\"i18nextLng\") || \"uz\";\n\n\n  return [\n    {\n      field: t(\"common.productName\"),\n      renderCell({ row }) {\n        const title = row?.product?.name?.[currentLang];\n        const truncatedTitle = title?.length > 30 ? `${title.substring(0, 30)}...` : title;\n    \n        return (\n          <Tooltip title={title} arrow>\n            <span>{truncatedTitle}</span>\n          </Tooltip>\n        );\n      },\n    },\n    {\n      field: t(\"common.price\"),\n      renderCell({ row }) {\n        return numberFormat(get(row, \"product.price\", \"\"));\n      },\n    },\n    {\n      field: t(\"common.discountValue\"),\n      renderCell({ row }) {\n        return (\n          numberFormat(get(row, \"product.discountValue\", \"\")) + \n          (row?.product?.discountType === \"percent\" ? \"%\" : \"\")\n        );\n      },\n    },\n    {\n      field: t(\"common.residue\"),\n      renderCell({ row }) {\n        return numberFormat(get(row, \"product.inStock\", \"\"));\n      },\n    },\n    {\n      field: \"total_amount\",\n      headerName: t(\"common.sold\")!,\n      sortable: true,\n      renderCell({ row }) {\n        return numberFormat(get(row, \"total_amount\", \"\"));\n      },\n    },\n    {\n      field: \"customerCount\",\n      headerName: t(\"common.customer_bought_count\")!,\n      sortable: true,\n      renderCell({ row }) {\n        return numberFormat(get(row, \"customerCount\", \"\"));\n      },\n    },\n    {\n      field: \"total_price\",\n      headerName: t(\"order.totalPrice\")!,\n      sortable: true,\n      renderCell({ row }) {\n        return numberFormat(get(row, \"total_price\", \"\"));\n      },\n    },\n    // {\n    //   field: t(\"common.status\"),\n    //   renderCell({ row }) {\n    //     return get(row, \"status\", \"\");\n    //   },\n    // },\n  ];\n};\n","export const numberFormat = (number: any) => {\n  if (number || number === 0) {\n    // Floating-point xatoliklarni oldini olish\n    const rounded = Math.round((number + Number.EPSILON) * 100) / 100;\n\n    return rounded\n      .toLocaleString(\"en-US\", {\n        minimumFractionDigits: 0, // Har doim 2 kasr\n        maximumFractionDigits: 0, // Kasr 2 dan oshmaydi\n      })\n      .replaceAll(\",\", \" \"); // Minglik ajratgich\n  }\n  return \"\";\n};\n"],"names":["columns","t","useTranslation","currentLang","localStorage","getItem","field","renderCell","row","title","product","name","truncatedTitle","length","substring","arrow","numberFormat","get","discountType","headerName","sortable","useProductColumns","formStore","useForm","useState","productId","setProductId","allParams","useAllQueryParams","renderHeader","Grid","className","optionsUrl","filterName","placeholder","url","dataUrl","headerChildren","exQueryParams","isActive","watch","undefined","categoryId","WarningModal","open","Boolean","setOpen","number","Math","round","Number","EPSILON","toLocaleString","minimumFractionDigits","maximumFractionDigits","replaceAll"],"sourceRoot":""}