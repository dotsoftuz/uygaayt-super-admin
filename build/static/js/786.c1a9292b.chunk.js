"use strict";(self.webpackChunkbestune_admin=self.webpackChunkbestune_admin||[]).push([[786],{1903:function(e,n,t){t.d(n,{Z:function(){return l}});var i,r=t(30168),o=t(47191),a=(0,t(17939).default)(o.LD)(i||(i=(0,r.Z)(["\n  display: flex;\n  flex-direction: column-reverse;\n  border: none;\n  width: 100%;\n  padding-bottom: 20px;\n  .quill {\n    .ql-container {\n      .ql-tooltip {\n        transform: translateX(97px);\n        z-index: 10;\n      }\n      .ql-editor {\n        background-color: #fff;\n        padding: 15px;\n        border-radius: 12px;\n        min-height: 80px;\n        transition: all 0.3s;\n        border: 1px solid #d9d9d9;\n        p {\n          margin: 0;\n          font-size: 14px;\n        }\n      }\n    }\n  }\n  .ql-toolbar {\n    padding: 0;\n    transition: opacity 1s ease-out;\n    border-radius: 0;\n    border-bottom: none;\n    margin-top: 10px;\n    button {\n      border: none;\n      margin: 0 5px;\n      svg {\n        width: 24px !important;\n        height: 24px !important;\n        fill: #000 !important;\n        path {\n          fill: #000;\n        }\n      }\n    }\n  }\n  .ql-editing {\n    left: 30px !important;\n    transform: translateX(0px) !important;\n    z-index: 100;\n  }\n"]))),d=t(80184),l=function(e){var n=e.value,t=e.onChange,i=e.onImageUpload,r=e.isError,o=e.type;return(0,d.jsx)(a,{controls:[["bold","italic","underline","strike","clean","unorderedList","orderedList","alignLeft","alignCenter","alignRight"]],isError:!!r,value:n,onChange:t,onImageUpload:i,type:o})}},64786:function(e,n,t){t.r(n),t.d(n,{default:function(){return E}});var i,r=t(29439),o=t(35980),a=t(763),d=t(39230),l=t(90816),s=t(29001),c=t(79405),u=t(36978),m=t(61889),p=t(72791),x=t(61134),g=t(93433),h=t(1413),v=t(98921),f=t(89891),y=t(62750),b=t(30168),j=t(17939).default.div(i||(i=(0,b.Z)(["\n  .product-images {\n    display: flex;\n    flex-wrap: wrap;\n    .input-file {\n      margin-right: 10px;\n    }\n    .product-image {\n      position: relative;\n      width: 76px;\n      height: 76px;\n      border-radius: 12px;\n      overflow: hidden;\n      margin-right: 10px;\n      margin-bottom: 10px;\n      cursor: pointer;\n      &:hover {\n        .on-hover {\n          display: flex;\n        }\n      }\n      img {\n        width: 100%;\n        height: 100%;\n        object-fit: cover;\n      }\n      .on-hover {\n        position: absolute;\n        left: 0;\n        right: 0;\n        top: 0;\n        bottom: 0;\n        display: none;\n        align-items: center;\n        justify-content: center;\n        background-color: rgba(0, 0, 0, 0.5);\n        .delete svg {\n          width: 20px;\n          height: 20px;\n          path {\n            fill: #fff;\n          }\n        }\n        .main-image {\n          position: absolute;\n          right: 5px;\n          top: 5px;\n          width: 15px;\n          height: 15px;\n          border-radius: 50%;\n          border: 2px solid gold;\n          &.active {\n            background-color: gold;\n          }\n        }\n      }\n    }\n  }\n"]))),Z=t(1903),A=t(59460),I=t(30709),P=t(80184),w=function(e){var n=e.formStore,t=e.resetForm,i=e.editingProductId,r=e.productProps,a=r.productImages,l=r.setProductImages,s=r.mainImageId,c=r.setMainImageId,u=(0,d.$G)().t,x=n.control,b=n.handleSubmit,w=n.reset,_=n.setValue,E=n.register,S=n.watch,k=new Date(S("discountStartAt"));k.setDate(k.getDate()+1);var C=(0,y.uC)(i?"/product/update":"product/create",i?"put":"post"),D=C.mutate,q=C.status,M=(0,y.h_)("product/get-by-id/".concat(i),{},{enabled:!!i,suspense:!1}),N=M.data,T=M.status;return(0,p.useEffect)((function(){"success"===q&&t()}),[q]),(0,p.useEffect)((function(){var e,t,i,r,o,a,d,s,u,m;"success"===T&&(w((0,h.Z)((0,h.Z)({},N.data),{},{categoryId:null===(e=N.data.category)||void 0===e?void 0:e._id,isActiveQuery:n.watch("isActiveQuery")})),_("isMyExpire",!!S("expiryDate")),l((null===(t=N.data)||void 0===t?void 0:t.images)||[]),(null===(i=N.data)||void 0===i||null===(r=i.images)||void 0===r?void 0:r.find((function(e){var n;return(null===e||void 0===e?void 0:e._id)===(null===(n=N.data.mainImage)||void 0===n?void 0:n._id)})))&&null!==(o=N.data)&&void 0!==o&&null!==(a=o.images)&&void 0!==a&&a.length?c(null===(m=N.data.mainImage)||void 0===m?void 0:m._id):c(null===(d=N.data)||void 0===d||null===(s=d.images)||void 0===s||null===(u=s[0])||void 0===u?void 0:u._id))}),[T,N]),(0,p.useEffect)((function(){var e=a.find((function(e){return e._id===s}));e?c(e._id):a.length&&c(a[0]._id)}),[a]),(0,P.jsx)(j,{className:"custom-drawer",children:(0,P.jsx)("form",{id:"product",onSubmit:b((function(e){var n,t,r,o,d=(0,h.Z)((0,h.Z)({},e),{},{imageIds:a.map((function(e){return e._id})),mainImageId:a.length?s||(null===a||void 0===a||null===(n=a[0])||void 0===n?void 0:n._id):null,expiryDate:e.isMyExpire?"string"===typeof e.expiryDate?e.expiryDate:"object"===typeof e.expiryDate?null===(t=e.expiryDate)||void 0===t?void 0:t.toISOString():null:null,discountStartAt:"string"===typeof e.discountStartAt?e.discountStartAt:"object"===typeof e.discountStartAt?null===(r=e.discountStartAt)||void 0===r?void 0:r.toISOString():void 0,discountEndAt:"string"===typeof e.discountEndAt?e.discountEndAt:"object"===typeof e.discountEndAt?null===(o=e.discountEndAt)||void 0===o?void 0:o.toISOString():void 0,_id:i});delete d.isMyExpire,D(d)})),children:(0,P.jsxs)(m.ZP,{container:!0,spacing:2,children:[(0,P.jsx)(m.ZP,{item:!0,md:12,children:(0,P.jsx)(o.oi,{name:"name",control:x,label:u("common.productName")})}),(0,P.jsx)(m.ZP,{item:!0,md:12,children:(0,P.jsx)(o.oi,{name:"price",control:x,label:u("common.price"),type:"number"})}),(0,P.jsx)(m.ZP,{item:!0,md:12,children:(0,P.jsx)(o.oi,{name:"inStock",control:x,label:u("common.residue"),type:"number"})}),(0,P.jsxs)(m.ZP,{item:!0,md:12,display:"flex",justifyContent:"space-between",children:[(0,P.jsx)(v.Z,{children:(0,P.jsx)(o.oi,{name:"redLine",control:x,type:"number",label:u("Qizil chiziq"),rules:{required:!1}})}),(0,P.jsx)(v.Z,{children:(0,P.jsx)(o.oi,{name:"yellowLine",control:x,label:u("Sariq chiziq"),type:"number",rules:{required:!1}})})]}),(0,P.jsx)(m.ZP,{item:!0,md:12,children:(0,P.jsx)(o.Ls,{control:x,name:"categoryId",optionsUrl:"category/paging",dataProp:"data.data",label:u("common.category")})}),(0,P.jsxs)(m.ZP,{item:!0,md:12,children:[(0,P.jsx)("label",{className:"custom-label",children:u("common.description")}),(0,P.jsx)(Z.Z,{value:S("description"),onChange:function(e){_("description",e)}})]}),(0,P.jsx)(m.ZP,{item:!0,md:12,children:(0,P.jsxs)(v.Z,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[(0,P.jsx)("label",{htmlFor:"isActive",children:u("common.isActive")}),(0,P.jsx)(f.Z,(0,h.Z)({checked:!!S("isActive"),id:"isActive"},E("isActive")))]})}),(0,P.jsxs)(m.ZP,{item:!0,md:12,children:[(0,P.jsxs)(v.Z,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[(0,P.jsx)("label",{htmlFor:"isActive",children:"Muddatli mahsulot"}),(0,P.jsx)(f.Z,(0,h.Z)({checked:!!S("isMyExpire"),id:"isMyExpire"},E("isMyExpire")))]}),S("isMyExpire")&&(0,P.jsx)(m.ZP,{container:!0,children:(0,P.jsx)(m.ZP,{item:!0,md:12,children:(0,P.jsx)(o.nT,{control:x,name:"expiryDate",rules:{required:{value:!0,message:"Majburiy"}},disableTime:!0,label:u("common.validatyPariod"),readOnly:!0,minDate:new Date})})})]}),(0,P.jsxs)(m.ZP,{item:!0,md:12,children:[(0,P.jsxs)(v.Z,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[(0,P.jsx)("label",{htmlFor:"discountEnabled",children:u("common.discount")}),(0,P.jsx)(f.Z,(0,h.Z)({checked:!!S("discountEnabled"),id:"discountEnabled"},E("discountEnabled")))]}),S("discountEnabled")&&(0,P.jsxs)(m.ZP,{container:!0,spacing:2,alignItems:"end",children:[(0,P.jsx)(m.ZP,{item:!0,md:6,children:(0,P.jsx)(o.oi,{control:x,name:"discountValue",label:u("common.discountValue"),type:"number",inputProps:"percent"===S("discountType")?{max:100}:{max:Number(S("price"))}})}),(0,P.jsx)(m.ZP,{item:!0,md:6,children:(0,P.jsx)(o.p7,{control:x,name:"discountType",options:I.v5,label:u("common.type")})}),(0,P.jsx)(m.ZP,{item:!0,md:6,children:(0,P.jsx)(o.nT,{control:x,name:"discountStartAt",disableTime:!0,rules:{required:{value:!0,message:"Majburiy"}},label:u("common.discountStartAt"),minDate:new Date,readOnly:!0,maxDate:S("discountEndAt")?new Date(S("discountEndAt")):void 0})}),(0,P.jsx)(m.ZP,{item:!0,md:6,children:(0,P.jsx)(o.nT,{control:x,name:"discountEndAt",rules:{required:{value:!0,message:"Majburiy"}},disableTime:!0,label:u("common.discountEndAt"),readOnly:!0,minDate:k})})]})]}),(0,P.jsx)(m.ZP,{item:!0,md:12,children:(0,P.jsxs)("div",{className:"product-images",children:[(0,P.jsx)(o.aG,{control:x,setValue:_,name:"image",rules:{required:!1},multiple:!0,getImage:function(e){return l((function(n){return[].concat((0,g.Z)(n),[e])}))},accept:".png, .jpg, .jpeg"}),null===a||void 0===a?void 0:a.map((function(e){return(0,P.jsxs)("div",{className:"product-image",children:[(0,P.jsx)("img",{src:"https://backend.uygaayt.kahero.uz/employee-api/v1/"+e.url,alt:"product"}),(0,P.jsxs)("div",{className:"on-hover",children:[(0,P.jsx)("span",{className:"delete",onClick:function(){return l((function(n){return n.filter((function(n){return n._id!==e._id}))}))},children:(0,P.jsx)(A.pJ,{})}),(0,P.jsx)("span",{className:"main-image ".concat(e._id===s&&"active"),onClick:function(){return c(null===e||void 0===e?void 0:e._id)}})]})]},e._id)}))]})})]})})})},_=t(84544),E=function(){var e=function(){var e=(0,d.$G)().t;return[{field:e("common.productName"),renderCell:function(e){var n=e.row;return(0,a.get)(n,"name","")}},{field:e("common.price"),renderCell:function(e){var n=e.row;return(0,l.Y)((0,a.get)(n,"price",""))}},{field:e("common.residue"),renderCell:function(e){var n=e.row;return(0,l.Y)((0,a.get)(n,"inStock",""))}}]}(),n=(0,s.w)(),t=(0,c.T)(),i=(0,d.$G)().t,g=(0,x.cI)(),h=(0,p.useState)(),v=(0,r.Z)(h,2),f=v[0],y=v[1],b=(0,p.useState)(""),j=(0,r.Z)(b,2),Z=j[0],A=j[1],I=(0,p.useState)([]),E=(0,r.Z)(I,2),S=E[0],k=E[1],C=(0,p.useState)(),D=(0,r.Z)(C,2),q=D[0],M=D[1],N=(0,P.jsxs)(m.ZP,{container:!0,width:400,spacing:2,children:[(0,P.jsx)(m.ZP,{item:!0,sm:6,children:(0,P.jsx)(o.he,{optionsUrl:"category/paging",filterName:"categoryId",placeholder:i("common.category")})}),(0,P.jsx)(m.ZP,{item:!0,sm:6,children:(0,P.jsx)(o.XZ,{control:g.control,label:i("enum.active"),name:"isActiveQuery"})})]}),T=function(){y(null),k([]),M(null),g.reset({name:"",price:"",salePrice:"",inStock:"",discountValue:void 0,discountType:void 0,discountStartAt:void 0,discountEndAt:void 0,imageUrl:"",isActive:!1,discountEnabled:!1,isActiveQuery:g.watch("isActiveQuery"),measureId:"",categoryId:""})};return(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(o.iA,{columns:e,dataUrl:"product/paging",searchable:!0,headerChildren:N,onAddButton:function(){return t((0,u.dl)(!0))},onEditColumn:n("productUpdate")?function(e){y(e._id),t((0,u.dl)(!0))}:void 0,onDeleteColumn:n("productDelete")?function(e){return A(e._id)}:void 0,exQueryParams:{isActive:g.watch("isActiveQuery")||void 0}}),(0,P.jsx)(_.Z,{open:Z,setOpen:A,url:"product/delete"}),(0,P.jsx)(o._8,{FORM_ID:"product",isEditing:!!f,customTitle:i("general.addProduct"),onClose:T,children:(0,P.jsx)(w,{formStore:g,resetForm:T,editingProductId:f,productProps:{productImages:S,setProductImages:k,mainImageId:q,setMainImageId:M}})})]})}},30709:function(e,n,t){t.d(n,{Fv:function(){return a},G4:function(){return i},od:function(){return o},v5:function(){return r}});var i=[{_id:"cash",name:"Naqd",trans_key:"cash"},{_id:"card",name:"Karta",trans_key:"card"}],r=[{_id:"percent",name:"Foiz",trans_key:"percent"},{_id:"amount",name:"Miqdor",trans_key:"amount"}],o=[{name:"Funksionallik",key:"functionality",role:"role"},{name:"Minimal buyurtma bahosi",key:"clientSettings",role:"role"},{name:"Asosiy manzil radiusi",key:"mainAddress",role:"role"},{name:"Veb-sayt shartlari",key:"websiteConditions",role:"role"}],a=[{rate:5},{rate:4},{rate:3},{rate:2},{rate:1}]},90816:function(e,n,t){t.d(n,{Y:function(){return i}});var i=function(e){return e||0==e?e.toLocaleString().replaceAll(","," "):""}}}]);
//# sourceMappingURL=786.c1a9292b.chunk.js.map