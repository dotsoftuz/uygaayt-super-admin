"use strict";(self.webpackChunkbestune_admin=self.webpackChunkbestune_admin||[]).push([[631],{96631:function(e,r,o){o.r(r),o.d(r,{default:function(){return U}});var n=o(29439),t=o(45489),a=o(72791),d=o(50131),m=o(97892),i=o.n(m),c=o(763),l=o(39230),s=o(90816),u=o(80184),f=o(79405),p=o(36978),x=o(61134),_=o(1413),g=o(61889),b=o(27391),j=o(62750),h=function(e){var r=e.formStore,o=e.editingBannerId,n=e.resetForm,d=(0,l.$G)().t,m=r.control,i=r.handleSubmit,c=r.reset,s=r.watch,f=(r.setValue,(0,j.uC)(o?"/promocode/update":"/promocode/create",o?"put":"post")),p=f.mutate,h=f.status,v=(0,j.h_)("promocode/get-by-id/".concat(o),{},{enabled:!!o,suspense:!1}),D=v.data,U=v.status;(0,a.useEffect)((function(){"success"===h&&n()}),[h]);return(0,a.useEffect)((function(){"success"===U&&c({name:D.data.name,code:D.data.code,amount:D.data.amount,minOrderPrice:D.data.minOrderPrice,fromDate:D.data.fromDate,toDate:D.data.toDate,maxUsage:D.data.maxUsage,maxUsageForUser:D.data.maxUsageForUser})}),[U,D]),(0,u.jsx)("div",{className:"custom-drawer",children:(0,u.jsx)("form",{id:"promo-code",onSubmit:i((function(e){p((0,_.Z)((0,_.Z)({_id:o},e),{},{maxUsageForUser:+e.maxUsageForUser}))})),children:(0,u.jsxs)(g.ZP,{container:!0,spacing:2,children:[(0,u.jsx)(g.ZP,{item:!0,md:12,children:(0,u.jsx)(t.oi,{control:m,name:"name",label:d("promo_code.name")})}),(0,u.jsx)(g.ZP,{item:!0,md:12,children:(0,u.jsx)(t.oi,{control:m,name:"code",label:d("promo_code.code")})}),(0,u.jsx)(g.ZP,{item:!0,md:12,children:(0,u.jsx)(t.oi,{name:"maxUsage",control:m,label:d("promo_code.usage"),type:"number"})}),(0,u.jsx)(g.ZP,{item:!0,md:12,children:(0,u.jsx)(t.oi,{name:"amount",control:m,label:d("promo_code.value"),type:"number"})}),(0,u.jsx)(g.ZP,{item:!0,md:12,children:(0,u.jsx)(t.oi,{name:"minOrderPrice",control:m,label:d("promo_code.min_order_price"),type:"number"})}),(0,u.jsxs)(g.ZP,{item:!0,md:12,children:[(0,u.jsx)("label",{className:"text-[15px]",htmlFor:"",children:d("promo_code.max_usage_for_user")}),(0,u.jsx)(x.Qr,{name:"maxUsageForUser",control:m,render:function(e){var r=e.field;return(0,u.jsx)(b.Z,(0,_.Z)((0,_.Z)({},r),{},{className:"mt-1",type:"number",fullWidth:!0,variant:"outlined",defaultValue:1}))}})]}),(0,u.jsx)(g.ZP,{item:!0,md:12,children:(0,u.jsx)(t.nT,{control:m,name:"fromDate",disableTime:!0,label:d("promo_code.start_date"),minDate:new Date,readOnly:!0,maxDate:s("dateTo")?new Date(s("dateTo")):void 0})}),(0,u.jsx)(g.ZP,{item:!0,md:12,children:(0,u.jsx)(t.nT,{control:m,name:"toDate",disableTime:!0,label:d("promo_code.end_date"),readOnly:!0})})]})})})},v=o(29001),D=o(84544),U=function(){var e=(0,a.useState)(),r=(0,n.Z)(e,2),o=r[0],m=r[1],_=(0,a.useState)(),g=(0,n.Z)(_,2),b=g[0],j=g[1],U=function(){var e=(0,l.$G)().t;return[{field:e("promo_code.name"),renderCell:function(e){var r=e.row,o=null===r||void 0===r?void 0:r.name,n=(null===o||void 0===o?void 0:o.length)>50?"".concat(o.substring(0,50),"..."):o;return(0,u.jsx)(d.Z,{title:o,arrow:!0,children:(0,u.jsx)("span",{children:n})})}},{field:e("ID"),renderCell:function(e){var r=e.row;return(0,c.get)(r,"code","-")}},{field:e("promo_code.value"),renderCell:function(e){var r=e.row;return(0,s.Y)((0,c.get)(r,"amount","-"))}},{field:e("promo_code.usage"),renderCell:function(e){var r=e.row;return(0,c.get)(r,"maxUsage","-")}},{field:e("promo_code.used_count"),renderCell:function(e){var r=e.row;return(0,c.get)(r,"usedCount","-")}},{field:e("promo_code.start_date"),renderCell:function(e){var r=e.row;return i()((0,c.get)(r,"fromDate","-")).format("DD.MM.YYYY HH:mm")}},{field:e("promo_code.end_date"),renderCell:function(e){var r=e.row;return i()((0,c.get)(r,"toDate","-")).format("DD.MM.YYYY HH:mm")}},{field:e("promo_code.status"),renderCell:function(e){var r=e.row;return(0,c.get)(r,"state","-")}}]}(),Z=(0,v.w)(),w=(0,l.$G)().t,C=(0,f.T)(),P=(0,x.cI)(),F=function(){m(void 0),P.reset({name:"",code:"",amount:"",minOrderPrice:"",fromDate:null,toDate:null,maxUsage:"",maxUsageForUser:1})},Y=(0,a.useMemo)((function(){return{}}),[]);return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(t.iA,{dataUrl:"promocode/paging",columns:U,searchable:!0,onAddButton:Z("bannerCreate")?function(){return C((0,p.dl)(!0))}:void 0,onEditColumn:Z("bannerUpdate")?function(e){m(e._id),C((0,p.dl)(!0))}:void 0,onDeleteColumn:Z("bannerDelete")?function(e){return j(e._id)}:void 0,exQueryParams:Y}),(0,u.jsx)(D.Z,{open:b,setOpen:j,url:"promocode/delete"}),(0,u.jsx)(t._8,{FORM_ID:"promo-code",isEditing:!!o,customTitle:w(o?"promo_code.edit_promo_code":"promo_code.new_promo_code"),onClose:F,children:(0,u.jsx)(h,{formStore:P,resetForm:F,editingBannerId:o})})]})}},90816:function(e,r,o){o.d(r,{Y:function(){return n}});var n=function(e){return e||0===e?(Math.round(100*(e+Number.EPSILON))/100).toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0}).replaceAll(","," "):""}}}]);
//# sourceMappingURL=631.0d03c267.chunk.js.map