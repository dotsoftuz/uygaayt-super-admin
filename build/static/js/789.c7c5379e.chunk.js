"use strict";(self.webpackChunkbestune_admin=self.webpackChunkbestune_admin||[]).push([[789],{45789:function(e,n,r){r.r(n),r.d(n,{default:function(){return I}});var t,i=r(29439),o=r(35980),a=r(72791),l=r(763),d=r(39230),c=r(79405),u=r(36978),s=r(61134),m=r(29001),f=r(93433),p=r(1413),v=r(36459),x=r(61889),g=r(62750),h=r(59460),j=r(80184),b=function(e){var n,r=e.formStore,t=e.editingCourierId,l=e.resetForm,s=e.productProps,m=(0,d.$G)().t,b=r.control,C=r.handleSubmit,N=r.reset,_=r.watch,I=r.setValue,Z=(0,a.useState)(),w=(0,i.Z)(Z,2),y=w[0],E=w[1],k=s.courierImages,P=s.setCourierImages,S=s.mainImageId,R=s.setMainImageId,O=(0,c.T)();(0,v.Z)((0,g.h_)("employee/check?phoneNumber=".concat(_("phoneNumber")),{},{enabled:(null===(n=_("phoneNumber"))||void 0===n?void 0:n.length)>12&&!t,suspense:!1,onSuccess:function(e){var n=e.data;E(n)}}));var U=(0,g.uC)(t?"courier/update":"courier/create","post"),F=U.mutate,M=U.status,G=(0,g.uC)("courier/get-by-id/".concat(t),"post",{onSuccess:function(){O((0,u.dl)(!0))},onError:function(){O((0,u.dl)(!1))}}),T=G.mutate,B=G.data,D=G.status;(0,a.useEffect)((function(){t?T({_id:t}):O((0,u.dl)(!1))}),[t,T]),(0,a.useEffect)((function(){"success"===M&&l()}),[M]);return(0,a.useEffect)((function(){var e,n,r,t,i,o,a,l,d;"success"===D&&(N((0,p.Z)({},B.data)),P((null===(e=B.data)||void 0===e?void 0:e.images)||[]),(null===(n=B.data)||void 0===n||null===(r=n.images)||void 0===r?void 0:r.find((function(e){var n;return(null===e||void 0===e?void 0:e._id)===(null===(n=B.data.mainImage)||void 0===n?void 0:n._id)})))&&null!==(t=B.data)&&void 0!==t&&null!==(i=t.images)&&void 0!==i&&i.length?R(null===(d=B.data.mainImage)||void 0===d?void 0:d._id):R(null===(o=B.data)||void 0===o||null===(a=o.images)||void 0===a||null===(l=a[0])||void 0===l?void 0:l._id))}),[B,D]),(0,a.useEffect)((function(){var e=k.find((function(e){return e._id===S}));e?R(e._id):k.length&&R(k[0]._id)}),[k]),(0,j.jsx)("div",{className:"custom-drawer",children:(0,j.jsx)("form",{id:"courier",onSubmit:C((function(e){var n;F((0,p.Z)((0,p.Z)({},e),{},{imageId:k.map((function(e){return e._id})),mainImageId:k.length?S||(null===k||void 0===k||null===(n=k[0])||void 0===n?void 0:n._id):null,_id:t}))})),children:(0,j.jsxs)(x.ZP,{container:!0,spacing:2,children:[(0,j.jsxs)(x.ZP,{item:!0,md:12,children:[(0,j.jsx)(o.sb,{control:b,name:"phoneNumber",label:m("common.phoneNumber")}),(null===y||void 0===y?void 0:y._id)&&!t&&(0,j.jsxs)("div",{className:"d-flex justify-content-between",children:[(0,j.jsx)("span",{className:"text-error mt-2",children:m("common.alreadyExistEmployee")}),(0,j.jsx)(o.c7,{title:m("general.add"),onClick:function(){N((0,p.Z)((0,p.Z)({},y),{},{_id:void 0})),E(null)}})]})]}),(0,j.jsx)(x.ZP,{item:!0,md:12,children:(0,j.jsx)(o.oi,{control:b,name:"firstName",label:m("common.firstName")})}),(0,j.jsx)(x.ZP,{item:!0,md:12,children:(0,j.jsx)(o.oi,{control:b,name:"lastName",label:m("common.lastName")})}),(0,j.jsx)(x.ZP,{item:!0,md:12,children:(0,j.jsx)(o.oi,{control:b,name:"password",label:m("common.password"),type:"password",rules:{required:!1}})}),(0,j.jsx)(x.ZP,{item:!0,md:12,children:(0,j.jsx)(o.oi,{control:b,name:"carBrand",label:m("COURIER.carBrand")})}),(0,j.jsx)(x.ZP,{item:!0,md:12,children:(0,j.jsx)(o.oi,{control:b,name:"carModel",label:m("COURIER.carModel")})}),(0,j.jsx)(x.ZP,{item:!0,md:12,children:(0,j.jsx)(o.oi,{control:b,name:"carNumber",label:m("COURIER.carNumber")})}),(0,j.jsx)(x.ZP,{item:!0,md:12,children:(0,j.jsx)(o.oi,{control:b,name:"carColor",label:m("COURIER.carColor")})}),(0,j.jsx)(x.ZP,{item:!0,md:12,children:(0,j.jsxs)("div",{className:"product-images",children:[(0,j.jsx)(o.aG,{control:b,setValue:I,name:"image",rules:{required:!1},multiple:!0,getImage:function(e){return P((function(n){return[].concat((0,f.Z)(n),[e])}))},accept:".png, .jpg, .jpeg"}),null===k||void 0===k?void 0:k.map((function(e){return(0,j.jsxs)("div",{className:"product-image",children:[(0,j.jsx)("img",{src:"https://backend.uygaayt.kahero.uz/employee-api/v1/"+e.url,alt:"product"}),(0,j.jsxs)("div",{className:"on-hover",children:[(0,j.jsx)("span",{className:"delete",onClick:function(){return P((function(n){return n.filter((function(n){return n._id!==e._id}))}))},children:(0,j.jsx)(h.pJ,{})}),(0,j.jsx)("span",{className:"main-image ".concat(e._id===S&&"active"),onClick:function(){return P(e._id)}})]})]},e._id)}))]})})]})})})},C=r(30168),N=r(17939).default.div(t||(t=(0,C.Z)(["\n  background-color: #fff;\n  border-radius: 20px;\n  padding: 32px 42px 24px 42px;\n  h2 {\n    font-weight: 500;\n    font-size: 26px;\n  }\n  button {\n    width: 100px;\n  }\n"]))),_=function(e){var n=e.open,r=e.setOpen,t=e.title,i=e.url,l=e.confirmFn,c=(0,d.$G)().t,u=(0,g.uC)("".concat(i,"/").concat(n),"post"),s=u.mutate,m=u.status;return(0,a.useEffect)((function(){"success"===m&&r(null)}),[m,s,n]),(0,j.jsx)(o.u_,{setOpen:r,open:!!n,children:(0,j.jsxs)(N,{children:[(0,j.jsx)("h2",{children:t||c("general.reallyDelete")}),(0,j.jsx)(o.xq,{isCancelFromRoute:!1,SubmitTitle:c("general.yes"),cancelTitle:c("general.no"),onClick:function(){return i?s({_id:n}):l()},onCancel:function(){return r(!1)}})]})})},I=function(){var e=(0,a.useState)(),n=(0,i.Z)(e,2),r=n[0],t=n[1],f=(0,a.useState)(),p=(0,i.Z)(f,2),v=p[0],x=p[1],g=function(){var e=(0,d.$G)().t;return[{field:e("common.fullName"),renderCell:function(e){return(0,l.get)(e,"row.firstName","")+" "+(0,l.get)(e,"row.lastName","")},flex:1.5},{field:e("common.phoneNumber"),renderCell:function(e){return e.row.phoneNumber}},{field:e("common.rating"),renderCell:function(e){var n;return null===(n=e.row.role)||void 0===n?void 0:n.name}}]}(),h=(0,m.w)(),C=(0,d.$G)().t,N=(0,c.T)(),I=(0,s.cI)(),Z=(0,a.useState)([]),w=(0,i.Z)(Z,2),y=w[0],E=w[1],k=(0,a.useState)(),P=(0,i.Z)(k,2),S=P[0],R=P[1],O=function(){t(void 0),I.reset({firstName:"",lastName:"",phoneNumber:"",password:"",carBrand:"",carColor:"",carModel:"",carNumber:"",imageUrl:""})};return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(o.iA,{dataUrl:"courier/paging",columns:g,searchable:!0,onAddButton:h("employeeCreate")?function(){return N((0,u.dl)(!0))}:void 0,onEditColumn:h("employeeUpdate")?function(e){t(e._id),N((0,u.dl)(!0))}:void 0,onDeleteColumn:h("employeeDelete")?function(e){return x(e._id)}:void 0}),(0,j.jsx)(_,{open:v,setOpen:x,url:"courier/delete"}),(0,j.jsx)(o._8,{FORM_ID:"courier",isEditing:!!r,customTitle:C("general.addCourier"),onClose:O,children:(0,j.jsx)(b,{formStore:I,resetForm:O,editingCourierId:r,productProps:{courierImages:y,setCourierImages:E,mainImageId:S,setMainImageId:R}})})]})}}}]);
//# sourceMappingURL=789.c7c5379e.chunk.js.map