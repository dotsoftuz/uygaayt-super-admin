{"version":3,"file":"static/js/732.be1fcdd2.chunk.js","mappings":"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","sources":["pages/promo_code/components/PromoCodeForm.tsx","pages/promo_code/container/PromoCode.tsx","pages/promo_code/index.tsx","pages/promo_code/container/promo-code.columns.tsx","utils/numberFormat.ts"],"sourcesContent":["import { FC, useEffect } from \"react\";\r\nimport { Grid, TextField } from \"@mui/material\";\r\nimport { AutoCompleteForm, DatePickerForm, ImageInput, TextInput } from \"components\";\r\nimport { Controller, UseFormReturn } from \"react-hook-form\";\r\nimport { useApi, useApiMutation } from \"hooks/useApi/useApiHooks\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport TextEditor from \"components/form/TextEditor/TextEditor\";\r\nimport { debounce } from \"lodash\";\r\n\r\ninterface IEmployeesForm {\r\n  formStore: UseFormReturn<any>;\r\n  editingBannerId: string;\r\n  resetForm: () => void;\r\n}\r\nconst PromoCodeForm: FC<IEmployeesForm> = ({\r\n  formStore,\r\n  editingBannerId,\r\n  resetForm,\r\n}) => {\r\n  const { t } = useTranslation();\r\n  const { control, handleSubmit, reset, watch, setValue } = formStore;\r\n\r\n  const { mutate, status } = useApiMutation(\r\n    editingBannerId ? `/promocode/update` : \"/promocode/create\",\r\n    editingBannerId ? \"put\" : \"post\"\r\n  );\r\n\r\n  const { data: getByIdData, status: getByIdStatus } = useApi(\r\n    `promocode/get-by-id/${editingBannerId}`,\r\n    {},\r\n    {\r\n      enabled: !!editingBannerId,\r\n      suspense: false,\r\n    }\r\n  );\r\n\r\n  useEffect(() => {\r\n    if (status === \"success\") {\r\n      resetForm();\r\n    }\r\n  }, [status]);\r\n\r\n  const submit = (data: any) => {\r\n    mutate({\r\n      _id: editingBannerId,\r\n      ...data,\r\n      maxUsageForUser: +data.maxUsageForUser,\r\n    });\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (getByIdStatus === \"success\") {\r\n      reset({\r\n        name: getByIdData.data.name,\r\n        code: getByIdData.data.code,\r\n        amount: getByIdData.data.amount,\r\n        minOrderPrice: getByIdData.data.minOrderPrice,\r\n        fromDate: getByIdData.data.fromDate,\r\n        toDate: getByIdData.data.toDate,\r\n        maxUsage: getByIdData.data.maxUsage,\r\n        maxUsageForUser: getByIdData.data.maxUsageForUser,\r\n      });\r\n    }\r\n  }, [getByIdStatus, getByIdData]);\r\n\r\n\r\n  return (\r\n    <div className=\"custom-drawer\">\r\n      <form id=\"promo-code\" onSubmit={handleSubmit(submit)}>\r\n        <Grid container spacing={2}>\r\n          <Grid item md={12}>\r\n            <TextInput\r\n              control={control}\r\n              name=\"name\"\r\n              label={t(\"promo_code.name\")}\r\n            />\r\n          </Grid>\r\n          <Grid item md={12}>\r\n            <TextInput\r\n              control={control}\r\n              name=\"code\"\r\n              label={t(\"promo_code.code\")}\r\n            />\r\n          </Grid>\r\n          <Grid item md={12}>\r\n            <TextInput\r\n              name=\"maxUsage\"\r\n              control={control}\r\n              label={t(\"promo_code.usage\")}\r\n              type=\"number\"\r\n            />\r\n          </Grid>\r\n          <Grid item md={12}>\r\n            <TextInput\r\n              name=\"amount\"\r\n              control={control}\r\n              label={t(\"promo_code.value\")}\r\n              type=\"number\"\r\n            />\r\n          </Grid>\r\n          <Grid item md={12}>\r\n            <TextInput\r\n              name=\"minOrderPrice\"\r\n              control={control}\r\n              label={t(\"promo_code.min_order_price\")}\r\n              type=\"number\"\r\n            />\r\n          </Grid>\r\n          <Grid item md={12}>\r\n            <label className=\"text-[15px]\" htmlFor=\"\">{t(\"promo_code.max_usage_for_user\")}</label>\r\n            <Controller\r\n              name=\"maxUsageForUser\"\r\n              control={control}\r\n              render={({ field }) => (\r\n                <TextField\r\n                  {...field}\r\n                  className=\"mt-1\"\r\n                  type=\"number\"\r\n                  fullWidth\r\n                  variant=\"outlined\"\r\n                  defaultValue={1}\r\n                />\r\n              )}\r\n            />\r\n          </Grid>\r\n          <Grid item md={12}>\r\n            <DatePickerForm\r\n              control={control}\r\n              name=\"fromDate\"\r\n              disableTime={true}\r\n              // rules={{ required: { value: false, message: \"Majburiy\" } }}\r\n              label={t(\"promo_code.start_date\")}\r\n              minDate={new Date()}\r\n              readOnly\r\n              maxDate={\r\n                watch(\"dateTo\")\r\n                  // @ts-ignore\r\n                  ? new Date(watch(\"dateTo\"))\r\n                  : undefined\r\n              }\r\n            />\r\n          </Grid>\r\n          <Grid item md={12}>\r\n            <DatePickerForm\r\n              control={control}\r\n              name=\"toDate\"\r\n              // rules={{ required: { value: false, message: \"Majburiy\" } }}\r\n              disableTime={true}\r\n              label={t(\"promo_code.end_date\")}\r\n              readOnly\r\n            // minDate={discountEndMinDate}\r\n            />\r\n          </Grid>\r\n        </Grid>\r\n      </form>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default PromoCodeForm;\r\n","import { FormDrawer, Table } from \"components\";\r\nimport { useMemo, useState } from \"react\";\r\nimport { useBannerColumns } from \"./promo-code.columns\";\r\nimport { useAppDispatch } from \"../../../store/storeHooks\";\r\nimport { setOpenDrawer } from \"components/elements/FormDrawer/formdrawer.slice\";\r\nimport { useForm } from \"react-hook-form\";\r\nimport BannerForm from \"../components/PromoCodeForm\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { useRoleManager } from \"services/useRoleManager\";\r\nimport WarningModal from \"components/common/WarningModal/WarningModal\";\r\nimport { useApi, useApiMutation } from \"hooks/useApi/useApiHooks\";\r\n\r\nconst PromoCode = () => {\r\n  const [editingBannerId, setEditingBannerId] = useState<any>();\r\n  const [bannerId, setBannerId] = useState<any>();\r\n  const columns = useBannerColumns();\r\n  const hasAccess = useRoleManager();\r\n  const { t } = useTranslation();\r\n  const dis = useAppDispatch();\r\n  const formStore = useForm<any>();\r\n\r\n  const resetForm = () => {\r\n    setEditingBannerId(undefined);\r\n    formStore.reset({\r\n      name: \"\",\r\n      code: \"\",\r\n      amount: \"\",\r\n      minOrderPrice: \"\",\r\n      fromDate: null,\r\n      toDate: null,\r\n      maxUsage: \"\",\r\n      maxUsageForUser: 1,\r\n    });\r\n  };\r\n\r\n  const queryParams = useMemo(() => ({}), []);\r\n\r\n  return (\r\n    <>\r\n      <Table\r\n        dataUrl=\"promocode/paging\"\r\n        columns={columns}\r\n        searchable\r\n        onAddButton={hasAccess(\"bannerCreate\")\r\n          ? () => dis(setOpenDrawer(true))\r\n          : undefined}\r\n        onEditColumn={hasAccess(\"bannerUpdate\") ? (row) => {\r\n          setEditingBannerId(row._id);\r\n          dis(setOpenDrawer(true));\r\n        } : undefined}\r\n        onDeleteColumn={hasAccess(\"bannerDelete\") ? (row) => setBannerId(row._id) : undefined}\r\n        exQueryParams={queryParams}\r\n      />\r\n      <WarningModal open={bannerId} setOpen={setBannerId} url=\"promocode/delete\" />\r\n      <FormDrawer\r\n        FORM_ID=\"promo-code\"\r\n        isEditing={!!editingBannerId}\r\n        customTitle={editingBannerId ? t(\"promo_code.edit_promo_code\") : t(\"promo_code.new_promo_code\")}\r\n        onClose={resetForm}\r\n      >\r\n        <BannerForm\r\n          formStore={formStore}\r\n          resetForm={resetForm}\r\n          editingBannerId={editingBannerId}\r\n        />\r\n      </FormDrawer>\r\n\r\n    </>\r\n  );\r\n};\r\n\r\nexport default PromoCode;\r\n","import PromoCode from \"./container/PromoCode\";\r\n\r\nexport default PromoCode;\r\n","import { GridColumns } from \"@mui/x-data-grid\";\r\nimport { Tooltip } from \"antd\";\r\nimport dayjs from \"dayjs\";\r\nimport { get } from \"lodash\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { numberFormat } from \"utils/numberFormat\";\r\n\r\nexport const useBannerColumns = (): GridColumns => {\r\n  const { t } = useTranslation();\r\n\r\n  return [\r\n \r\n    {\r\n      field: t(\"promo_code.name\"),\r\n      renderCell({ row }) {\r\n        const title = row?.name;\r\n        const truncatedTitle = title?.length > 50 ? `${title.substring(0, 50)}...` : title;\r\n    \r\n        return (\r\n          <Tooltip title={title} arrow>\r\n            <span>{truncatedTitle}</span>\r\n          </Tooltip>\r\n        );\r\n      },\r\n    },\r\n    {\r\n      field: t(\"ID\"),\r\n      renderCell({ row }) {\r\n        return get(row, \"code\", \"-\");\r\n      },\r\n    },\r\n    {\r\n      field: t(\"promo_code.value\"),\r\n      renderCell({ row }) {\r\n        return numberFormat(get(row, \"amount\", \"-\"));\r\n      },\r\n    },\r\n    {\r\n      field: t(\"promo_code.usage\"),\r\n      renderCell({ row }) {\r\n        return get(row, \"maxUsage\", \"-\");\r\n      },\r\n    },\r\n    {\r\n      field: t(\"promo_code.used_count\"),\r\n      renderCell({ row }) {\r\n        return get(row, \"usedCount\", \"-\");\r\n      }\r\n    },\r\n    {\r\n      field: t(\"promo_code.start_date\"),\r\n      renderCell({ row }) {\r\n        return dayjs(get(row, \"fromDate\", \"-\")).format('DD.MM.YYYY HH:mm')\r\n      },\r\n    },\r\n    {\r\n      field: t(\"promo_code.end_date\"),\r\n      renderCell({ row }) {\r\n        return dayjs(get(row, \"toDate\", \"-\")).format('DD.MM.YYYY HH:mm')\r\n      },\r\n    },\r\n    {\r\n      field: t(\"promo_code.status\"),\r\n      renderCell({ row }) {\r\n        return get(row, \"state\", \"-\");\r\n      },\r\n    }\r\n  ];\r\n};\r\n","export const numberFormat = (number: any) => {\r\n  if (number || number === 0) {\r\n    // Floating-point xatoliklarni oldini olish\r\n    const rounded = Math.round((number + Number.EPSILON) * 100) / 100;\r\n\r\n    return rounded\r\n      .toLocaleString(\"en-US\", {\r\n        minimumFractionDigits: 0, // Har doim 2 kasr\r\n        maximumFractionDigits: 0, // Kasr 2 dan oshmaydi\r\n      })\r\n      .replaceAll(\",\", \" \"); // Minglik ajratgich\r\n  }\r\n  return \"\";\r\n};\r\n"],"names":["_ref","formStore","editingBannerId","resetForm","t","useTranslation","control","handleSubmit","reset","watch","setValue","mutate","status","useApiMutation","data","getByIdData","getByIdStatus","useApi","concat","enabled","suspense","useEffect","name","code","amount","minOrderPrice","fromDate","toDate","maxUsage","maxUsageForUser","_jsx","className","children","id","onSubmit","_objectSpread","_id","_jsxs","Grid","container","spacing","item","md","TextInput","label","type","htmlFor","Controller","render","_ref2","field","TextField","fullWidth","variant","defaultValue","DatePickerForm","disableTime","minDate","Date","readOnly","maxDate","undefined","PromoCode","setEditingBannerId","useState","bannerId","setBannerId","columns","useBannerColumns","renderCell","row","title","truncatedTitle","length","substring","Tooltip","arrow","get","_ref3","numberFormat","_ref4","_ref5","_ref6","dayjs","format","_ref7","_ref8","hasAccess","useRoleManager","dis","useAppDispatch","useForm","queryParams","useMemo","_Fragment","Table","dataUrl","searchable","onAddButton","setOpenDrawer","onEditColumn","onDeleteColumn","exQueryParams","WarningModal","open","setOpen","url","FormDrawer","FORM_ID","isEditing","customTitle","onClose","BannerForm","number","Math","round","Number","EPSILON","toLocaleString","minimumFractionDigits","maximumFractionDigits","replaceAll"],"sourceRoot":""}